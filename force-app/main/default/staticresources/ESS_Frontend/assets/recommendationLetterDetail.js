import{S as de,i as ve,s as be,O as fe,B as ae,F as ge,w as Q,x as Y,P as Le,Q as ye,G as $e,t as U,b as B,y as X,T as Ee,K as ee,ao as Qe,V as nt,W as Dt,f as Ct,h as b,j as O,a6 as tt,a as p,u as Pt,k as St,l as Rt,d as m,N as it,e as Oe,a3 as Ge,X as He,ap as Ie,p as a,m as y,o as k,q,ab as Ht,aq as We,ar as Je,$ as qe,g as Se,c as Re,as as Tt,D as Mt,L as wt,M as Nt,z as Ft,ac as Ze,A as he,af as at,at as Et,R as Ue,am as Ye,an as ot}from"./MainLayout.js";import{a as me,f as Ne}from"./formatter.js";import{E as Be,T as It}from"./ToOrganizationDropdown.js";import{B as Xe}from"./Button.js";import{D as ft}from"./DatePicker.js";import{T as zt}from"./TextArea.js";import{B as Lt}from"./BaseInput.js";import{C as xe}from"./Collapse.js";import{C as Ot}from"./Card.js";import{D as Gt}from"./Dropdown.js";import{A as Wt}from"./Alert.js";import{M as yt}from"./Modal.js";import{h as je}from"./html.js";import{c as Jt,b as ut,e as Ke}from"./array.js";import{c as pt,r as et,b as mt}from"./sharedValidate.js";import"./flatpickr.js";import"./Label.js";import"./DatePicker.svelte_svelte_type_style_lang.js";import"./_commonjsHelpers.js";function qt(l){let e,t,i;const r=[{clearable:!1},{searchable:!1},{options:l[1]},{valueKey:"key"},{labelKey:"value"},l[2]];function n(o){l[4](o)}let s={};for(let o=0;o<r.length;o+=1)s=fe(s,r[o]);return l[0]!==void 0&&(s.value=l[0]),e=new Gt({props:s}),ae.push(()=>ge(e,"value",n)),e.$on("change",l[5]),{c(){Q(e.$$.fragment)},m(o,f){Y(e,o,f),i=!0},p(o,[f]){const d=f&6?Le(r,[r[0],r[1],f&2&&{options:o[1]},r[3],r[4],f&4&&ye(o[2])]):{};!t&&f&1&&(t=!0,d.value=o[0],$e(()=>t=!1)),e.$set(d)},i(o){i||(U(e.$$.fragment,o),i=!0)},o(o){B(e.$$.fragment,o),i=!1},d(o){X(e,o)}}}function jt(l,e,t){const i=["value","letterType"];let r=Ee(e,i),{value:n=null}=e,{letterType:s}=e;const o=Object.keys(ee.RecommendationLetterLanguage).map(_=>{if(!(_===ee.RecommendationLetterLanguage.English&&s===ee.RecommendationLetterType.GrantedLetter)&&!(_===ee.RecommendationLetterLanguage.Thai&&(s===ee.RecommendationLetterType.SalaryLetterWithLeaveForVisa||s===ee.RecommendationLetterType.SalaryLetterWithoutLeaveForVisa)))return{key:_,value:Qe[_]}}).filter(_=>!!_);function f(_){n=_,t(0,n)}function d(_){Dt.call(this,l,_)}return l.$$set=_=>{e=fe(fe({},e),nt(_)),t(2,r=Ee(e,i)),"value"in _&&t(0,n=_.value),"letterType"in _&&t(3,s=_.letterType)},[n,o,r,s,f,d]}class Vt extends de{constructor(e){super(),ve(this,e,jt,qt,be,{value:0,letterType:3})}}function At(l){let e,t;const i=l[2].default,r=Ct(i,l,l[1],null);return{c(){e=b("div"),r&&r.c(),O(e,"class","indent-8"),tt(e,"text-justify",l[0])},m(n,s){p(n,e,s),r&&r.m(e,null),t=!0},p(n,[s]){r&&r.p&&(!t||s&2)&&Pt(r,i,n,n[1],t?Rt(i,n[1],s,null):St(n[1]),null),(!t||s&1)&&tt(e,"text-justify",n[0])},i(n){t||(U(r,n),t=!0)},o(n){B(r,n),t=!1},d(n){n&&m(e),r&&r.d(n)}}}function Ut(l,e,t){let{$$slots:i={},$$scope:r}=e,{isJustify:n=!1}=e;return l.$$set=s=>{"isJustify"in s&&t(0,n=s.isJustify),"$$scope"in s&&t(1,r=s.$$scope)},[n,r,i]}class we extends de{constructor(e){super(),ve(this,e,Ut,At,be,{isJustify:0})}}const ze=it({}),lt=it(!1),Fe=it({isPreview:!1});function _t(l){let e,t,i;return{c(){e=b("figure"),t=b("img"),O(t,"class","w-[5.85cm]"),Ie(t.src,i=l[0].sealUrl)||O(t,"src",i),O(t,"alt","company-stamp"),O(e,"class","absolute -z-10 top-[-110px]")},m(r,n){p(r,e,n),a(e,t)},p(r,n){n&1&&!Ie(t.src,i=r[0].sealUrl)&&O(t,"src",i)},d(r){r&&m(e)}}}function Bt(l){let e,t=!l[0].isPreview&&_t(l);return{c(){t&&t.c(),e=Oe()},m(i,r){t&&t.m(i,r),p(i,e,r)},p(i,[r]){i[0].isPreview?t&&(t.d(1),t=null):t?t.p(i,r):(t=_t(i),t.c(),t.m(e.parentNode,e))},i:Ge,o:Ge,d(i){t&&t.d(i),i&&m(e)}}}function Kt(l,e,t){let i;return He(l,Fe,r=>t(0,i=r)),[i]}class Qt extends de{constructor(e){super(),ve(this,e,Kt,Bt,be,{})}}function dt(l){let e,t,i,r,n;return{c(){e=b("figure"),t=b("img"),Ie(t.src,i=l[2].letterHRSignatureUrl)||O(t,"src",i),O(t,"alt","sign-th"),O(e,"class",Xt)},m(s,o){p(s,e,o),a(e,t),l[4](t),l[5](e),r||(n=Ht(t,"load",l[3]),r=!0)},p(s,o){o&4&&!Ie(t.src,i=s[2].letterHRSignatureUrl)&&O(t,"src",i)},d(s){s&&m(e),l[4](null),l[5](null),r=!1,n()}}}function Yt(l){let e,t=l[2].faithfullyText+"",i,r,n,s,o,f,d,_,w,c,C,R,P,S,N,W=l[2].letterHRName+"",V,v,F,J,z=l[2].letterHRPosition+"",j,M;c=new Qt({});let H=!l[2].isPreview&&dt(l);return{c(){e=b("div"),i=y(t),r=k(),n=b("br"),s=k(),o=b("br"),f=k(),d=b("br"),_=k(),w=b("div"),Q(c.$$.fragment),C=k(),R=b("div"),H&&H.c(),P=k(),S=b("div"),N=y("("),V=y(W),v=y(")"),F=k(),J=b("div"),j=y(z),O(e,"class","_g-letter-date-faithfully-alignment text-center"),O(R,"class","_g-letter-signature-alignment relative"),O(w,"class","relative text-center")},m(T,I){p(T,e,I),a(e,i),p(T,r,I),p(T,n,I),p(T,s,I),p(T,o,I),p(T,f,I),p(T,d,I),p(T,_,I),p(T,w,I),Y(c,w,null),a(w,C),a(w,R),H&&H.m(R,null),a(R,P),a(R,S),a(S,N),a(S,V),a(S,v),a(R,F),a(R,J),a(J,j),M=!0},p(T,[I]){(!M||I&4)&&t!==(t=T[2].faithfullyText+"")&&q(i,t),T[2].isPreview?H&&(H.d(1),H=null):H?H.p(T,I):(H=dt(T),H.c(),H.m(R,P)),(!M||I&4)&&W!==(W=T[2].letterHRName+"")&&q(V,W),(!M||I&4)&&z!==(z=T[2].letterHRPosition+"")&&q(j,z)},i(T){M||(U(c.$$.fragment,T),M=!0)},o(T){B(c.$$.fragment,T),M=!1},d(T){T&&m(e),T&&m(r),T&&m(n),T&&m(s),T&&m(o),T&&m(f),T&&m(d),T&&m(_),T&&m(w),X(c),H&&H.d()}}}const Xt="absolute left-1/2 transform -translate-x-1/2";function Zt(l,e,t){let i;He(l,Fe,_=>t(2,i=_));let r,n;const s=26*3;function o(){r&&t(0,r.style.top=`-${s+n.height/2-s/2}px`,r),lt.set(!0)}function f(_){ae[_?"unshift":"push"](()=>{n=_,t(1,n)})}function d(_){ae[_?"unshift":"push"](()=>{r=_,t(0,r)})}return[r,n,i,o,f,d]}class Me extends de{constructor(e){super(),ve(this,e,Zt,Yt,be,{})}}function ht(l){var z,j,M,H,T,I;let e,t,i=((z=l[0])==null?void 0:z.employeeNameTH)+"",r,n,s,o,f,d=((j=l[0])==null?void 0:j.positionTH)+"",_,w=((M=l[0])==null?void 0:M.departmentFullTH)+"",c,C,R=h((H=l[0])==null?void 0:H.dateJoinedCompany)+"",P,S,N=me((T=l[1])==null?void 0:T.MonthlyIncome,2)+"",W,V,v=me((I=l[1])==null?void 0:I.NetIncome,2)+"",F,J;return{c(){e=y("บริษัท ไทยออยล์ เอนเนอร์ยี เซอร์วิส จำกัด ขอเรียนให้ทราบว่า "),t=b("span"),r=y(i),n=y(`
    เป็นพนักงานของบริษัทฯ ปัจจุบันได้รับมอบหมายให้ไปปฏิบัติงานกับ
    `),s=b("span"),s.textContent="บริษัท ไทยออยล์ จำกัด (มหาชน)",o=y(`
    ในตำแหน่ง `),f=new We(!1),_=k(),c=y(w),C=y(`
    เข้าทำงานตั้งแต่วันที่
    `),P=y(R),S=y(` ได้รับรายได้ประจำรวมทั้งสิ้นเดือนละ
    `),W=y(N),V=y(" บาท (สุทธิเดือนละ "),F=y(v),J=y(" บาท)"),O(t,"class","whitespace-nowrap"),O(s,"class","whitespace-nowrap"),f.a=_},m(u,$){p(u,e,$),p(u,t,$),a(t,r),p(u,n,$),p(u,s,$),p(u,o,$),f.m(d,u,$),p(u,_,$),p(u,c,$),p(u,C,$),p(u,P,$),p(u,S,$),p(u,W,$),p(u,V,$),p(u,F,$),p(u,J,$)},p(u,$){var L,D,g,E,Z,te;$&1&&i!==(i=((L=u[0])==null?void 0:L.employeeNameTH)+"")&&q(r,i),$&1&&d!==(d=((D=u[0])==null?void 0:D.positionTH)+"")&&f.p(d),$&1&&w!==(w=((g=u[0])==null?void 0:g.departmentFullTH)+"")&&q(c,w),$&1&&R!==(R=h((E=u[0])==null?void 0:E.dateJoinedCompany)+"")&&q(P,R),$&2&&N!==(N=me((Z=u[1])==null?void 0:Z.MonthlyIncome,2)+"")&&q(W,N),$&2&&v!==(v=me((te=u[1])==null?void 0:te.NetIncome,2)+"")&&q(F,v)},d(u){u&&m(e),u&&m(t),u&&m(n),u&&m(s),u&&m(o),u&&f.d(),u&&m(_),u&&m(c),u&&m(C),u&&m(P),u&&m(S),u&&m(W),u&&m(V),u&&m(F),u&&m(J)}}}function xt(l){var s;let e,t,i=((s=l[0])==null?void 0:s.employeeNameTH)+"",r,n;return{c(){e=y("บริษัทฯ ได้พิจารณาแล้วเห็นว่า "),t=b("span"),r=y(i),n=y(" มีคุุณสมบัติเหมาะสมที่จะเป็นผู้กู้ในโครงการสวัสดิการเงินกู้เพื่อที่อยู่อาศัยตามข้อตกลงดังกล่าวข้างต้น"),O(t,"class","whitespace-nowrap")},m(o,f){p(o,e,f),p(o,t,f),a(t,r),p(o,n,f)},p(o,f){var d;f&1&&i!==(i=((d=o[0])==null?void 0:d.employeeNameTH)+"")&&q(r,i)},d(o){o&&m(e),o&&m(t),o&&m(n)}}}function el(l){let e;return{c(){e=y("จึงเรียนมาเพื่อโปรดดำเนินการ")},m(t,i){p(t,e,i)},d(t){t&&m(e)}}}function tl(l){var $;let e,t,i,r,n=h((($=l[0])==null?void 0:$.generatedDate)??new Date)+"",s,o,f,d,_,w,c,C,R,P,S,N,W,V,v,F,J,z,j,M,H,T,I,u;return R=new we({props:{$$slots:{default:[ht]},$$scope:{ctx:l}}}),S=new we({props:{$$slots:{default:[xt]},$$scope:{ctx:l}}}),v=new we({props:{$$slots:{default:[el]},$$scope:{ctx:l}}}),j=new Me({}),{c(){e=b("div"),t=b("br"),i=k(),r=b("div"),s=y(n),o=k(),f=b("br"),d=k(),_=b("div"),_.innerHTML=`<div class="flex"><div class="w-[50px]">เรื่อง</div> 
      <div>การกู้เงินโครงการสวัสดิการเงินกู้เพื่อที่อยู่อาศัย
        (สวัสดิการไม่มีเงินฝาก)</div></div> 
    <div class="flex"><div class="w-[50px]">เรียน</div> 
      <div>กรรมการผู้จัดการ ธนาคารอาคารสงเคราะห์</div></div> 
    <div class="flex"><div class="min-w-[50px]">อ้างถึง</div> 
      <div>ข้อตกลงระหว่างธนาคารอาคารสงเคราะห์กับบริษัท ไทยออยล์ เอนเนอร์ยี เซอร์วิส
        จำกัด ฉบับลงวันที่ 1 เมษายน 2555 (รหัสสวัสดิการ 001W550152)</div></div>`,w=k(),c=b("br"),C=k(),Q(R.$$.fragment),P=k(),Q(S.$$.fragment),N=k(),W=b("br"),V=k(),Q(v.$$.fragment),F=k(),J=b("br"),z=k(),Q(j.$$.fragment),M=k(),H=b("br"),T=k(),I=b("div"),I.textContent="หมายเหตุ หนังสือฉบับนี้มีอายุ 60 วัน นับแต่วันที่ออกหนังสือ",O(r,"class","_g-letter-date-faithfully-alignment text-center"),O(I,"class","mt-1.5")},m(L,D){p(L,e,D),a(e,t),a(e,i),a(e,r),a(r,s),a(e,o),a(e,f),a(e,d),a(e,_),a(e,w),a(e,c),a(e,C),Y(R,e,null),a(e,P),Y(S,e,null),a(e,N),a(e,W),a(e,V),Y(v,e,null),a(e,F),a(e,J),a(e,z),Y(j,e,null),a(e,M),a(e,H),a(e,T),a(e,I),u=!0},p(L,[D]){var te;(!u||D&1)&&n!==(n=h(((te=L[0])==null?void 0:te.generatedDate)??new Date)+"")&&q(s,n);const g={};D&7&&(g.$$scope={dirty:D,ctx:L}),R.$set(g);const E={};D&5&&(E.$$scope={dirty:D,ctx:L}),S.$set(E);const Z={};D&4&&(Z.$$scope={dirty:D,ctx:L}),v.$set(Z)},i(L){u||(U(R.$$.fragment,L),U(S.$$.fragment,L),U(v.$$.fragment,L),U(j.$$.fragment,L),u=!0)},o(L){B(R.$$.fragment,L),B(S.$$.fragment,L),B(v.$$.fragment,L),B(j.$$.fragment,L),u=!1},d(L){L&&m(e),X(R),X(S),X(v),X(j)}}}function ll(l,e,t){let i;He(l,ze,n=>t(1,i=n));let{letter:r={}}=e;return l.$$set=n=>{"letter"in n&&t(0,r=n.letter)},[r,i]}class nl extends de{constructor(e){super(),ve(this,e,ll,tl,be,{letter:0})}}function il(l){var $;let e,t,i,r,n,s=h((($=l[1])==null?void 0:$.generatedDate)??new Date,!1)+"",o,f,d,_,w,c,C,R,P,S,N,W,V,v,F,J,z,j,M,H,T,I,u;return J=new we({props:{$$slots:{default:[rl]},$$scope:{ctx:l}}}),I=new Me({}),{c(){e=b("br"),t=k(),i=b("div"),i.innerHTML='<span class="underline">Private &amp; Confidential</span>',r=k(),n=b("div"),o=y(s),f=k(),d=b("br"),_=k(),w=b("div"),c=b("div"),c.innerHTML=`<div class="w-[100px]">Subject</div> 
      <div>Employee Certificate</div>`,C=k(),R=b("div"),P=b("div"),P.textContent="To",S=k(),N=b("div"),W=y(l[2]),V=k(),v=b("br"),F=k(),Q(J.$$.fragment),z=k(),j=b("br"),M=k(),H=b("br"),T=k(),Q(I.$$.fragment),O(n,"class","_g-letter-date-faithfully-alignment text-center"),O(c,"class","flex"),O(P,"class","w-[100px]"),O(N,"class","max-w-[calc(100%-50px)]"),O(R,"class","flex")},m(L,D){p(L,e,D),p(L,t,D),p(L,i,D),p(L,r,D),p(L,n,D),a(n,o),p(L,f,D),p(L,d,D),p(L,_,D),p(L,w,D),a(w,c),a(w,C),a(w,R),a(R,P),a(R,S),a(R,N),a(N,W),p(L,V,D),p(L,v,D),p(L,F,D),Y(J,L,D),p(L,z,D),p(L,j,D),p(L,M,D),p(L,H,D),p(L,T,D),Y(I,L,D),u=!0},p(L,D){var E;(!u||D&2)&&s!==(s=h(((E=L[1])==null?void 0:E.generatedDate)??new Date,!1)+"")&&q(o,s),(!u||D&4)&&q(W,L[2]);const g={};D&75&&(g.$$scope={dirty:D,ctx:L}),J.$set(g)},i(L){u||(U(J.$$.fragment,L),U(I.$$.fragment,L),u=!0)},o(L){B(J.$$.fragment,L),B(I.$$.fragment,L),u=!1},d(L){L&&m(e),L&&m(t),L&&m(i),L&&m(r),L&&m(n),L&&m(f),L&&m(d),L&&m(_),L&&m(w),L&&m(V),L&&m(v),L&&m(F),X(J,L),L&&m(z),L&&m(j),L&&m(M),L&&m(H),L&&m(T),X(I,L)}}}function sl(l){var I;let e,t,i,r=h(((I=l[1])==null?void 0:I.generatedDate)??new Date)+"",n,s,o,f,d,_,w,c,C,R,P,S,N,W,V,v,F,J,z,j,M,H,T;return v=new we({props:{$$slots:{default:[al]},$$scope:{ctx:l}}}),H=new Me({}),{c(){e=b("br"),t=k(),i=b("div"),n=y(r),s=k(),o=b("br"),f=k(),d=b("div"),_=b("div"),_.innerHTML=`<div class="w-[50px]">เรื่อง</div> 
      <div>รับรองการเป็นพนักงาน</div>`,w=k(),c=b("div"),C=b("div"),C.textContent="เรียน",R=k(),P=b("div"),S=y(l[2]),N=k(),W=b("br"),V=k(),Q(v.$$.fragment),F=k(),J=b("br"),z=k(),j=b("br"),M=k(),Q(H.$$.fragment),O(i,"class","_g-letter-date-faithfully-alignment text-center"),O(_,"class","flex"),O(C,"class","w-[50px]"),O(P,"class","max-w-[calc(100%-50px)]"),O(c,"class","flex")},m(u,$){p(u,e,$),p(u,t,$),p(u,i,$),a(i,n),p(u,s,$),p(u,o,$),p(u,f,$),p(u,d,$),a(d,_),a(d,w),a(d,c),a(c,C),a(c,R),a(c,P),a(P,S),p(u,N,$),p(u,W,$),p(u,V,$),Y(v,u,$),p(u,F,$),p(u,J,$),p(u,z,$),p(u,j,$),p(u,M,$),Y(H,u,$),T=!0},p(u,$){var D;(!T||$&2)&&r!==(r=h(((D=u[1])==null?void 0:D.generatedDate)??new Date)+"")&&q(n,r),(!T||$&4)&&q(S,u[2]);const L={};$&75&&(L.$$scope={dirty:$,ctx:u}),v.$set(L)},i(u){T||(U(v.$$.fragment,u),U(H.$$.fragment,u),T=!0)},o(u){B(v.$$.fragment,u),B(H.$$.fragment,u),T=!1},d(u){u&&m(e),u&&m(t),u&&m(i),u&&m(s),u&&m(o),u&&m(f),u&&m(d),u&&m(N),u&&m(W),u&&m(V),X(v,u),u&&m(F),u&&m(J),u&&m(z),u&&m(j),u&&m(M),X(H,u)}}}function rl(l){var I,u,$,L,D;let e,t=((I=l[1])==null?void 0:I.employeeName)+"",i,r,n=(l[0]?re.top:re.tes)+"",s,o,f=se((u=l[1])==null?void 0:u.gender,!0)+"",d,_,w=h(($=l[1])==null?void 0:$.dateJoinedCompany,!1)+"",c,C,R=se((L=l[1])==null?void 0:L.gender)+"",P,S,N=_e(l[0],l[4])+"",W,V,v,F,J,z=me((D=l[3])==null?void 0:D.MonthlyIncome,2)+"",j,M,H,T;return{c(){e=y("This is to certify that "),i=y(t),r=y(` is a permanent employee of
    `),s=y(n),o=y(". "),d=y(f),_=y(`
    has joined the Company since
    `),c=y(w),C=y(". At present, "),P=y(R),S=y(`
    is `),W=y(N),V=y(` the position of
    `),v=b("span"),J=y(`
    with monthly income of Baht `),j=y(z),M=y(".")},m(g,E){var Z;p(g,e,E),p(g,i,E),p(g,r,E),p(g,s,E),p(g,o,E),p(g,d,E),p(g,_,E),p(g,c,E),p(g,C,E),p(g,P,E),p(g,S,E),p(g,W,E),p(g,V,E),p(g,v,E),p(g,J,E),p(g,j,E),p(g,M,E),H||(T=Je(F=je.call(null,v,(Z=l[1])==null?void 0:Z.position)),H=!0)},p(g,E){var Z,te,le,ie,ue,pe;E&2&&t!==(t=((Z=g[1])==null?void 0:Z.employeeName)+"")&&q(i,t),E&1&&n!==(n=(g[0]?re.top:re.tes)+"")&&q(s,n),E&2&&f!==(f=se((te=g[1])==null?void 0:te.gender,!0)+"")&&q(d,f),E&2&&w!==(w=h((le=g[1])==null?void 0:le.dateJoinedCompany,!1)+"")&&q(c,w),E&2&&R!==(R=se((ie=g[1])==null?void 0:ie.gender)+"")&&q(P,R),E&1&&N!==(N=_e(g[0],g[4])+"")&&q(W,N),F&&qe(F.update)&&E&2&&F.update.call(null,(ue=g[1])==null?void 0:ue.position),E&8&&z!==(z=me((pe=g[3])==null?void 0:pe.MonthlyIncome,2)+"")&&q(j,z)},d(g){g&&m(e),g&&m(i),g&&m(r),g&&m(s),g&&m(o),g&&m(d),g&&m(_),g&&m(c),g&&m(C),g&&m(P),g&&m(S),g&&m(W),g&&m(V),g&&m(v),g&&m(J),g&&m(j),g&&m(M),H=!1,T()}}}function al(l){var v,F,J,z,j;let e,t,i=((v=l[1])==null?void 0:v.employeeNameTH)+"",r,n,s=h((F=l[1])==null?void 0:F.dateJoinedCompany)+"",o,f,d=me((J=l[3])==null?void 0:J.MonthlyIncome,2)+"",_,w,c,C=_e(l[0],l[4])+"",R,P,S=((z=l[1])==null?void 0:z.positionTH)+"",N,W=((j=l[1])==null?void 0:j.departmentFullTH)+"",V;return{c(){e=y("บริษัทฯ ขอรับรองว่า "),t=b("span"),r=y(i),n=y(`
    เป็นพนักงานของบริษัทฯ เข้าทำงานตั้งแต่วันที่
    `),o=y(s),f=y(` ได้รับรายได้ประจำรวมทั้งสิ้นเดือนละ
    `),_=y(d),w=y(" บาท "),c=new We(!1),R=y(" ในตำแหน่ง "),P=new We(!1),N=k(),V=y(W),O(t,"class","whitespace-nowrap"),c.a=R,P.a=N},m(M,H){p(M,e,H),p(M,t,H),a(t,r),p(M,n,H),p(M,o,H),p(M,f,H),p(M,_,H),p(M,w,H),c.m(C,M,H),p(M,R,H),P.m(S,M,H),p(M,N,H),p(M,V,H)},p(M,H){var T,I,u,$,L;H&2&&i!==(i=((T=M[1])==null?void 0:T.employeeNameTH)+"")&&q(r,i),H&2&&s!==(s=h((I=M[1])==null?void 0:I.dateJoinedCompany)+"")&&q(o,s),H&8&&d!==(d=me((u=M[3])==null?void 0:u.MonthlyIncome,2)+"")&&q(_,d),H&1&&C!==(C=_e(M[0],M[4])+"")&&c.p(C),H&2&&S!==(S=(($=M[1])==null?void 0:$.positionTH)+"")&&P.p(S),H&2&&W!==(W=((L=M[1])==null?void 0:L.departmentFullTH)+"")&&q(V,W)},d(M){M&&m(e),M&&m(t),M&&m(n),M&&m(o),M&&m(f),M&&m(_),M&&m(w),M&&c.d(),M&&m(R),M&&P.d(),M&&m(N),M&&m(V)}}}function ol(l){let e,t,i,r;const n=[sl,il],s=[];function o(f,d){return f[4]?0:1}return e=o(l),t=s[e]=n[e](l),{c(){t.c(),i=Oe()},m(f,d){s[e].m(f,d),p(f,i,d),r=!0},p(f,[d]){t.p(f,d)},i(f){r||(U(t),r=!0)},o(f){B(t),r=!1},d(f){s[e].d(f),f&&m(i)}}}function fl(l,e,t){let i;He(l,ze,d=>t(3,i=d));let{isTop:r}=e,{language:n=void 0}=e,{letter:s={}}=e,{letterToText:o=""}=e;const f=n===ee.RecommendationLetterLanguage.Thai;return l.$$set=d=>{"isTop"in d&&t(0,r=d.isTop),"language"in d&&t(5,n=d.language),"letter"in d&&t(1,s=d.letter),"letterToText"in d&&t(2,o=d.letterToText)},[r,s,o,i,f,n]}class ul extends de{constructor(e){super(),ve(this,e,fl,ol,be,{isTop:0,language:5,letter:1,letterToText:2})}}function pl(l){let e,t,i,r;return{c(){e=b("div"),e.textContent="The Consulate",t=k(),i=b("div"),r=y(l[2])},m(n,s){p(n,e,s),p(n,t,s),p(n,i,s),a(i,r)},p(n,s){s&4&&q(r,n[2])},d(n){n&&m(e),n&&m(t),n&&m(i)}}}function ml(l){let e,t,i,r;return{c(){e=b("br"),t=k(),i=b("div"),r=y(l[2])},m(n,s){p(n,e,s),p(n,t,s),p(n,i,s),a(i,r)},p(n,s){s&4&&q(r,n[2])},d(n){n&&m(e),n&&m(t),n&&m(i)}}}function _l(l){var le,ie,ue,pe,ke,De;let e,t=((le=l[1])==null?void 0:le.employeeName)+"",i,r,n=(l[0]?re.top:re.tes)+"",s,o,f=se((ie=l[1])==null?void 0:ie.gender,!0)+"",d,_,w=h((ue=l[1])==null?void 0:ue.dateJoinedCompany,!1)+"",c,C,R=se((pe=l[1])==null?void 0:pe.gender)+"",P,S,N=_e(l[0],!1)+"",W,V,v,F,J,z=me((ke=l[4])==null?void 0:ke.MonthlyIncome,2)+"",j,M,H=se((De=l[1])==null?void 0:De.gender)+"",T,I,u=h(l[1].startLeaveDate,!1)+"",$,L,D=h(l[1].endLeaveDate,!1)+"",g,E,Z,te;return{c(){e=y("This is to certify that "),i=y(t),r=y(` is a permanent employee of
    `),s=y(n),o=y(". "),d=y(f),_=y(`
    has joined the Company since
    `),c=y(w),C=y(". At present, "),P=y(R),S=y(`
    is `),W=y(N),V=y(` the position of
    `),v=b("span"),J=y(`
    with monthly income of Baht `),j=y(z),M=y(". In addition, "),T=y(H),I=y(`
    has been granted vacation during `),$=y(u),L=y(" to "),g=y(D),E=y(".")},m(A,K){var ce;p(A,e,K),p(A,i,K),p(A,r,K),p(A,s,K),p(A,o,K),p(A,d,K),p(A,_,K),p(A,c,K),p(A,C,K),p(A,P,K),p(A,S,K),p(A,W,K),p(A,V,K),p(A,v,K),p(A,J,K),p(A,j,K),p(A,M,K),p(A,T,K),p(A,I,K),p(A,$,K),p(A,L,K),p(A,g,K),p(A,E,K),Z||(te=Je(F=je.call(null,v,(ce=l[1])==null?void 0:ce.position)),Z=!0)},p(A,K){var ce,Ce,Pe,G,ne,x,oe;K&2&&t!==(t=((ce=A[1])==null?void 0:ce.employeeName)+"")&&q(i,t),K&1&&n!==(n=(A[0]?re.top:re.tes)+"")&&q(s,n),K&2&&f!==(f=se((Ce=A[1])==null?void 0:Ce.gender,!0)+"")&&q(d,f),K&2&&w!==(w=h((Pe=A[1])==null?void 0:Pe.dateJoinedCompany,!1)+"")&&q(c,w),K&2&&R!==(R=se((G=A[1])==null?void 0:G.gender)+"")&&q(P,R),K&1&&N!==(N=_e(A[0],!1)+"")&&q(W,N),F&&qe(F.update)&&K&2&&F.update.call(null,(ne=A[1])==null?void 0:ne.position),K&16&&z!==(z=me((x=A[4])==null?void 0:x.MonthlyIncome,2)+"")&&q(j,z),K&2&&H!==(H=se((oe=A[1])==null?void 0:oe.gender)+"")&&q(T,H),K&2&&u!==(u=h(A[1].startLeaveDate,!1)+"")&&q($,u),K&2&&D!==(D=h(A[1].endLeaveDate,!1)+"")&&q(g,D)},d(A){A&&m(e),A&&m(i),A&&m(r),A&&m(s),A&&m(o),A&&m(d),A&&m(_),A&&m(c),A&&m(C),A&&m(P),A&&m(S),A&&m(W),A&&m(V),A&&m(v),A&&m(J),A&&m(j),A&&m(M),A&&m(T),A&&m(I),A&&m($),A&&m(L),A&&m(g),A&&m(E),Z=!1,te()}}}function dl(l){var L;let e,t,i,r,n,s,o,f=h(((L=l[1])==null?void 0:L.generatedDate)??new Date,!1)+"",d,_,w,c,C,R,P,S,N,W,V,v,F,J,z,j,M,H,T;function I(D,g){return D[3]?ml:pl}let u=I(l),$=u(l);return v=new we({props:{isJustify:!0,$$slots:{default:[_l]},$$scope:{ctx:l}}}),H=new Me({}),{c(){e=b("div"),t=b("br"),i=k(),r=b("div"),n=b("div"),n.textContent="Private & Confidential",s=k(),o=b("div"),d=y(f),_=k(),w=b("br"),c=k(),$.c(),C=k(),R=b("br"),P=k(),S=b("div"),S.textContent="Dear Sirs:",N=k(),W=b("br"),V=k(),Q(v.$$.fragment),F=k(),J=b("br"),z=k(),j=b("br"),M=k(),Q(H.$$.fragment),O(n,"class","underline"),O(o,"class","absolute top-0 left-0 right-0 _g-letter-date-faithfully-alignment text-center"),O(r,"class","relative")},m(D,g){p(D,e,g),a(e,t),a(e,i),a(e,r),a(r,n),a(r,s),a(r,o),a(o,d),a(e,_),a(e,w),a(e,c),$.m(e,null),a(e,C),a(e,R),a(e,P),a(e,S),a(e,N),a(e,W),a(e,V),Y(v,e,null),a(e,F),a(e,J),a(e,z),a(e,j),a(e,M),Y(H,e,null),T=!0},p(D,[g]){var Z;(!T||g&2)&&f!==(f=h(((Z=D[1])==null?void 0:Z.generatedDate)??new Date,!1)+"")&&q(d,f),u===(u=I(D))&&$?$.p(D,g):($.d(1),$=u(D),$&&($.c(),$.m(e,C)));const E={};g&51&&(E.$$scope={dirty:g,ctx:D}),v.$set(E)},i(D){T||(U(v.$$.fragment,D),U(H.$$.fragment,D),T=!0)},o(D){B(v.$$.fragment,D),B(H.$$.fragment,D),T=!1},d(D){D&&m(e),$.d(),X(v),X(H)}}}function vl(l,e,t){let i,r;He(l,ze,f=>t(4,r=f));let{isTop:n}=e,{letter:s={}}=e,{letterToText:o=""}=e;return l.$$set=f=>{"isTop"in f&&t(0,n=f.isTop),"letter"in f&&t(1,s=f.letter),"letterToText"in f&&t(2,o=f.letterToText)},l.$$.update=()=>{l.$$.dirty&2&&t(3,i=(s==null?void 0:s.organization)==="Other")},[n,s,o,i,r]}class bl extends de{constructor(e){super(),ve(this,e,vl,dl,be,{isTop:0,letter:1,letterToText:2})}}function cl(l){let e,t,i,r;return{c(){e=b("div"),e.textContent="The Consulate",t=k(),i=b("div"),r=y(l[2])},m(n,s){p(n,e,s),p(n,t,s),p(n,i,s),a(i,r)},p(n,s){s&4&&q(r,n[2])},d(n){n&&m(e),n&&m(t),n&&m(i)}}}function gl(l){let e,t,i,r;return{c(){e=b("br"),t=k(),i=b("div"),r=y(l[2])},m(n,s){p(n,e,s),p(n,t,s),p(n,i,s),a(i,r)},p(n,s){s&4&&q(r,n[2])},d(n){n&&m(e),n&&m(t),n&&m(i)}}}function $l(l){var I,u,$,L,D;let e,t=((I=l[1])==null?void 0:I.employeeName)+"",i,r,n=(l[0]?re.top:re.tes)+"",s,o,f=se((u=l[1])==null?void 0:u.gender,!0)+"",d,_,w=h(($=l[1])==null?void 0:$.dateJoinedCompany,!1)+"",c,C,R=se((L=l[1])==null?void 0:L.gender)+"",P,S,N=_e(l[0],!1)+"",W,V,v,F,J,z=me((D=l[4])==null?void 0:D.MonthlyIncome,2)+"",j,M,H,T;return{c(){e=y("This is to certify that "),i=y(t),r=y(` is a permanent employee of
    `),s=y(n),o=y(". "),d=y(f),_=y(`
    has joined the Company since
    `),c=y(w),C=y(". At present, "),P=y(R),S=y(`
    is `),W=y(N),V=y(` the position of
    `),v=b("span"),J=y(`
    with monthly income of Baht `),j=y(z),M=y(".")},m(g,E){var Z;p(g,e,E),p(g,i,E),p(g,r,E),p(g,s,E),p(g,o,E),p(g,d,E),p(g,_,E),p(g,c,E),p(g,C,E),p(g,P,E),p(g,S,E),p(g,W,E),p(g,V,E),p(g,v,E),p(g,J,E),p(g,j,E),p(g,M,E),H||(T=Je(F=je.call(null,v,(Z=l[1])==null?void 0:Z.position)),H=!0)},p(g,E){var Z,te,le,ie,ue,pe;E&2&&t!==(t=((Z=g[1])==null?void 0:Z.employeeName)+"")&&q(i,t),E&1&&n!==(n=(g[0]?re.top:re.tes)+"")&&q(s,n),E&2&&f!==(f=se((te=g[1])==null?void 0:te.gender,!0)+"")&&q(d,f),E&2&&w!==(w=h((le=g[1])==null?void 0:le.dateJoinedCompany,!1)+"")&&q(c,w),E&2&&R!==(R=se((ie=g[1])==null?void 0:ie.gender)+"")&&q(P,R),E&1&&N!==(N=_e(g[0],!1)+"")&&q(W,N),F&&qe(F.update)&&E&2&&F.update.call(null,(ue=g[1])==null?void 0:ue.position),E&16&&z!==(z=me((pe=g[4])==null?void 0:pe.MonthlyIncome,2)+"")&&q(j,z)},d(g){g&&m(e),g&&m(i),g&&m(r),g&&m(s),g&&m(o),g&&m(d),g&&m(_),g&&m(c),g&&m(C),g&&m(P),g&&m(S),g&&m(W),g&&m(V),g&&m(v),g&&m(J),g&&m(j),g&&m(M),H=!1,T()}}}function Tl(l){var L;let e,t,i,r,n,s,o,f=h(((L=l[1])==null?void 0:L.generatedDate)??new Date,!1)+"",d,_,w,c,C,R,P,S,N,W,V,v,F,J,z,j,M,H,T;function I(D,g){return D[3]?gl:cl}let u=I(l),$=u(l);return v=new we({props:{$$slots:{default:[$l]},$$scope:{ctx:l}}}),H=new Me({}),{c(){e=b("div"),t=b("br"),i=k(),r=b("div"),n=b("div"),n.textContent="Private & Confidential",s=k(),o=b("div"),d=y(f),_=k(),w=b("br"),c=k(),$.c(),C=k(),R=b("br"),P=k(),S=b("div"),S.textContent="Dear Sirs:",N=k(),W=b("br"),V=k(),Q(v.$$.fragment),F=k(),J=b("br"),z=k(),j=b("br"),M=k(),Q(H.$$.fragment),O(n,"class","underline"),O(o,"class","absolute top-0 left-0 right-0 _g-letter-date-faithfully-alignment text-center"),O(r,"class","relative")},m(D,g){p(D,e,g),a(e,t),a(e,i),a(e,r),a(r,n),a(r,s),a(r,o),a(o,d),a(e,_),a(e,w),a(e,c),$.m(e,null),a(e,C),a(e,R),a(e,P),a(e,S),a(e,N),a(e,W),a(e,V),Y(v,e,null),a(e,F),a(e,J),a(e,z),a(e,j),a(e,M),Y(H,e,null),T=!0},p(D,[g]){var Z;(!T||g&2)&&f!==(f=h(((Z=D[1])==null?void 0:Z.generatedDate)??new Date,!1)+"")&&q(d,f),u===(u=I(D))&&$?$.p(D,g):($.d(1),$=u(D),$&&($.c(),$.m(e,C)));const E={};g&51&&(E.$$scope={dirty:g,ctx:D}),v.$set(E)},i(D){T||(U(v.$$.fragment,D),U(H.$$.fragment,D),T=!0)},o(D){B(v.$$.fragment,D),B(H.$$.fragment,D),T=!1},d(D){D&&m(e),$.d(),X(v),X(H)}}}function wl(l,e,t){let i,r;He(l,ze,f=>t(4,r=f));let{isTop:n}=e,{letter:s={}}=e,{letterToText:o=""}=e;return l.$$set=f=>{"isTop"in f&&t(0,n=f.isTop),"letter"in f&&t(1,s=f.letter),"letterToText"in f&&t(2,o=f.letterToText)},l.$$.update=()=>{l.$$.dirty&2&&t(3,i=(s==null?void 0:s.organization)==="Other")},[n,s,o,i,r]}class Ll extends de{constructor(e){super(),ve(this,e,wl,Tl,be,{isTop:0,letter:1,letterToText:2})}}function yl(l){var L;let e,t,i,r,n,s,o=h(((L=l[1])==null?void 0:L.generatedDate)??new Date,!1)+"",f,d,_,w,c,C,R,P,S,N,W,V,v,F,J,z,j,M,H,T,I,u,$;return z=new we({props:{$$slots:{default:[Dl]},$$scope:{ctx:l}}}),u=new Me({}),{c(){e=b("div"),t=b("br"),i=k(),r=b("div"),r.innerHTML='<span class="underline">Private &amp; Confidential</span>',n=k(),s=b("div"),f=y(o),d=k(),_=b("br"),w=k(),c=b("div"),C=b("div"),C.innerHTML=`<div class="w-[100px]">Subject</div> 
        <div>Employee Certificate</div>`,R=k(),P=b("div"),S=b("div"),S.textContent="To",N=k(),W=b("div"),V=y(l[2]),v=k(),F=b("br"),J=k(),Q(z.$$.fragment),j=k(),M=b("br"),H=k(),T=b("br"),I=k(),Q(u.$$.fragment),O(s,"class","_g-letter-date-faithfully-alignment text-center"),O(C,"class","flex"),O(S,"class","w-[100px]"),O(W,"class","max-w-[calc(100%-100px)]"),O(P,"class","flex")},m(D,g){p(D,e,g),a(e,t),a(e,i),a(e,r),a(e,n),a(e,s),a(s,f),a(e,d),a(e,_),a(e,w),a(e,c),a(c,C),a(c,R),a(c,P),a(P,S),a(P,N),a(P,W),a(W,V),a(e,v),a(e,F),a(e,J),Y(z,e,null),a(e,j),a(e,M),a(e,H),a(e,T),a(e,I),Y(u,e,null),$=!0},p(D,g){var Z;(!$||g&2)&&o!==(o=h(((Z=D[1])==null?void 0:Z.generatedDate)??new Date,!1)+"")&&q(f,o),(!$||g&4)&&q(V,D[2]);const E={};g&35&&(E.$$scope={dirty:g,ctx:D}),z.$set(E)},i(D){$||(U(z.$$.fragment,D),U(u.$$.fragment,D),$=!0)},o(D){B(z.$$.fragment,D),B(u.$$.fragment,D),$=!1},d(D){D&&m(e),X(z),X(u)}}}function kl(l){var ce,Ce,Pe,G,ne;let e,t,i,r,n=h(((ce=l[1])==null?void 0:ce.generatedDate)??new Date)+"",s,o,f,d,_,w,c,C,R,P,S,N,W,V,v,F,J,z,j=((Ce=l[1])==null?void 0:Ce.employeeNameTH)+"",M,H,T=h((Pe=l[1])==null?void 0:Pe.dateJoinedCompany)+"",I,u,$,L=_e(l[0],l[3])+"",D,g,E=((G=l[1])==null?void 0:G.positionTH)+"",Z,te=((ne=l[1])==null?void 0:ne.departmentFullTH)+"",le,ie,ue,pe,ke,De,A,K;return A=new Me({}),{c(){e=b("div"),t=b("br"),i=k(),r=b("div"),s=y(n),o=k(),f=b("br"),d=k(),_=b("div"),w=b("div"),w.innerHTML=`<div class="w-[50px]">เรื่อง</div> 
        <div>รับรองการเป็นพนักงาน</div>`,c=k(),C=b("div"),R=b("div"),R.textContent="เรียน",P=k(),S=b("div"),N=y(l[2]),W=k(),V=b("br"),v=k(),F=b("div"),J=y("บริษัทฯ ขอรับรองว่า "),z=b("span"),M=y(j),H=y(`
      เป็นพนักงานของบริษัทฯ เข้าทำงานตั้งแต่วันที่
      `),I=y(T),u=k(),$=new We(!1),D=y(" ในตำแหน่ง "),g=new We(!1),Z=k(),le=y(te),ie=k(),ue=b("br"),pe=k(),ke=b("br"),De=k(),Q(A.$$.fragment),O(r,"class","_g-letter-date-faithfully-alignment text-center"),O(w,"class","flex"),O(R,"class","w-[50px]"),O(S,"class","max-w-[calc(100%-50px)]"),O(C,"class","flex"),O(z,"class","whitespace-nowrap"),$.a=D,g.a=Z,O(F,"class","indent-8")},m(x,oe){p(x,e,oe),a(e,t),a(e,i),a(e,r),a(r,s),a(e,o),a(e,f),a(e,d),a(e,_),a(_,w),a(_,c),a(_,C),a(C,R),a(C,P),a(C,S),a(S,N),a(e,W),a(e,V),a(e,v),a(e,F),a(F,J),a(F,z),a(z,M),a(F,H),a(F,I),a(F,u),$.m(L,F),a(F,D),g.m(E,F),a(F,Z),a(F,le),a(e,ie),a(e,ue),a(e,pe),a(e,ke),a(e,De),Y(A,e,null),K=!0},p(x,oe){var Te,Ve,Ae,st,rt;(!K||oe&2)&&n!==(n=h(((Te=x[1])==null?void 0:Te.generatedDate)??new Date)+"")&&q(s,n),(!K||oe&4)&&q(N,x[2]),(!K||oe&2)&&j!==(j=((Ve=x[1])==null?void 0:Ve.employeeNameTH)+"")&&q(M,j),(!K||oe&2)&&T!==(T=h((Ae=x[1])==null?void 0:Ae.dateJoinedCompany)+"")&&q(I,T),(!K||oe&1)&&L!==(L=_e(x[0],x[3])+"")&&$.p(L),(!K||oe&2)&&E!==(E=((st=x[1])==null?void 0:st.positionTH)+"")&&g.p(E),(!K||oe&2)&&te!==(te=((rt=x[1])==null?void 0:rt.departmentFullTH)+"")&&q(le,te)},i(x){K||(U(A.$$.fragment,x),K=!0)},o(x){B(A.$$.fragment,x),K=!1},d(x){x&&m(e),X(A)}}}function Dl(l){var M,H,T,I;let e,t=((M=l[1])==null?void 0:M.employeeName)+"",i,r,n=(l[0]?re.top:re.tes)+"",s,o,f=se((H=l[1])==null?void 0:H.gender,!0)+"",d,_,w=h((T=l[1])==null?void 0:T.dateJoinedCompany,!1)+"",c,C,R=se((I=l[1])==null?void 0:I.gender)+"",P,S,N=_e(l[0],l[3])+"",W,V,v,F,J,z,j;return{c(){e=y("This is to certify that "),i=y(t),r=y(` is a permanent employee of
      `),s=y(n),o=y(". "),d=y(f),_=y(`
      has joined the Company since
      `),c=y(w),C=y(". At present, "),P=y(R),S=y(" is "),W=y(N),V=y(` the position of
      `),v=b("span"),J=y(".")},m(u,$){var L;p(u,e,$),p(u,i,$),p(u,r,$),p(u,s,$),p(u,o,$),p(u,d,$),p(u,_,$),p(u,c,$),p(u,C,$),p(u,P,$),p(u,S,$),p(u,W,$),p(u,V,$),p(u,v,$),p(u,J,$),z||(j=Je(F=je.call(null,v,(L=l[1])==null?void 0:L.position)),z=!0)},p(u,$){var L,D,g,E,Z;$&2&&t!==(t=((L=u[1])==null?void 0:L.employeeName)+"")&&q(i,t),$&1&&n!==(n=(u[0]?re.top:re.tes)+"")&&q(s,n),$&2&&f!==(f=se((D=u[1])==null?void 0:D.gender,!0)+"")&&q(d,f),$&2&&w!==(w=h((g=u[1])==null?void 0:g.dateJoinedCompany,!1)+"")&&q(c,w),$&2&&R!==(R=se((E=u[1])==null?void 0:E.gender)+"")&&q(P,R),$&1&&N!==(N=_e(u[0],u[3])+"")&&q(W,N),F&&qe(F.update)&&$&2&&F.update.call(null,(Z=u[1])==null?void 0:Z.position)},d(u){u&&m(e),u&&m(i),u&&m(r),u&&m(s),u&&m(o),u&&m(d),u&&m(_),u&&m(c),u&&m(C),u&&m(P),u&&m(S),u&&m(W),u&&m(V),u&&m(v),u&&m(J),z=!1,j()}}}function Cl(l){let e,t,i,r;const n=[kl,yl],s=[];function o(f,d){return f[3]?0:1}return e=o(l),t=s[e]=n[e](l),{c(){t.c(),i=Oe()},m(f,d){s[e].m(f,d),p(f,i,d),r=!0},p(f,[d]){t.p(f,d)},i(f){r||(U(t),r=!0)},o(f){B(t),r=!1},d(f){s[e].d(f),f&&m(i)}}}function Pl(l,e,t){let{isTop:i}=e,{language:r=void 0}=e,{letter:n={}}=e,{letterToText:s=""}=e;const o=r===ee.RecommendationLetterLanguage.Thai;return l.$$set=f=>{"isTop"in f&&t(0,i=f.isTop),"language"in f&&t(4,r=f.language),"letter"in f&&t(1,n=f.letter),"letterToText"in f&&t(2,s=f.letterToText)},[i,n,s,o,r]}class Sl extends de{constructor(e){super(),ve(this,e,Pl,Cl,be,{isTop:0,language:4,letter:1,letterToText:2})}}function Rl(l){let e,t;return{c(){e=b("img"),Ie(e.src,t=(Tt??"")+"/images/TES-Template.png")||O(e,"src",t),O(e,"alt","tes-template")},m(i,r){p(i,e,r)},p:Ge,d(i){i&&m(e)}}}function Hl(l){let e,t;return{c(){e=b("img"),Ie(e.src,t=(Tt??"")+"/images/TOP-Template.png")||O(e,"src",t),O(e,"alt","top-template")},m(i,r){p(i,e,r)},p:Ge,d(i){i&&m(e)}}}function Ml(l){let e,t;const i=[{letter:l[1]},l[4]];let r={};for(let n=0;n<i.length;n+=1)r=fe(r,i[n]);return e=new nl({props:r}),{c(){Q(e.$$.fragment)},m(n,s){Y(e,n,s),t=!0},p(n,s){const o=s&18?Le(i,[s&2&&{letter:n[1]},s&16&&ye(n[4])]):{};e.$set(o)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Nl(l){let e,t;const i=[{letter:l[1]},{isTop:l[2]},l[4]];let r={};for(let n=0;n<i.length;n+=1)r=fe(r,i[n]);return e=new Sl({props:r}),{c(){Q(e.$$.fragment)},m(n,s){Y(e,n,s),t=!0},p(n,s){const o=s&22?Le(i,[s&2&&{letter:n[1]},s&4&&{isTop:n[2]},s&16&&ye(n[4])]):{};e.$set(o)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Fl(l){let e,t;const i=[{letter:l[1]},{isTop:l[2]},l[4]];let r={};for(let n=0;n<i.length;n+=1)r=fe(r,i[n]);return e=new Ll({props:r}),{c(){Q(e.$$.fragment)},m(n,s){Y(e,n,s),t=!0},p(n,s){const o=s&22?Le(i,[s&2&&{letter:n[1]},s&4&&{isTop:n[2]},s&16&&ye(n[4])]):{};e.$set(o)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function El(l){let e,t;const i=[{letter:l[1]},{isTop:l[2]},l[4]];let r={};for(let n=0;n<i.length;n+=1)r=fe(r,i[n]);return e=new bl({props:r}),{c(){Q(e.$$.fragment)},m(n,s){Y(e,n,s),t=!0},p(n,s){const o=s&22?Le(i,[s&2&&{letter:n[1]},s&4&&{isTop:n[2]},s&16&&ye(n[4])]):{};e.$set(o)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Il(l){let e,t;const i=[{letter:l[1]},{isTop:l[2]},l[4]];let r={};for(let n=0;n<i.length;n+=1)r=fe(r,i[n]);return e=new ul({props:r}),{c(){Q(e.$$.fragment)},m(n,s){Y(e,n,s),t=!0},p(n,s){const o=s&22?Le(i,[s&2&&{letter:n[1]},s&4&&{isTop:n[2]},s&16&&ye(n[4])]):{};e.$set(o)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function zl(l){let e,t,i,r,n,s,o,f;function d(P,S){return P[2]?Hl:Rl}let w=d(l)(l);const c=[Il,El,Fl,Nl,Ml],C=[];function R(P,S){return P[0]===ee.RecommendationLetterType.SalaryLetterForFinancial?0:P[0]===ee.RecommendationLetterType.SalaryLetterWithLeaveForVisa?1:P[0]===ee.RecommendationLetterType.SalaryLetterWithoutLeaveForVisa?2:P[0]===ee.RecommendationLetterType.WorkLetterWithoutSalary?3:P[0]===ee.RecommendationLetterType.GrantedLetter?4:-1}return~(s=R(l))&&(o=C[s]=c[s](l)),{c(){e=b("div"),t=b("figure"),w.c(),i=k(),r=b("div"),n=k(),o&&o.c(),O(t,"class","absolute top-0 left-0 -z-[1]"),O(r,"class","h-[98px]"),O(e,"class","_letter-wrapper svelte-rcignz"),tt(e,"_preview",l[3])},m(P,S){p(P,e,S),a(e,t),w.m(t,null),a(e,i),a(e,r),a(e,n),~s&&C[s].m(e,null),f=!0},p(P,[S]){w.p(P,S);let N=s;s=R(P),s===N?~s&&C[s].p(P,S):(o&&(Se(),B(C[N],1,1,()=>{C[N]=null}),Re()),~s?(o=C[s],o?o.p(P,S):(o=C[s]=c[s](P),o.c()),U(o,1),o.m(e,null)):o=null)},i(P){f||(U(o),f=!0)},o(P){B(o),f=!1},d(P){P&&m(e),w.d(),~s&&C[s].d()}}}function h(l,e=!0){if(l){const t=e?"dd MMMM yyyy":"MMMM dd, yyyy",i=e?{outputCalendar:"buddhist",locale:"th"}:void 0;return Mt.fromJSDate(l).toFormat(t,i)}return"-"}function se(l,e=!1){return e?l==="Male"?"He":"She":l==="Male"?"he":"she"}function _e(l,e){return l?e?"":"holding":e?'ปัจจุบันได้รับมอบหมายให้ไปปฏิบัติงานกับ<span class="whitespace-nowrap">บริษัท ไทยออยล์ จำกัด (มหาชน)</span>':"seconded to Thai Oil Public Company Limited in"}const re={tes:"Thaioil Energy Services Company Limited",top:"Thaioil Public Company Limited"};function Ol(l,e,t){var _;const i=["isPdfGenerating","letterType","letter"];let r=Ee(e,i),{isPdfGenerating:n=!1}=e,{letterType:s=void 0}=e,{letter:o={}}=e;const f=((_=o==null?void 0:o.companyName)==null?void 0:_.toLowerCase())==="top",d=!n;return l.$$set=w=>{e=fe(fe({},e),nt(w)),t(4,r=Ee(e,i)),"isPdfGenerating"in w&&t(5,n=w.isPdfGenerating),"letterType"in w&&t(0,s=w.letterType),"letter"in w&&t(1,o=w.letter)},[s,o,f,d,r,n]}class kt extends de{constructor(e){super(),ve(this,e,Ol,zl,be,{isPdfGenerating:5,letterType:0,letter:1})}}function vt(l){let e,t,i,r,n;const s=[{isPdfGenerating:l[2]},l[3]];let o={};for(let f=0;f<s.length;f+=1)o=fe(o,s[f]);return r=new kt({props:o}),{c(){e=b("div"),e.textContent="Generating PDF ...",t=k(),i=b("div"),Q(r.$$.fragment),O(e,"class","_g-pdf-generating"),O(i,"class","_g-export-letter-container _letter-container svelte-1d3j65e")},m(f,d){p(f,e,d),p(f,t,d),p(f,i,d),Y(r,i,null),l[4](i),n=!0},p(f,d){const _=d&12?Le(s,[d&4&&{isPdfGenerating:f[2]},d&8&&ye(f[3])]):{};r.$set(_)},i(f){n||(U(r.$$.fragment,f),n=!0)},o(f){B(r.$$.fragment,f),n=!1},d(f){f&&m(e),f&&m(t),f&&m(i),X(r),l[4](null)}}}function Gl(l){let e,t,i;const r=[l[3]];let n={};for(let s=0;s<r.length;s+=1)n=fe(n,r[s]);return t=new kt({props:n}),{c(){e=b("div"),Q(t.$$.fragment),O(e,"class","_letter-container mx-auto svelte-1d3j65e")},m(s,o){p(s,e,o),Y(t,e,null),i=!0},p(s,o){const f=o&8?Le(r,[ye(s[3])]):{};t.$set(f)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){B(t.$$.fragment,s),i=!1},d(s){s&&m(e),X(t)}}}function Wl(l){let e,t,i,r=l[2]&&vt(l),n={showFooter:!1,maxWidth:"800px",$$slots:{default:[Gl]},$$scope:{ctx:l}};return t=new yt({props:n}),l[5](t),{c(){r&&r.c(),e=k(),Q(t.$$.fragment)},m(s,o){r&&r.m(s,o),p(s,e,o),Y(t,s,o),i=!0},p(s,[o]){s[2]?r?(r.p(s,o),o&4&&U(r,1)):(r=vt(s),r.c(),U(r,1),r.m(e.parentNode,e)):r&&(Se(),B(r,1,1,()=>{r=null}),Re());const f={};o&72&&(f.$$scope={dirty:o,ctx:s}),t.$set(f)},i(s){i||(U(r),U(t.$$.fragment,s),i=!0)},o(s){B(r),B(t.$$.fragment,s),i=!1},d(s){r&&r.d(s),s&&m(e),l[5](null),X(t,s)}}}function Jl(l,e,t){const i=["isPdfGenerating","previewModal","exportPDFElement"];let r=Ee(e,i),{isPdfGenerating:n=!1}=e,{previewModal:s}=e,{exportPDFElement:o}=e;function f(_){ae[_?"unshift":"push"](()=>{o=_,t(1,o)})}function d(_){ae[_?"unshift":"push"](()=>{s=_,t(0,s)})}return l.$$set=_=>{e=fe(fe({},e),nt(_)),t(3,r=Ee(e,i)),"isPdfGenerating"in _&&t(2,n=_.isPdfGenerating),"previewModal"in _&&t(0,s=_.previewModal),"exportPDFElement"in _&&t(1,o=_.exportPDFElement)},[s,o,n,r,f,d]}class ql extends de{constructor(e){super(),ve(this,e,Jl,Wl,be,{isPdfGenerating:2,previewModal:0,exportPDFElement:1})}}const jl=l=>{const e={isValid:!0,errorPath:void 0,inner:[]},t=Jt({letterType:pt("ประเภทหนังสือแนะนำ"),language:pt("Language"),organization:et.label("หน่วยงาน"),otherOrganization:ut().nullable().when("organization",{is:i=>i==="Other",then:et.label("ระบุชื่อหน่วยงาน"),otherwise:ut().nullable()}),startLeaveDate:Ke().nullable().when("letterType",{is:i=>i.key===ee.RecommendationLetterType.SalaryLetterWithLeaveForVisa,then:mt.label("วันที่เริ่มต้นการลา"),otherwise:Ke().nullable()}),endLeaveDate:Ke().nullable().when("letterType",{is:i=>i.key===ee.RecommendationLetterType.SalaryLetterWithLeaveForVisa,then:mt.label("วันที่สิ้นสุดการลา"),otherwise:Ke().nullable()}),purpose:et.label("วัตถุประสงค์ของการขอจดหมายรับรอง")});try{t.validateSync(l,{abortEarly:!1})}catch(i){console.log("error",JSON.stringify(i)),Object.keys(i).length&&(console.log("path",i.inner[0].path),console.log("errors",i.errors[0]),e.isValid=!1,e.errorPath=(i.inner[0].path??"").split(/\.|\[/),e.inner=i.inner,wt.error(i.errors[0]))}return e};function bt(l){var H;let e,t,i,r,n,s,o,f,d=(Ye[(H=l[0].letterType)==null?void 0:H.key]??"-")+"",_,w,c,C,R,P,S,N,W,V,v,F,J,z;C=new Xe({props:{class:"mr-2 w-[96px]",label:"Preview",outline:!0,isLoading:l[3]}}),C.$on("click",l[16]),P=new Xe({props:{icon:"ic-pdf text-pdf",label:"Generated to PDF",outline:!0,isLoading:l[3]}}),P.$on("click",l[17]),W=new Ot({props:{class:"desktop:w-5/6",$$slots:{default:[Xl]},$$scope:{ctx:l}}});let j={};v=new Wt({props:j}),l[32](v);let M={isLoading:l[3],nextLabel:"Confirm",onConfirm:l[18],$$slots:{title:[hl],default:[Zl]},$$scope:{ctx:l}};return J=new yt({props:M}),l[33](J),{c(){e=b("div"),t=b("div"),i=b("span"),i.innerHTML='<i class="ic ic-recommendation-letter-square"></i>',r=k(),n=b("span"),s=b("div"),s.textContent="Recommendation Letter",o=k(),f=b("div"),_=y(d),w=k(),c=b("div"),Q(C.$$.fragment),R=k(),Q(P.$$.fragment),S=k(),N=b("div"),Q(W.$$.fragment),V=k(),Q(v.$$.fragment),F=k(),Q(J.$$.fragment),O(i,"class","icon svelte-orlue1"),O(f,"class","font-weight-bold text-size-xlarge"),O(t,"class","icon-text svelte-orlue1"),O(c,"class","mt-2 flex justify-end"),O(N,"class","mt-2 desktop:flex justify-center"),O(e,"class","bg-gray-100 border-gray-400 border p-2 rounded")},m(T,I){p(T,e,I),a(e,t),a(t,i),a(t,r),a(t,n),a(n,s),a(n,o),a(n,f),a(f,_),a(e,w),a(e,c),Y(C,c,null),a(c,R),Y(P,c,null),a(e,S),a(e,N),Y(W,N,null),p(T,V,I),Y(v,T,I),p(T,F,I),Y(J,T,I),z=!0},p(T,I){var E;(!z||I[0]&1)&&d!==(d=(Ye[(E=T[0].letterType)==null?void 0:E.key]??"-")+"")&&q(_,d);const u={};I[0]&8&&(u.isLoading=T[3]),C.$set(u);const $={};I[0]&8&&($.isLoading=T[3]),P.$set($);const L={};I[0]&3211|I[1]&16384&&(L.$$scope={dirty:I,ctx:T}),W.$set(L);const D={};v.$set(D);const g={};I[0]&8&&(g.isLoading=T[3]),I[0]&1|I[1]&16384&&(g.$$scope={dirty:I,ctx:T}),J.$set(g)},i(T){z||(U(C.$$.fragment,T),U(P.$$.fragment,T),U(W.$$.fragment,T),U(v.$$.fragment,T),U(J.$$.fragment,T),z=!0)},o(T){B(C.$$.fragment,T),B(P.$$.fragment,T),B(W.$$.fragment,T),B(v.$$.fragment,T),B(J.$$.fragment,T),z=!1},d(T){T&&m(e),X(C),X(P),X(W),T&&m(V),l[32](null),X(v,T),T&&m(F),l[33](null),X(J,T)}}}function Vl(l){let e,t,i,r,n,s=(l[0].employeeId??"-")+"",o,f,d,_,w,c,C=(l[0].employeeName??"-")+"",R,P,S,N,W,V,v,F,J,z,j,M,H=(l[0].unit??"-")+"",T,I,u,$,L,D,g=Ne(l[0].dateJoinedCompany)+"",E,Z,te;return{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Employee ID :",r=k(),n=b("span"),o=y(s),f=k(),d=b("div"),_=b("span"),_.textContent="Employee Name :",w=k(),c=b("span"),R=y(C),P=k(),S=b("div"),N=b("span"),N.textContent="Positions:",W=k(),V=b("span"),F=k(),J=b("div"),z=b("span"),z.textContent="Unit :",j=k(),M=b("span"),T=y(H),I=k(),u=b("div"),$=b("span"),$.textContent="Date Joined Company :",L=k(),D=b("span"),E=y(g),O(i,"class","text-gray-800"),O(_,"class","text-gray-800"),O(N,"class","text-gray-800"),O(z,"class","text-gray-800"),O($,"class","text-gray-800"),O(e,"class","_collapse-content svelte-orlue1")},m(le,ie){p(le,e,ie),a(e,t),a(t,i),a(t,r),a(t,n),a(n,o),a(e,f),a(e,d),a(d,_),a(d,w),a(d,c),a(c,R),a(e,P),a(e,S),a(S,N),a(S,W),a(S,V),a(e,F),a(e,J),a(J,z),a(J,j),a(J,M),a(M,T),a(e,I),a(e,u),a(u,$),a(u,L),a(u,D),a(D,E),Z||(te=Je(v=je.call(null,V,l[0].position??"-")),Z=!0)},p(le,ie){ie[0]&1&&s!==(s=(le[0].employeeId??"-")+"")&&q(o,s),ie[0]&1&&C!==(C=(le[0].employeeName??"-")+"")&&q(R,C),v&&qe(v.update)&&ie[0]&1&&v.update.call(null,le[0].position??"-"),ie[0]&1&&H!==(H=(le[0].unit??"-")+"")&&q(T,H),ie[0]&1&&g!==(g=Ne(le[0].dateJoinedCompany)+"")&&q(E,g)},d(le){le&&m(e),Z=!1,te()}}}function Al(l){var $;let e,t,i,r,n,s=(l[0].documentNo??"-")+"",o,f,d,_,w,c,C=Ne(l[0].createdDate)+"",R,P,S,N,W,V,v=Ne(l[0].generatedDate)+"",F,J,z,j,M,H=(ot[($=l[0].letterStatus)==null?void 0:$.key]??"-")+"",T,I,u;return{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Document No. :",r=k(),n=b("span"),o=y(s),f=k(),d=b("div"),_=b("span"),_.textContent="Created Date :",w=k(),c=b("span"),R=y(C),P=k(),S=b("div"),N=b("span"),N.textContent="Generated to PDF Date :",W=k(),V=b("span"),F=y(v),J=k(),z=b("div"),j=b("span"),j.textContent="Current Status :",M=k(),T=y(H),I=k(),u=b("span"),O(i,"class","text-gray-800"),O(_,"class","text-gray-800"),O(N,"class","text-gray-800"),O(j,"class","text-gray-800"),O(e,"class","_collapse-content svelte-orlue1")},m(L,D){p(L,e,D),a(e,t),a(t,i),a(t,r),a(t,n),a(n,o),a(e,f),a(e,d),a(d,_),a(d,w),a(d,c),a(c,R),a(e,P),a(e,S),a(S,N),a(S,W),a(S,V),a(V,F),a(e,J),a(e,z),a(z,j),a(z,M),a(z,T),a(z,I),a(z,u)},p(L,D){var g;D[0]&1&&s!==(s=(L[0].documentNo??"-")+"")&&q(o,s),D[0]&1&&C!==(C=Ne(L[0].createdDate)+"")&&q(R,C),D[0]&1&&v!==(v=Ne(L[0].generatedDate)+"")&&q(F,v),D[0]&1&&H!==(H=(ot[(g=L[0].letterStatus)==null?void 0:g.key]??"-")+"")&&q(T,H)},d(L){L&&m(e)}}}function ct(l){let e,t,i;function r(s){l[22](s)}let n={label:"Language",letterType:l[12],required:!0,labelClass:"text-gray-800",disabled:!l[11]};return l[0].language!==void 0&&(n.value=l[0].language),e=new Vt({props:n}),ae.push(()=>ge(e,"value",r)),e.$on("change",l[23]),{c(){Q(e.$$.fragment)},m(s,o){Y(e,s,o),i=!0},p(s,o){const f={};o[0]&2048&&(f.disabled=!s[11]),!t&&o[0]&1&&(t=!0,f.value=s[0].language,$e(()=>t=!1)),e.$set(f)},i(s){i||(U(e.$$.fragment,s),i=!0)},o(s){B(e.$$.fragment,s),i=!1},d(s){X(e,s)}}}function Ul(l){var s;let e,t,i;function r(o){l[26](o)}let n={required:!0,letterType:(s=l[0].letterType)==null?void 0:s.value,labelClass:"text-gray-800",label:"หน่วยงาน",isThai:l[10],disabled:!l[11]};return l[0].organization!==void 0&&(n.value=l[0].organization),e=new It({props:n}),ae.push(()=>ge(e,"value",r)),e.$on("change",l[27]),{c(){Q(e.$$.fragment)},m(o,f){Y(e,o,f),i=!0},p(o,f){var _;const d={};f[0]&1&&(d.letterType=(_=o[0].letterType)==null?void 0:_.value),f[0]&1024&&(d.isThai=o[10]),f[0]&2048&&(d.disabled=!o[11]),!t&&f[0]&1&&(t=!0,d.value=o[0].organization,$e(()=>t=!1)),e.$set(d)},i(o){i||(U(e.$$.fragment,o),i=!0)},o(o){B(e.$$.fragment,o),i=!1},d(o){X(e,o)}}}function Bl(l){let e,t,i;function r(s){l[25](s)}let n={required:!0,label:"หน่วยงาน",disabled:!l[11]};return l[0].organization!==void 0&&(n.value=l[0].organization),e=new Lt({props:n}),ae.push(()=>ge(e,"value",r)),e.$on("change",l[15]),{c(){Q(e.$$.fragment)},m(s,o){Y(e,s,o),i=!0},p(s,o){const f={};o[0]&2048&&(f.disabled=!s[11]),!t&&o[0]&1&&(t=!0,f.value=s[0].organization,$e(()=>t=!1)),e.$set(f)},i(s){i||(U(e.$$.fragment,s),i=!0)},o(s){B(e.$$.fragment,s),i=!1},d(s){X(e,s)}}}function Kl(l){let e,t,i,r,n,s;function o(_){l[28](_)}let f={required:l[1],label:"ระบุชื่อหน่วยงาน",disabled:!(l[1]&&l[11])};l[0].otherOrganization!==void 0&&(f.value=l[0].otherOrganization),t=new Lt({props:f}),ae.push(()=>ge(t,"value",o)),t.$on("change",l[15]);let d=l[13].SalaryLetterWithLeaveForVisa===l[12]&&Ql(l);return{c(){e=b("div"),Q(t.$$.fragment),r=k(),d&&d.c(),n=Oe()},m(_,w){p(_,e,w),Y(t,e,null),p(_,r,w),d&&d.m(_,w),p(_,n,w),s=!0},p(_,w){const c={};w[0]&2&&(c.required=_[1]),w[0]&2050&&(c.disabled=!(_[1]&&_[11])),!i&&w[0]&1&&(i=!0,c.value=_[0].otherOrganization,$e(()=>i=!1)),t.$set(c),_[13].SalaryLetterWithLeaveForVisa===_[12]&&d.p(_,w)},i(_){s||(U(t.$$.fragment,_),U(d),s=!0)},o(_){B(t.$$.fragment,_),B(d),s=!1},d(_){_&&m(e),X(t),_&&m(r),d&&d.d(_),_&&m(n)}}}function Ql(l){let e,t,i,r,n,s,o;function f(c){l[29](c)}let d={required:!0,labelClass:"text-gray-800",label:"วันที่เริ่มต้นการลา:",maxDate:l[0].endLeaveDate,disabled:!l[11]};l[0].startLeaveDate!==void 0&&(d.value=l[0].startLeaveDate),t=new ft({props:d}),ae.push(()=>ge(t,"value",f)),t.$on("change",l[15]);function _(c){l[30](c)}let w={required:!0,labelClass:"text-gray-800",label:"วันที่สิ้นสุดการลา:",minDate:l[0].startLeaveDate,disabled:!l[11]};return l[0].endLeaveDate!==void 0&&(w.value=l[0].endLeaveDate),n=new ft({props:w}),ae.push(()=>ge(n,"value",_)),n.$on("change",l[15]),{c(){e=b("div"),Q(t.$$.fragment),r=k(),Q(n.$$.fragment),O(e,"class","flex gap-x-2")},m(c,C){p(c,e,C),Y(t,e,null),a(e,r),Y(n,e,null),o=!0},p(c,C){const R={};C[0]&1&&(R.maxDate=c[0].endLeaveDate),C[0]&2048&&(R.disabled=!c[11]),!i&&C[0]&1&&(i=!0,R.value=c[0].startLeaveDate,$e(()=>i=!1)),t.$set(R);const P={};C[0]&1&&(P.minDate=c[0].startLeaveDate),C[0]&2048&&(P.disabled=!c[11]),!s&&C[0]&1&&(s=!0,P.value=c[0].endLeaveDate,$e(()=>s=!1)),n.$set(P)},i(c){o||(U(t.$$.fragment,c),U(n.$$.fragment,c),o=!0)},o(c){B(t.$$.fragment,c),B(n.$$.fragment,c),o=!1},d(c){c&&m(e),X(t),X(n)}}}function Yl(l){var I;let e,t,i,r,n,s=(Ye[(I=l[0].letterType)==null?void 0:I.key]??l[12]??"-")+"",o,f,d,_,w,c,C,R,P,S,N,W,V=![l[13].WorkLetterWithoutSalary].some(l[21]),v,F=l[0]&&ct(l);function J(u){l[24](u)}let z={required:!0,label:"วัตถุประสงค์ของการขอจดหมายรับรอง",disabled:!l[11]};l[0].purpose!==void 0&&(z.value=l[0].purpose),c=new zt({props:z}),ae.push(()=>ge(c,"value",J)),c.$on("change",l[15]);const j=[Bl,Ul],M=[];function H(u,$){var L;return u[12]===u[13].WorkLetterWithoutSalary?0:(L=u[0].letterType)!=null&&L.value?1:-1}~(S=H(l))&&(N=M[S]=j[S](l));let T=V&&Kl(l);return{c(){e=b("div"),t=b("div"),i=b("div"),i.textContent="Letter Type",r=k(),n=b("div"),o=y(s),f=k(),d=b("div"),F&&F.c(),_=k(),w=b("div"),Q(c.$$.fragment),R=k(),P=b("div"),N&&N.c(),W=k(),T&&T.c(),O(i,"class","text-gray-800"),O(t,"class","col-span-2"),O(e,"class","_collapse-content svelte-orlue1")},m(u,$){p(u,e,$),a(e,t),a(t,i),a(t,r),a(t,n),a(n,o),a(e,f),a(e,d),F&&F.m(d,null),a(e,_),a(e,w),Y(c,w,null),a(e,R),a(e,P),~S&&M[S].m(P,null),a(e,W),T&&T.m(e,null),v=!0},p(u,$){var g;(!v||$[0]&1)&&s!==(s=(Ye[(g=u[0].letterType)==null?void 0:g.key]??u[12]??"-")+"")&&q(o,s),u[0]?F?(F.p(u,$),$[0]&1&&U(F,1)):(F=ct(u),F.c(),U(F,1),F.m(d,null)):F&&(Se(),B(F,1,1,()=>{F=null}),Re());const L={};$[0]&2048&&(L.disabled=!u[11]),!C&&$[0]&1&&(C=!0,L.value=u[0].purpose,$e(()=>C=!1)),c.$set(L);let D=S;S=H(u),S===D?~S&&M[S].p(u,$):(N&&(Se(),B(M[D],1,1,()=>{M[D]=null}),Re()),~S?(N=M[S],N?N.p(u,$):(N=M[S]=j[S](u),N.c()),U(N,1),N.m(P,null)):N=null),V&&T.p(u,$)},i(u){v||(U(F),U(c.$$.fragment,u),U(N),U(T),v=!0)},o(u){B(F),B(c.$$.fragment,u),B(N),B(T),v=!1},d(u){u&&m(e),F&&F.d(),X(c),~S&&M[S].d(),T&&T.d()}}}function gt(l){let e,t,i,r;t=new Xe({props:{isLoading:l[3],outline:!0,class:"mr-2 w-[96px]",label:"Cancel"}}),t.$on("click",l[14]);let n=l[11]&&$t(l);return{c(){e=b("div"),Q(t.$$.fragment),i=k(),n&&n.c(),O(e,"class","flex justify-end px-[1rem]")},m(s,o){p(s,e,o),Y(t,e,null),a(e,i),n&&n.m(e,null),r=!0},p(s,o){const f={};o[0]&8&&(f.isLoading=s[3]),t.$set(f),s[11]?n?(n.p(s,o),o[0]&2048&&U(n,1)):(n=$t(s),n.c(),U(n,1),n.m(e,null)):n&&(Se(),B(n,1,1,()=>{n=null}),Re())},i(s){r||(U(t.$$.fragment,s),U(n),r=!0)},o(s){B(t.$$.fragment,s),B(n),r=!1},d(s){s&&m(e),X(t),n&&n.d()}}}function $t(l){let e,t;return e=new Xe({props:{isLoading:l[3],primary:!0,class:"w-[96px]",label:"Save"}}),e.$on("click",l[31]),{c(){Q(e.$$.fragment)},m(i,r){Y(e,i,r),t=!0},p(i,r){const n={};r[0]&8&&(n.isLoading=i[3]),e.$set(n)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){B(e.$$.fragment,i),t=!1},d(i){X(e,i)}}}function Xl(l){let e,t,i,r,n,s,o,f;e=new xe({props:{title:"EMPLOYEE INFORMATION",titleClass:"bg-gray-300 rounded",containerClass:"mb-3",$$slots:{default:[Vl]},$$scope:{ctx:l}}}),i=new xe({props:{title:"DOCUMENT INFORMATION",titleClass:"bg-gray-300 rounded",containerClass:"mb-3",$$slots:{default:[Al]},$$scope:{ctx:l}}}),n=new xe({props:{title:"LETTER INFORMATION",titleClass:"bg-gray-300 rounded",containerClass:"mb-4",$$slots:{default:[Yl]},$$scope:{ctx:l}}});let d=!l[7]&&gt(l);return{c(){Q(e.$$.fragment),t=k(),Q(i.$$.fragment),r=k(),Q(n.$$.fragment),s=k(),d&&d.c(),o=Oe()},m(_,w){Y(e,_,w),p(_,t,w),Y(i,_,w),p(_,r,w),Y(n,_,w),p(_,s,w),d&&d.m(_,w),p(_,o,w),f=!0},p(_,w){const c={};w[0]&1|w[1]&16384&&(c.$$scope={dirty:w,ctx:_}),e.$set(c);const C={};w[0]&1|w[1]&16384&&(C.$$scope={dirty:w,ctx:_}),i.$set(C);const R={};w[0]&3075|w[1]&16384&&(R.$$scope={dirty:w,ctx:_}),n.$set(R),_[7]?d&&(Se(),B(d,1,1,()=>{d=null}),Re()):d?(d.p(_,w),w[0]&128&&U(d,1)):(d=gt(_),d.c(),U(d,1),d.m(o.parentNode,o))},i(_){f||(U(e.$$.fragment,_),U(i.$$.fragment,_),U(n.$$.fragment,_),U(d),f=!0)},o(_){B(e.$$.fragment,_),B(i.$$.fragment,_),B(n.$$.fragment,_),B(d),f=!1},d(_){X(e,_),_&&m(t),X(i,_),_&&m(r),X(n,_),_&&m(s),d&&d.d(_),_&&m(o)}}}function Zl(l){let e,t,i,r,n=l[0].remaining+"",s,o;return{c(){e=b("p"),e.textContent=`คุณได้ทำการตรวจสอบข้อมูลครบถ้วนและถูกต้อง
        และยืนยันที่จะทำการสร้างใบคำขอจากระบบอย่างเป็นทางการ`,t=k(),i=b("p"),r=y("*** คุณเหลือสิทธิ์ในการสร้างใบคำขอจำนวน "),s=y(n),o=y(" ใบ ***"),O(e,"class","text-center text-size-large"),O(i,"class","text-center text-size-large")},m(f,d){p(f,e,d),p(f,t,d),p(f,i,d),a(i,r),a(i,s),a(i,o)},p(f,d){d[0]&1&&n!==(n=f[0].remaining+"")&&q(s,n)},d(f){f&&m(e),f&&m(t),f&&m(i)}}}function hl(l){let e;return{c(){e=b("div"),e.innerHTML='<span class="font-weight-bold">ยืนยันการสร้างใบคำขอ</span>',O(e,"slot","title")},m(t,i){p(t,e,i)},p:Ge,d(t){t&&m(e)}}}function xl(l){let e,t,i=l[0]&&bt(l);return{c(){i&&i.c(),e=Oe()},m(r,n){i&&i.m(r,n),p(r,e,n),t=!0},p(r,n){r[0]?i?(i.p(r,n),n[0]&1&&U(i,1)):(i=bt(r),i.c(),U(i,1),i.m(e.parentNode,e)):i&&(Se(),B(i,1,1,()=>{i=null}),Re())},i(r){t||(U(i),t=!0)},o(r){B(i),t=!1},d(r){i&&i.d(r),r&&m(e)}}}function en(l){var _,w;let e,t,i,r,n,s;e=new Nt({props:{isShowLoading:l[2],$$slots:{default:[xl]},$$scope:{ctx:l}}});function o(c){l[34](c)}function f(c){l[35](c)}let d={language:(w=(_=l[0])==null?void 0:_.language)==null?void 0:w.key,letterToText:l[9],letter:l[0],letterType:l[12],isPdfGenerating:l[7]};return l[6]!==void 0&&(d.previewModal=l[6]),l[8]!==void 0&&(d.exportPDFElement=l[8]),i=new ql({props:d}),ae.push(()=>ge(i,"previewModal",o)),ae.push(()=>ge(i,"exportPDFElement",f)),{c(){Q(e.$$.fragment),t=k(),Q(i.$$.fragment)},m(c,C){Y(e,c,C),p(c,t,C),Y(i,c,C),s=!0},p(c,C){var S,N;const R={};C[0]&4&&(R.isShowLoading=c[2]),C[0]&3259|C[1]&16384&&(R.$$scope={dirty:C,ctx:c}),e.$set(R);const P={};C[0]&1&&(P.language=(N=(S=c[0])==null?void 0:S.language)==null?void 0:N.key),C[0]&512&&(P.letterToText=c[9]),C[0]&1&&(P.letter=c[0]),C[0]&128&&(P.isPdfGenerating=c[7]),!r&&C[0]&64&&(r=!0,P.previewModal=c[6],$e(()=>r=!1)),!n&&C[0]&256&&(n=!0,P.exportPDFElement=c[8],$e(()=>n=!1)),i.$set(P)},i(c){s||(U(e.$$.fragment,c),U(i.$$.fragment,c),s=!0)},o(c){B(e.$$.fragment,c),B(i.$$.fragment,c),s=!1},d(c){X(e,c),c&&m(t),X(i,c)}}}function tn(l,e,t){let i,r,n,s,o;He(l,ze,G=>t(38,o=G));let f=!1,d=!1,_=!1,w,c,C,R=!1,P;const S=Ze.letterId??null,N=Ze.letterType??null,W=Ze.parent;let V=ee.RecommendationLetterType,v,F=!1;function J(){he(W)}function z(){_=!0}function j(G){if(_)if(G)G.returnValue="Changes you made may not be saved.";else return confirm("Changes you made may not be saved.");return!0}async function M(){t(3,d=!0),Fe.update(G=>({...G,isPreview:!0})),await I(),t(3,d=!1),C.open()}function H(){var G;((G=v.letterStatus)==null?void 0:G.key)===ee.RecommendationLetterStatus.GeneratedToPDF?u(v):c.open()}function T(){c.close(),S?u(v):$().then(G=>{G&&u(G)})}async function I(){return N===ee.RecommendationLetterType.WorkLetterWithoutSalary?Promise.resolve(null):o!=null&&o.EmployeeId?Promise.resolve(o):Be.MonthlyIncome({employeeId:v.employeeId}).then(G=>{if(G.EmployeeId)return ze.set(G),G;throw wt.error("ไม่สามารถดึงข้อมูลเงินเดือนได้"),new Error(JSON.stringify(G))}).catch(G=>{throw t(3,d=!1),t(7,R=!1),new Error(G)})}async function u(G){var oe;Fe.update(Te=>({...Te,isPreview:!1}));const ne=new Promise(Te=>{{const Ve=lt.subscribe(Ae=>{Ae&&(Te(null),Ve())})}});t(7,R=!0),await at(),await ne,t(3,d=!0),await I(),t(3,d=!1),await at();let x;x=Be.GenerateRecommendationLetter({letterId:G.letterId,letterType:(oe=G.letterType)==null?void 0:oe.key}),x.then(()=>{var Te;Et.export(P,{fileName:`${(Te=G.letterType)==null?void 0:Te.value}${G.employeeName?`_${G.employeeName}`:""}`,margin:!1,scale:.8}).then(()=>{lt.set(!1),t(7,R=!1),F&&w.success("Export PDF Successfully").then(()=>{he(Ue.RecommendationLetterDetail,{parent:Ue.RecommendationLetter,letterId:G.letterId,letterType:G.letterType.key})}),S&&L()})}).catch(()=>{t(7,R=!1)})}async function $(G=!0){if(G){const{isValid:ne}=jl(v);if(!v.canCreate){_=!1,w.error("","คุณได้ทำการขอจดหมายรับรองการทำงานจากบริษัทครบจำนวนในเดือนนี้แล้ว โดยสามารถเข้ามาขอจดหมายใหม่ได้ในเดือนถัดไป").then(()=>{J()});return}if(!ne)return}return t(3,d=!0),Be.SaveRecommendationLetter({letter:v}).then(ne=>(t(0,v=ne),t(3,d=!1),_=!1,G?w.success("Save Successfully").then(()=>{he(Ue.RecommendationLetterDetail,{parent:Ue.RecommendationLetter,letterId:v.letterId,letterType:v.letterType.key})}):F=!0,ne)).catch(ne=>{t(3,d=!1)})}function L(){t(2,f=!0),Be.GetRecommendationLetterDetail({letterId:S,letterType:N}).then(G=>{var ne,x;t(2,f=!1),t(0,v=G),((ne=v.letterStatus)==null?void 0:ne.key)!==ee.RecommendationLetterStatus.GeneratedToPDF?N===ee.RecommendationLetterType.GrantedLetter?t(0,v.language={...v.language,key:ee.RecommendationLetterLanguage.Thai,value:Qe[ee.RecommendationLetterLanguage.Thai]},v):(N===ee.RecommendationLetterType.SalaryLetterWithLeaveForVisa||N===ee.RecommendationLetterType.SalaryLetterWithoutLeaveForVisa)&&t(0,v.language={...v.language,key:ee.RecommendationLetterLanguage.English,value:Qe[ee.RecommendationLetterLanguage.English]},v):t(0,v.language={...v.language,value:Qe[(x=v.language)==null?void 0:x.key]},v),v.positionTH&&t(0,v.positionTH=v.positionTH.replace("ผู้จัดการ",'<span class="whitespace-nowrap">ผู้จัดการ</span>'),v),D()}).catch(()=>{t(2,f=!0)})}function D(){var ne;const G=window.letterAssetsPath;((ne=v.language)==null?void 0:ne.key)===ee.RecommendationLetterLanguage.Thai?Fe.update(x=>({...x,logoUrl:`${G}${v.letterLogo}`,sealUrl:`${G}${v.letterStamp}`,faithfullyText:"ขอแสดงความนับถือ",letterHRName:v.letterHRNameTH,letterHRPosition:v.letterHRPositionTH,letterHRSignatureUrl:`${G}${v.letterHRSignatureTH}`})):Fe.update(x=>({...x,logoUrl:`${G}${v.letterLogo}`,sealUrl:`${G}${v.letterStamp}`,faithfullyText:"Yours faithfully,",letterHRName:v.letterHRNameEN,letterHRPosition:v.letterHRPosition,letterHRSignatureUrl:`${G}${v.letterHRSignatureEN}`}))}Ft(()=>{L(),window.addEventListener("beforeunload",j)});const g=G=>G===N;function E(G){l.$$.not_equal(v.language,G)&&(v.language=G,t(0,v))}const Z=()=>{D(),z(),t(0,v.organization="",v)};function te(G){l.$$.not_equal(v.purpose,G)&&(v.purpose=G,t(0,v))}function le(G){l.$$.not_equal(v.organization,G)&&(v.organization=G,t(0,v))}function ie(G){l.$$.not_equal(v.organization,G)&&(v.organization=G,t(0,v))}const ue=()=>{t(0,v.otherOrganization="",v),z()};function pe(G){l.$$.not_equal(v.otherOrganization,G)&&(v.otherOrganization=G,t(0,v))}function ke(G){l.$$.not_equal(v.startLeaveDate,G)&&(v.startLeaveDate=G,t(0,v))}function De(G){l.$$.not_equal(v.endLeaveDate,G)&&(v.endLeaveDate=G,t(0,v))}const A=()=>$();function K(G){ae[G?"unshift":"push"](()=>{w=G,t(4,w)})}function ce(G){ae[G?"unshift":"push"](()=>{c=G,t(5,c)})}function Ce(G){C=G,t(6,C)}function Pe(G){P=G,t(8,P)}return l.$$.update=()=>{var G,ne;l.$$.dirty[0]&1&&t(1,i=(v==null?void 0:v.organization)==="Other"),l.$$.dirty[0]&1&&t(11,r=((G=v==null?void 0:v.letterStatus)==null?void 0:G.key)!==ee.RecommendationLetterStatus.GeneratedToPDF),l.$$.dirty[0]&1&&t(10,n=((ne=v==null?void 0:v.language)==null?void 0:ne.key)===ee.RecommendationLetterLanguage.Thai),l.$$.dirty[0]&3&&t(9,s=i?v==null?void 0:v.otherOrganization:(v==null?void 0:v.organization)||"")},[v,i,f,d,w,c,C,R,P,s,n,r,N,V,J,z,M,H,T,$,D,g,E,Z,te,le,ie,ue,pe,ke,De,A,K,ce,Ce,Pe]}class ln extends de{constructor(e){super(),ve(this,e,tn,en,be,{},null,[-1,-1])}}new ln({target:document.getElementById("app")});
