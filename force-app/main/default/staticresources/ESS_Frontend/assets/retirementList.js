import{S as J,i as K,s as Q,M as X,w as x,x as E,t as N,b as j,y as T,C as Y,h as d,o as k,m as A,j as u,a as z,p as r,q as V,d as B,L as Z,B as W,F as ee,G as te}from"./MainLayout.js";import{E as D}from"./ESS_Retirement.service.js";import{f as ne}from"./formatter.js";import{B as q}from"./Button.js";import{C as se,r as P,T as ae}from"./Table.js";import{C as oe}from"./Card.js";import{E as F}from"./EmployeeDropdownWrapper.js";import"./html.js";import"./_commonjsHelpers.js";import"./BaseInput.js";import"./Label.js";import"./EmployeeDropdown.js";import"./Dropdown.js";function U(o){let s,n,m;return{c(){s=d("span"),n=A("Selected : "),m=A(o[4]),u(s,"class","pr-2")},m(a,i){z(a,s,i),r(s,n),r(s,m)},p(a,i){i&16&&V(m,a[4])},d(a){a&&B(s)}}}function le(o){let s,n,m,a,i,p,f,$,g,h,v,H,_,I,C;p=new q({props:{clear:!0,label:"Export",class:"font-weight-normal text-size-large mr-4 w-[96px]",icon:"ic-excel text-excel",isLoading:o[1]}}),p.$on("click",o[7]),$=new q({props:{outline:!0,primary:!1,label:"Cancel",class:"font-weight-normal text-size-large mr-2 w-[96px]",isLoading:o[1]}}),$.$on("click",o[10]),h=new q({props:{label:"Save",class:"font-weight-normal text-size-large w-[96px]",isLoading:o[1]}}),h.$on("click",o[8]);function M(e){o[12](e)}let t={tableConfig:o[6]};return o[0]!==void 0&&(t.selected=o[0]),_=new ae({props:t}),o[11](_),W.push(()=>ee(_,"selected",M)),{c(){s=d("div"),n=d("div"),m=d("div"),m.textContent="Retirement Employee List",a=k(),i=d("div"),x(p.$$.fragment),f=k(),x($.$$.fragment),g=k(),x(h.$$.fragment),v=k(),H=d("div"),x(_.$$.fragment),u(m,"class","font-weight-bold text-size-xlarge mb-3 desktop:mb-0"),u(i,"class","flex justify-between"),u(n,"class","mb-3 desktop:flex desktop:items-center desktop:justify-between"),u(s,"class",""),u(H,"class","overflow-x-auto relative")},m(e,l){z(e,s,l),r(s,n),r(n,m),r(n,a),r(n,i),E(p,i,null),r(i,f),E($,i,null),r(i,g),E(h,i,null),z(e,v,l),z(e,H,l),E(_,H,null),C=!0},p(e,l){const b={};l&2&&(b.isLoading=e[1]),p.$set(b);const R={};l&2&&(R.isLoading=e[1]),$.$set(R);const S={};l&2&&(S.isLoading=e[1]),h.$set(S);const L={};!I&&l&1&&(I=!0,L.selected=e[0],te(()=>I=!1)),_.$set(L)},i(e){C||(N(p.$$.fragment,e),N($.$$.fragment,e),N(h.$$.fragment,e),N(_.$$.fragment,e),C=!0)},o(e){j(p.$$.fragment,e),j($.$$.fragment,e),j(h.$$.fragment,e),j(_.$$.fragment,e),C=!1},d(e){e&&B(s),T(p),T($),T(h),e&&B(v),e&&B(H),o[11](null),T(_)}}}function re(o){let s,n,m,a,i,p,f,$,g,h,v,H,_,I,C,M,t,e,l,b,R,S,L,y=o[4]>0&&U(o);return b=new q({props:{isLoading:o[1],secondary:!0,class:"w-[204px]",label:"Submit",disabled:!o[4]}}),b.$on("click",o[9]),S=new oe({props:{$$slots:{default:[le]},$$scope:{ctx:o}}}),{c(){s=d("div"),n=d("div"),n.innerHTML=`<span class="icon svelte-1dr00bv"><i class="ic ic-retirement-square"></i></span> 
      <span class="font-weight-bold text-size-xlarge">Employee Retirement Date Confirmation</span>`,m=k(),a=d("div"),i=d("div"),p=d("span"),f=d("span"),f.textContent="ข้อมูล ณ วันที่ :",$=k(),g=d("span"),g.textContent=`${ne(o[5])}`,h=k(),v=d("span"),H=d("span"),H.textContent="จำนวนพนักงาน :",_=k(),I=d("span"),C=A(o[2]),M=A(" คน"),t=k(),e=d("div"),y&&y.c(),l=k(),x(b.$$.fragment),R=k(),x(S.$$.fragment),u(n,"class","icon-text svelte-1dr00bv"),u(f,"class","text-gray-900"),u(g,"class","font-weight-bold"),u(p,"class","desktop:pr-5"),u(H,"class","text-gray-900"),u(I,"class","font-weight-bold"),u(i,"class","flex justify-between"),u(e,"class","text-right pt-2 desktop:pt-0"),u(a,"class","desktop:flex items-center justify-between desktop:pl-[4.2rem] desktop:gap-y-2 desktop:pt-0 pt-2"),u(s,"class","bg-gray-100 border-gray-400 border border-b-0 p-2 rounded")},m(c,w){z(c,s,w),r(s,n),r(s,m),r(s,a),r(a,i),r(i,p),r(p,f),r(p,$),r(p,g),r(i,h),r(i,v),r(v,H),r(v,_),r(v,I),r(I,C),r(I,M),r(a,t),r(a,e),y&&y.m(e,null),r(e,l),E(b,e,null),z(c,R,w),E(S,c,w),L=!0},p(c,w){(!L||w&4)&&V(C,c[2]),c[4]>0?y?y.p(c,w):(y=U(c),y.c(),y.m(e,l)):y&&(y.d(1),y=null);const G={};w&2&&(G.isLoading=c[1]),w&16&&(G.disabled=!c[4]),b.$set(G);const O={};w&16395&&(O.$$scope={dirty:w,ctx:c}),S.$set(O)},i(c){L||(N(b.$$.fragment,c),N(S.$$.fragment,c),L=!0)},o(c){j(b.$$.fragment,c),j(S.$$.fragment,c),L=!1},d(c){c&&B(s),y&&y.d(),T(b),c&&B(R),T(S,c)}}}function ie(o){let s,n;return s=new X({props:{$$slots:{default:[re]},$$scope:{ctx:o}}}),{c(){x(s.$$.fragment)},m(m,a){E(s,m,a),n=!0},p(m,[a]){const i={};a&16415&&(i.$$scope={dirty:a,ctx:m}),s.$set(i)},i(m){n||(N(s.$$.fragment,m),n=!0)},o(m){j(s.$$.fragment,m),n=!1},d(m){T(s,m)}}}function pe(o,s,n){let m,a=!1,i=0,p={},f,$=new Date,g,h={columns:[{name:"Employee ID",prop:"employeeId"},{name:"Employee Name",prop:"employeeName"},{name:"Birth Date",prop:"birthDate",cellTemplate:se.Date},{name:"Age",prop:"age"},{name:"Function",prop:"function"},{name:"Department",prop:"department"},{name:"Section",prop:"section"},{name:"Level",prop:"level"},{name:"Immediate Line/Section Head",prop:"sectionHead",ComponentNew:({row:t})=>P(F,{displayValue:t.sectionHead?{userId:t.sectionHead??"",employeeName:t.sectionHeadName??""}:void 0,service:D.SearchUsers,change:({detail:e})=>{const l=f.findIndex(b=>b.employeeId===t.employeeId);l>-1&&(f[l]={...f[l],sectionHead:(e==null?void 0:e.userId)??"",sectionHeadName:(e==null?void 0:e.employeeName)??"",sectionHeadTH:(e==null?void 0:e.employeeNameTH)??"",sectionHeadPosition:(e==null?void 0:e.position)??""})},disabled:t.isDisable||t.isDisableSectionHead,excludeIds:[t.employeeId,t.departmentHead].filter(e=>!!e).join(",")})},{name:"Department Head",prop:"departmentHead",ComponentNew:({row:t})=>P(F,{displayValue:t.departmentHead?{userId:t.departmentHead??"",employeeName:t.departmentHeadName??""}:void 0,service:D.SearchUsers,change:({detail:e})=>{const l=f.findIndex(b=>b.employeeId===t.employeeId);l>-1&&(f[l]={...f[l],departmentHead:e.userId,departmentHeadName:e.employeeName,departmentHeadTH:e.employeeNameTH,departmentHeadPosition:e.position})},disabled:t.isDisable,excludeIds:[t.employeeId,t.sectionHead].filter(e=>!!e).join(","),clearable:!1})}],getData:(t,e)=>Y.all([D.GetRetirementListsCount().then(l=>(n(2,i=l),l)),D.GetRetirementLists({sortByParam:e,pageParam:t}).then(l=>(f=l,l))]),isStriped:!1,selectable:!0,canSelect:t=>t.isDisable===!1,rowIdentity:"employeeId"};function v(){n(1,a=!0),D.ExportExcel().then(t=>{n(1,a=!1),window.open(t,"_blank")}).catch(()=>{n(1,a=!1)})}function H(){const t=f.filter(e=>Object.keys(p).includes(e.employeeId));t.length?(n(1,a=!0),D.MassSaveRetirement({retirements:t}).then(()=>{n(0,p={}),n(1,a=!1),g.reload()}).catch(()=>{n(1,a=!1)})):Z.error("โปรดเลือกรายการเพื่อบันทึก")}function _(){n(1,a=!0),D.MassSubmitRetirement({retirements:Object.values(p)}).then(t=>{n(0,p={}),n(1,a=!1),g.reload()}).catch(()=>{n(1,a=!1)})}const I=()=>{n(0,p={}),g.reload()};function C(t){W[t?"unshift":"push"](()=>{g=t,n(3,g)})}function M(t){p=t,n(0,p)}return o.$$.update=()=>{o.$$.dirty&1&&n(4,m=Object.keys(p).length)},[p,a,i,g,m,$,h,v,H,_,I,C,M]}class me extends J{constructor(s){super(),K(this,s,pe,ie,Q,{})}}new me({target:document.getElementById("app")});
