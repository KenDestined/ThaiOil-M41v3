import{S as _e,i as ge,s as ve,B as j,F as B,w as k,x as C,G as O,t as w,b as y,y as L,K as Z,am as Be,W as Oe,an as We,M as Ye,C as Qe,R as je,A as Ue,z as Ve,h as b,o as D,j as T,a as R,d as z,D as Ge,p as m,g as Xe,c as Ze,r as xe,a3 as et,m as pe,q as fe}from"./MainLayout.js";import{C as Re}from"./Card.js";import{B as ce}from"./Button.js";import{D as Ee}from"./Dropdown.js";import{D as le}from"./DatePicker.js";import{C as me,T as tt}from"./Table.js";import{E as oe,T as nt}from"./ToOrganizationDropdown.js";import{M as at}from"./Modal.js";import{R as rt}from"./Radio.js";import{A as lt}from"./Alert.js";import"./Label.js";import"./flatpickr.js";import"./DatePicker.svelte_svelte_type_style_lang.js";import"./formatter.js";import"./html.js";import"./_commonjsHelpers.js";function ot(e){let t,r,n;function p(l){e[2](l)}let u={clearable:!1,options:e[1],valueKey:"key",labelKey:"value",label:st};return e[0]!==void 0&&(u.value=e[0]),t=new Ee({props:u}),j.push(()=>B(t,"value",p)),t.$on("change",e[3]),{c(){k(t.$$.fragment)},m(l,a){C(t,l,a),n=!0},p(l,[a]){const v={};!r&&a&1&&(r=!0,v.value=l[0],O(()=>r=!1)),t.$set(v)},i(l){n||(w(t.$$.fragment,l),n=!0)},o(l){y(t.$$.fragment,l),n=!1},d(l){L(t,l)}}}const st="Letter Type";function it(e,t,r){let{value:n=null}=t;const p=[{key:"all",value:"All"},...Object.keys(Z.RecommendationLetterType).map(a=>({key:a,value:Be[a]}))];function u(a){n=a,r(0,n)}function l(a){Oe.call(this,e,a)}return e.$$set=a=>{"value"in a&&r(0,n=a.value)},[n,p,u,l]}class ut extends _e{constructor(t){super(),ge(this,t,it,ot,ve,{value:0})}}function dt(e){let t,r,n;function p(l){e[2](l)}let u={clearable:!1,options:e[1],valueKey:"key",labelKey:"value",label:pt};return e[0]!==void 0&&(u.value=e[0]),t=new Ee({props:u}),j.push(()=>B(t,"value",p)),t.$on("change",e[3]),{c(){k(t.$$.fragment)},m(l,a){C(t,l,a),n=!0},p(l,[a]){const v={};!r&&a&1&&(r=!0,v.value=l[0],O(()=>r=!1)),t.$set(v)},i(l){n||(w(t.$$.fragment,l),n=!0)},o(l){y(t.$$.fragment,l),n=!1},d(l){L(t,l)}}}const pt="Current Status";function ft(e,t,r){let{value:n=null}=t;const p=[{key:"all",value:"All"},...Object.keys(Z.RecommendationLetterStatus).map(a=>({key:a,value:We[a]}))];function u(a){n=a,r(0,n)}function l(a){Oe.call(this,e,a)}return e.$$set=a=>{"value"in a&&r(0,n=a.value)},[n,p,u,l]}class mt extends _e{constructor(t){super(),ge(this,t,ft,dt,ve,{value:0})}}function ze(e,t,r){const n=e.slice();return n[35]=t[r].value,n[36]=t[r].key,n}function Ae(e){let t,r,n,p=e[3].total+"",u,l,a,v,o,g,c=e[3].requested+"",F,d,f,A,_,h,G=e[3].remaining+"",H,E,W;return{c(){t=b("div"),r=b("div"),n=b("div"),u=pe(p),l=D(),a=b("div"),a.textContent="สิทธิ์เดือนนี้ทั้งหมด",v=D(),o=b("div"),g=b("div"),F=pe(c),d=D(),f=b("div"),f.textContent="สิทธิ์ที่ใช้ไปแล้ว",A=D(),_=b("div"),h=b("div"),H=pe(G),E=D(),W=b("div"),W.textContent="สิทธิ์คงเหลือ",T(n,"class","_amount svelte-wjjbnh"),T(r,"class","_box-item bg-secondary2 svelte-wjjbnh"),T(g,"class","_amount svelte-wjjbnh"),T(o,"class","_box-item bg-secondary3 svelte-wjjbnh"),T(h,"class","_amount svelte-wjjbnh"),T(_,"class","_box-item bg-secondary svelte-wjjbnh"),T(t,"class","_box-wrapper svelte-wjjbnh")},m(P,q){R(P,t,q),m(t,r),m(r,n),m(n,u),m(r,l),m(r,a),m(t,v),m(t,o),m(o,g),m(g,F),m(o,d),m(o,f),m(t,A),m(t,_),m(_,h),m(h,H),m(_,E),m(_,W)},p(P,q){q[0]&8&&p!==(p=P[3].total+"")&&fe(u,p),q[0]&8&&c!==(c=P[3].requested+"")&&fe(F,c),q[0]&8&&G!==(G=P[3].remaining+"")&&fe(H,G)},d(P){P&&z(t)}}}function ct(e){var ke,Ce;let t,r,n,p,u,l,a,v,o,g,c,F,d,f,A,_,h,G,H,E,W,P,q,x,N,M,V,ee,Q,te,K,X,ne,Y,I,ae,J,s,$=e[3]&&Ae(e);function U(i){e[13](i)}let $e={};e[7].letterType!==void 0&&($e.value=e[7].letterType),u=new ut({props:$e}),j.push(()=>B(u,"value",U)),u.$on("change",e[14]);function Ne(i){e[15](i)}let be={showAll:!0,label:"To Organization",letterType:(ke=e[7].letterType)==null?void 0:ke.value,disabled:((Ce=e[7].letterType)==null?void 0:Ce.value)==="All"};e[7].organization!==void 0&&(be.value=e[7].organization),o=new nt({props:be}),j.push(()=>B(o,"value",Ne));function Me(i){e[16](i)}let De={};e[7].letterStatus!==void 0&&(De.value=e[7].letterStatus),d=new mt({props:De}),j.push(()=>B(d,"value",Me));function Ke(i){e[17](i)}let we={label:"Created Date",maxDate:e[8].endCreatedDate};e[8].startCreatedDate!==void 0&&(we.value=e[8].startCreatedDate),h=new le({props:we}),j.push(()=>B(h,"value",Ke));function Ie(i){e[18](i)}let Te={minDate:e[8].startCreatedDate};e[8].endCreatedDate!==void 0&&(Te.value=e[8].endCreatedDate),P=new le({props:Te}),j.push(()=>B(P,"value",Ie));function Je(i){e[19](i)}let he={label:"Generated to PDF",maxDate:e[8].endGeneratedToPDF};e[8].startGeneratedToPDF!==void 0&&(he.value=e[8].startGeneratedToPDF),M=new le({props:he}),j.push(()=>B(M,"value",Je));function He(i){e[20](i)}let ye={minDate:e[8].startGeneratedToPDF};return e[8].endGeneratedToPDF!==void 0&&(ye.value=e[8].endGeneratedToPDF),K=new le({props:ye}),j.push(()=>B(K,"value",He)),I=new ce({props:{label:"Search",class:"mr-2 w-[96px]",icon:"ic-search"}}),I.$on("click",e[10]),J=new ce({props:{clear:!0,label:"Clear",class:"w-[96px]"}}),J.$on("click",e[12]),{c(){$&&$.c(),t=D(),r=b("div"),n=b("div"),p=b("div"),k(u.$$.fragment),a=D(),v=b("div"),k(o.$$.fragment),c=D(),F=b("div"),k(d.$$.fragment),A=D(),_=b("div"),k(h.$$.fragment),H=D(),E=b("p"),E.textContent="-",W=D(),k(P.$$.fragment),x=D(),N=b("div"),k(M.$$.fragment),ee=D(),Q=b("p"),Q.textContent="-",te=D(),k(K.$$.fragment),ne=D(),Y=b("div"),k(I.$$.fragment),ae=D(),k(J.$$.fragment),T(p,"class","desktop:col-span-3"),T(v,"class","desktop:col-span-2"),T(E,"class","self-center mt-4"),T(_,"class","desktop:col-span-2 flex items-end"),T(Q,"class","self-center mt-4"),T(N,"class","desktop:col-span-2 flex items-end"),T(n,"class","grid desktop:grid-cols-5 gap-1.5"),T(Y,"class","text-center mt-3"),T(r,"class","_search-wrapper svelte-wjjbnh")},m(i,S){$&&$.m(i,S),R(i,t,S),R(i,r,S),m(r,n),m(n,p),C(u,p,null),m(n,a),m(n,v),C(o,v,null),m(n,c),m(n,F),C(d,F,null),m(n,A),m(n,_),C(h,_,null),m(_,H),m(_,E),m(_,W),C(P,_,null),m(n,x),m(n,N),C(M,N,null),m(N,ee),m(N,Q),m(N,te),C(K,N,null),m(r,ne),m(r,Y),C(I,Y,null),m(Y,ae),C(J,Y,null),s=!0},p(i,S){var Se,Fe;i[3]?$?$.p(i,S):($=Ae(i),$.c(),$.m(t.parentNode,t)):$&&($.d(1),$=null);const Le={};!l&&S[0]&128&&(l=!0,Le.value=i[7].letterType,O(()=>l=!1)),u.$set(Le);const re={};S[0]&128&&(re.letterType=(Se=i[7].letterType)==null?void 0:Se.value),S[0]&128&&(re.disabled=((Fe=i[7].letterType)==null?void 0:Fe.value)==="All"),!g&&S[0]&128&&(g=!0,re.value=i[7].organization,O(()=>g=!1)),o.$set(re);const Pe={};!f&&S[0]&128&&(f=!0,Pe.value=i[7].letterStatus,O(()=>f=!1)),d.$set(Pe);const se={};S[0]&256&&(se.maxDate=i[8].endCreatedDate),!G&&S[0]&256&&(G=!0,se.value=i[8].startCreatedDate,O(()=>G=!1)),h.$set(se);const ie={};S[0]&256&&(ie.minDate=i[8].startCreatedDate),!q&&S[0]&256&&(q=!0,ie.value=i[8].endCreatedDate,O(()=>q=!1)),P.$set(ie);const ue={};S[0]&256&&(ue.maxDate=i[8].endGeneratedToPDF),!V&&S[0]&256&&(V=!0,ue.value=i[8].startGeneratedToPDF,O(()=>V=!1)),M.$set(ue);const de={};S[0]&256&&(de.minDate=i[8].startGeneratedToPDF),!X&&S[0]&256&&(X=!0,de.value=i[8].endGeneratedToPDF,O(()=>X=!1)),K.$set(de)},i(i){s||(w(u.$$.fragment,i),w(o.$$.fragment,i),w(d.$$.fragment,i),w(h.$$.fragment,i),w(P.$$.fragment,i),w(M.$$.fragment,i),w(K.$$.fragment,i),w(I.$$.fragment,i),w(J.$$.fragment,i),s=!0)},o(i){y(u.$$.fragment,i),y(o.$$.fragment,i),y(d.$$.fragment,i),y(h.$$.fragment,i),y(P.$$.fragment,i),y(M.$$.fragment,i),y(K.$$.fragment,i),y(I.$$.fragment,i),y(J.$$.fragment,i),s=!1},d(i){$&&$.d(i),i&&z(t),i&&z(r),L(u),L(o),L(d),L(h),L(P),L(M),L(K),L(I),L(J)}}}function _t(e){let t,r,n,p,u,l;t=new ce({props:{label:"New Request",class:"text-size-large place-self-end my-2",icon:"ic-add"}}),t.$on("click",e[21]);function a(o){e[23](o)}let v={tableConfig:e[9]};return e[1]!==void 0&&(v.sortByParam=e[1]),p=new tt({props:v}),e[22](p),j.push(()=>B(p,"sortByParam",a)),{c(){k(t.$$.fragment),r=D(),n=b("div"),k(p.$$.fragment),T(n,"class","overflow-x-auto relative")},m(o,g){C(t,o,g),R(o,r,g),R(o,n,g),C(p,n,null),l=!0},p(o,g){const c={};!u&&g[0]&2&&(u=!0,c.sortByParam=o[1],O(()=>u=!1)),p.$set(c)},i(o){l||(w(t.$$.fragment,o),w(p.$$.fragment,o),l=!0)},o(o){y(t.$$.fragment,o),y(p.$$.fragment,o),l=!1},d(o){L(t,o),o&&z(r),o&&z(n),e[22](null),L(p)}}}function qe(e){let t,r,n;function p(l){e[24](l)}let u={isForm:!0,fullWidth:!0,value:e[36],label:e[35],name:"letterType"};return e[4]!==void 0&&(u.group=e[4]),t=new rt({props:u}),j.push(()=>B(t,"group",p)),{c(){k(t.$$.fragment)},m(l,a){C(t,l,a),n=!0},p(l,a){const v={};a[0]&4&&(v.value=l[36]),a[0]&4&&(v.label=l[35]),!r&&a[0]&16&&(r=!0,v.group=l[4],O(()=>r=!1)),t.$set(v)},i(l){n||(w(t.$$.fragment,l),n=!0)},o(l){y(t.$$.fragment,l),n=!1},d(l){L(t,l)}}}function gt(e){let t,r,n,p,u,l=e[2],a=[];for(let o=0;o<l.length;o+=1)a[o]=qe(ze(e,l,o));const v=o=>y(a[o],1,1,()=>{a[o]=null});return{c(){t=b("div"),r=b("div"),n=b("label"),n.textContent="Letter Type",p=D();for(let o=0;o<a.length;o+=1)a[o].c();T(n,"for","letterType"),T(n,"class","text-gray-800 mr-3"),T(t,"class","flex justify-center")},m(o,g){R(o,t,g),m(t,r),m(r,n),m(r,p);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(r,null);u=!0},p(o,g){if(g[0]&20){l=o[2];let c;for(c=0;c<l.length;c+=1){const F=ze(o,l,c);a[c]?(a[c].p(F,g),w(a[c],1)):(a[c]=qe(F),a[c].c(),w(a[c],1),a[c].m(r,null))}for(Xe(),c=l.length;c<a.length;c+=1)v(c);Ze()}},i(o){if(!u){for(let g=0;g<l.length;g+=1)w(a[g]);u=!0}},o(o){a=a.filter(Boolean);for(let g=0;g<a.length;g+=1)y(a[g]);u=!1},d(o){o&&z(t),xe(a,o)}}}function vt(e){let t;return{c(){t=b("div"),t.textContent="New Letter of Recommendation",T(t,"slot","title")},m(r,n){R(r,t,n)},p:et,d(r){r&&z(t)}}}function $t(e){let t,r,n,p,u,l,a,v,o,g;n=new Re({props:{$$slots:{default:[ct]},$$scope:{ctx:e}}}),u=new Re({props:{$$slots:{default:[_t]},$$scope:{ctx:e}}});let c={onConfirm:e[11],onClose:e[25],nextLabel:"Next",$$slots:{title:[vt],default:[gt]},$$scope:{ctx:e}};a=new at({props:c}),e[26](a);let F={};return o=new lt({props:F}),e[27](o),{c(){t=b("div"),t.innerHTML=`<div class="icon-text svelte-wjjbnh"><span class="icon svelte-wjjbnh"><i class="ic ic-recommendation-letter-square"></i></span> 
      <span class="font-weight-bold text-size-xlarge">Recommendation Letter</span></div>`,r=D(),k(n.$$.fragment),p=D(),k(u.$$.fragment),l=D(),k(a.$$.fragment),v=D(),k(o.$$.fragment),T(t,"class","bg-gray-100 border-gray-400 border p-2")},m(d,f){R(d,t,f),R(d,r,f),C(n,d,f),R(d,p,f),C(u,d,f),R(d,l,f),C(a,d,f),R(d,v,f),C(o,d,f),g=!0},p(d,f){const A={};f[0]&392|f[1]&256&&(A.$$scope={dirty:f,ctx:d}),n.$set(A);const _={};f[0]&118|f[1]&256&&(_.$$scope={dirty:f,ctx:d}),u.$set(_);const h={};f[0]&16&&(h.onClose=d[25]),f[0]&20|f[1]&256&&(h.$$scope={dirty:f,ctx:d}),a.$set(h);const G={};o.$set(G)},i(d){g||(w(n.$$.fragment,d),w(u.$$.fragment,d),w(a.$$.fragment,d),w(o.$$.fragment,d),g=!0)},o(d){y(n.$$.fragment,d),y(u.$$.fragment,d),y(a.$$.fragment,d),y(o.$$.fragment,d),g=!1},d(d){d&&z(t),d&&z(r),L(n,d),d&&z(p),L(u,d),d&&z(l),e[26](null),L(a,d),d&&z(v),e[27](null),L(o,d)}}}function bt(e){let t,r;return t=new Ye({props:{$$slots:{default:[$t]},$$scope:{ctx:e}}}),{c(){k(t.$$.fragment)},m(n,p){C(t,n,p),r=!0},p(n,p){const u={};p[0]&511|p[1]&256&&(u.$$scope={dirty:p,ctx:n}),t.$set(u)},i(n){r||(w(t.$$.fragment,n),r=!0)},o(n){y(t.$$.fragment,n),r=!1},d(n){L(t,n)}}}function Dt(e,t,r){let n,p={ascending:!1,sortBy:"createdDate"},u=[],l,a,v,o;const g=new Date,c=new Date(g.getFullYear(),0,1),F=new Date(g.setHours(0,0,0,0)),d={letterStatus:{key:"all",value:"All"},letterType:{key:"all",value:"All"},organization:"All"};let f={...d};const A={startCreatedDate:c,endCreatedDate:F,startGeneratedToPDF:c,endGeneratedToPDF:F};let _={...A};function h(){return{..._,letterType:f.letterType.key??"",letterStatus:f.letterStatus.key??"",organization:f.organization??"",endCreatedDate:Ge.fromJSDate(_.endCreatedDate).endOf("day").toJSDate(),endGeneratedToPDF:Ge.fromJSDate(_.endGeneratedToPDF).endOf("day").toJSDate()}}let G={columns:[{name:"Document No.",prop:"documentNo",cellTemplate:me.Link,onClick:(s,$)=>{E($,!1)}},{name:"Letter Type",prop:"letterType",render:s=>s.value},{name:"Language",prop:"language",render:s=>s.value},{name:"Purpose",prop:"purpose"},{name:"To Organization",prop:"toOrganization"},{name:"Created Date",prop:"createdDate",cellTemplate:me.Date},{name:"Generated Date",prop:"generatedDate",cellTemplate:me.Date},{name:"Letter Status",prop:"letterStatus",render:s=>s.value},{name:"Action",prop:"_action",actions:{isEdit:!1,isDownload:!1,isDelete:s=>{var $;return(($=s.letterStatus)==null?void 0:$.key)===Z.RecommendationLetterStatus.Created}}}],getData:(s,$)=>Qe.all([oe.GetRecommendationLetterListsCount({filter:h()}),oe.GetRecommendationLetterLists({filter:h(),sortByParam:$,pageParam:s})]),deleteData(s){return oe.DeleteRecommendationLetter({letterId:s.letterId})},displayDeleteKey:"documentNo"};function H(){v.reload()}function E(s,$=!0){if($&&!l.canCreate){n.error("","คุณได้ทำการขอจดหมายรับรองการทำงานจากบริษัทครบจำนวนในเดือนนี้แล้ว โดยสามารถเข้ามาขอจดหมายใหม่ได้ในเดือนถัดไป");return}let U={parent:je.RecommendationLetter};s?(U.letterId=s.letterId,U.letterType=s.letterType.key):U.letterType=a,Ue(je.RecommendationLetterDetail,U)}function W(){oe.GetRecommendationLetterCount({filter:h()}).then(s=>{r(3,l=s),r(2,u=Object.keys(Z.RecommendationLetterType).map($=>s.companyName==="TOP"&&$===Z.RecommendationLetterType.GrantedLetter?null:{key:$,value:Be[$]}).filter($=>$))})}function P(){r(8,_={...A}),r(7,f={...d})}Ve(()=>{W()});function q(s){e.$$.not_equal(f.letterType,s)&&(f.letterType=s,r(7,f))}const x=()=>{r(7,f.organization="All",f)};function N(s){e.$$.not_equal(f.organization,s)&&(f.organization=s,r(7,f))}function M(s){e.$$.not_equal(f.letterStatus,s)&&(f.letterStatus=s,r(7,f))}function V(s){e.$$.not_equal(_.startCreatedDate,s)&&(_.startCreatedDate=s,r(8,_))}function ee(s){e.$$.not_equal(_.endCreatedDate,s)&&(_.endCreatedDate=s,r(8,_))}function Q(s){e.$$.not_equal(_.startGeneratedToPDF,s)&&(_.startGeneratedToPDF=s,r(8,_))}function te(s){e.$$.not_equal(_.endGeneratedToPDF,s)&&(_.endGeneratedToPDF=s,r(8,_))}const K=()=>{o.open(),r(4,a=u[0].key)};function X(s){j[s?"unshift":"push"](()=>{v=s,r(5,v)})}function ne(s){p=s,r(1,p)}function Y(s){a=s,r(4,a)}const I=()=>{r(4,a=void 0)};function ae(s){j[s?"unshift":"push"](()=>{o=s,r(6,o)})}function J(s){j[s?"unshift":"push"](()=>{n=s,r(0,n)})}return[n,p,u,l,a,v,o,f,_,G,H,E,P,q,x,N,M,V,ee,Q,te,K,X,ne,Y,I,ae,J]}class wt extends _e{constructor(t){super(),ge(this,t,Dt,bt,ve,{},null,[-1,-1])}}new wt({target:document.getElementById("app")});
