import{S as tt,i as nt,s as st,M as at,w as L,x as B,t as b,b as w,y as A,b3 as lt,b4 as it,K as ot,aU as he,z as rt,B as U,F as Z,o as y,h as $,m as J,j as h,a as V,p as d,G as ee,q as ke,g as Ue,c as Je,d as z,A as ft,R as qe,L as Re,e as ut,r as dt,aR as Ee,aS as Ve,aT as ze,aV as Ie}from"./MainLayout.js";import{E as ce}from"./ESS_FixAndGeneral.service.js";import{t as xe}from"./formatter.js";import{B as ct}from"./BaseInput.js";import{D as pt}from"./DateRange.js";import{B as pe}from"./Button.js";import{F as mt,a as gt}from"./FixListSortByDropdown.js";import{P as _t}from"./PageTitle.js";import{L as bt}from"./Label.js";import{F as $t}from"./FixAndGeneralStatusDropdown.js";import{C as ht}from"./CheckBox.js";import{C as kt}from"./ConfirmModal.js";import"./flatpickr.js";import"./_commonjsHelpers.js";import"./Dropdown.js";import"./TextArea.js";import"./Modal.js";function Oe(e,a,l){const i=e.slice();return i[33]=a[l],i[34]=a,i[35]=l,i}function Pe(e){let a,l,i;return{c(){a=$("span"),l=J("Selected : "),i=J(e[8])},m(n,g){V(n,a,g),d(a,l),d(a,i)},p(n,g){g[0]&256&&ke(i,n[8])},d(n){n&&z(a)}}}function He(e){let a,l,i=e[0],n=[];for(let o=0;o<i.length;o+=1)n[o]=Ke(Oe(e,i,o));const g=o=>w(n[o],1,1,()=>{n[o]=null});return{c(){for(let o=0;o<n.length;o+=1)n[o].c();a=ut()},m(o,f){for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(o,f);V(o,a,f),l=!0},p(o,f){if(f[0]&6145){i=o[0];let u;for(u=0;u<i.length;u+=1){const k=Oe(o,i,u);n[u]?(n[u].p(k,f),b(n[u],1)):(n[u]=Ke(k),n[u].c(),b(n[u],1),n[u].m(a.parentNode,a))}for(Ue(),u=i.length;u<n.length;u+=1)g(u);Je()}},i(o){if(!l){for(let f=0;f<i.length;f+=1)b(n[f]);l=!0}},o(o){n=n.filter(Boolean);for(let f=0;f<n.length;f+=1)w(n[f]);l=!1},d(o){dt(n,o),o&&z(a)}}}function vt(e){let a,l,i,n,g,o,f,u=(e[33].topic??"-")+"",k,_;return{c(){var c;a=$("div"),l=$("div"),i=$("span"),n=$("i"),o=y(),f=$("div"),k=J(u),_=y(),h(n,"class",g="ic "+Ie[(c=e[33].typeOfService)==null?void 0:c.key]),h(i,"class","icon text-fix-general-icon"),h(l,"class","text-size-xxlarge mr-2"),h(f,"class","text-size-large font-weight-bold text-primary"),h(a,"class","flex items-center")},m(c,p){V(c,a,p),d(a,l),d(l,i),d(i,n),d(a,o),d(a,f),d(f,k),V(c,_,p)},p(c,p){var r;p[0]&1&&g!==(g="ic "+Ie[(r=c[33].typeOfService)==null?void 0:r.key])&&h(n,"class",g),p[0]&1&&u!==(u=(c[33].topic??"-")+"")&&ke(k,u)},d(c){c&&z(a),c&&z(_)}}}function Ke(e){var u,k,_,c;let a,l,i;function n(p){e[26](p,e[33])}function g(...p){return e[27](e[33],e[34],e[35],...p)}function o(){return e[28](e[33])}let f={borderColor:Ee[(u=e[33].status)==null?void 0:u.key],icon:Ve[(k=e[33].status)==null?void 0:k.key],iconColor:ze[(_=e[33].status)==null?void 0:_.key],statusText:he[(c=e[33].status)==null?void 0:c.key],cardDetail:e[33],$$slots:{default:[vt]},$$scope:{ctx:e}};return e[33].isSelected!==void 0&&(f.checked=e[33].isSelected),a=new gt({props:f}),U.push(()=>Z(a,"checked",n)),a.$on("select",g),a.$on("click",o),{c(){L(a.$$.fragment)},m(p,r){B(a,p,r),i=!0},p(p,r){var H,N,C,I;e=p;const D={};r[0]&1&&(D.borderColor=Ee[(H=e[33].status)==null?void 0:H.key]),r[0]&1&&(D.icon=Ve[(N=e[33].status)==null?void 0:N.key]),r[0]&1&&(D.iconColor=ze[(C=e[33].status)==null?void 0:C.key]),r[0]&1&&(D.statusText=he[(I=e[33].status)==null?void 0:I.key]),r[0]&1&&(D.cardDetail=e[33]),r[0]&1|r[1]&32&&(D.$$scope={dirty:r,ctx:e}),!l&&r[0]&1&&(l=!0,D.checked=e[33].isSelected,ee(()=>l=!1)),a.$set(D)},i(p){i||(b(a.$$.fragment,p),i=!0)},o(p){w(a.$$.fragment,p),i=!1},d(p){A(a,p)}}}function wt(e){let a,l,i,n,g,o,f,u,k,_,c,p,r,D,H,N,C,I,M,Q,T,G,x,W,le,K,ie,O,oe,X=(e[1]??0)+"",te,re,fe,j,ne,s,S,q,ue,Y,de,R,me,ve,E,ge,we,se,_e,P,ae;a=new _t({props:{icon:"ic-fix",iconBg:"bg-fix",title:"Fix and General Service",isRoundBottom:!1}}),n=new bt({props:{label:"ค้นหารายการแจ้งซ่อมและบริการอื่นๆ",labelClass:"text-left text-link font-weight-bold mb-4"}});function Qe(t){e[17](t)}let Se={placeholder:"Document No."};e[7].documentNo!==void 0&&(Se.value=e[7].documentNo),f=new ct({props:Se}),U.push(()=>Z(f,"value",Qe));function We(t){e[18](t)}let ye={isHorizontal:!0,disabled:!0,label:"Current Status",labelClass:"w-[89px]"};e[7].status!==void 0&&(ye.value=e[7].status),_=new $t({props:ye}),U.push(()=>Z(_,"value",We));function Xe(t){e[19](t)}let De={isHorizontal:!0,label:"Created Date",canClear:!0};e[7].createdDate!==void 0&&(De.value=e[7].createdDate),r=new pt({props:De}),U.push(()=>Z(r,"value",Xe)),C=new pe({props:{icon:"ic-search",label:"Search",class:"w-[96px]",isLoading:e[3]}}),C.$on("click",e[9]),M=new pe({props:{primary:!1,outline:!0,label:"Clear",class:"w-[96px]",isLoading:e[3]}}),M.$on("click",e[10]);let F=e[8]>0&&Pe(e);s=new pe({props:{primary:!1,secondary:!0,label:"Verify",class:"w-[96px]",disabled:e[8]===0,isLoading:e[5]}}),s.$on("click",e[20]),q=new pe({props:{primary:!1,cancel:!0,label:"Reject",class:"w-[96px]",disabled:e[8]===0,isLoading:e[5]}}),q.$on("click",e[21]);function Ye(t){e[22](t)}let Ce={isOnBehalf:!0};e[6].sortBy!==void 0&&(Ce.value=e[6].sortBy),R=new mt({props:Ce}),U.push(()=>Z(R,"value",Ye)),R.$on("change",e[23]);function Ze(t){e[24](t)}let Fe={isForm:!0,label:"Select All"};e[4]!==void 0&&(Fe.checked=e[4]),E=new ht({props:Fe}),U.push(()=>Z(E,"checked",Ze)),E.$on("change",e[25]);let v=e[0]&&He(e),et={isLoading:e[5]};return P=new kt({props:et}),e[29](P),{c(){L(a.$$.fragment),l=y(),i=$("div"),L(n.$$.fragment),g=y(),o=$("div"),L(f.$$.fragment),k=y(),L(_.$$.fragment),p=y(),L(r.$$.fragment),H=y(),N=$("div"),L(C.$$.fragment),I=y(),L(M.$$.fragment),Q=y(),T=$("div"),G=$("div"),x=$("div"),W=$("span"),W.innerHTML='<span class="icon text-fix-secondary"><i class="ic ic-fix"></i></span>',le=y(),K=$("span"),ie=J(`รายการแจ้งซ่อมและบริการอื่นๆ
          `),O=$("span"),oe=J("("),te=J(X),re=J(")"),fe=y(),j=$("div"),F&&F.c(),ne=y(),L(s.$$.fragment),S=y(),L(q.$$.fragment),ue=y(),Y=$("div"),de=$("div"),L(R.$$.fragment),ve=y(),L(E.$$.fragment),we=y(),se=$("div"),v&&v.c(),_e=y(),L(P.$$.fragment),h(o,"class","grid gap-y-2 mb-4 desktop:grid-cols-3 desktop:gap-y-3 desktop:gap-x-8 desktop:px-[100px]"),h(N,"class","flex gap-2 justify-center"),h(i,"class","p-2 bg-white border border-gray-400 mb-1 desktop:p-3"),h(W,"class","text-[24px] mr-1"),h(O,"class","text-fix-secondary"),h(K,"class","text-size-xlarge font-weight-bold text-fix-tertiary"),h(x,"class","flex items-center justify-center desktop:col-start-2"),h(j,"class","flex justify-end gap-3 items-center"),h(G,"class","grid gap-2 mb-2 desktop:grid-cols-3"),h(de,"class","w-[30rem]"),h(Y,"class","desktop:flex justify-between mb-2"),h(se,"class","grid gap-2 desktop:grid-cols-3"),h(T,"class","bg-gray-100 border border-gray-400 p-2 desktop:px-4 desktop:pb-3")},m(t,m){B(a,t,m),V(t,l,m),V(t,i,m),B(n,i,null),d(i,g),d(i,o),B(f,o,null),d(o,k),B(_,o,null),d(o,p),B(r,o,null),d(i,H),d(i,N),B(C,N,null),d(N,I),B(M,N,null),V(t,Q,m),V(t,T,m),d(T,G),d(G,x),d(x,W),d(x,le),d(x,K),d(K,ie),d(K,O),d(O,oe),d(O,te),d(O,re),d(G,fe),d(G,j),F&&F.m(j,null),d(j,ne),B(s,j,null),d(j,S),B(q,j,null),d(T,ue),d(T,Y),d(Y,de),B(R,de,null),d(Y,ve),B(E,Y,null),d(T,we),d(T,se),v&&v.m(se,null),V(t,_e,m),B(P,t,m),ae=!0},p(t,m){const Le={};!u&&m[0]&128&&(u=!0,Le.value=t[7].documentNo,ee(()=>u=!1)),f.$set(Le);const Be={};!c&&m[0]&128&&(c=!0,Be.value=t[7].status,ee(()=>c=!1)),_.$set(Be);const Ae={};!D&&m[0]&128&&(D=!0,Ae.value=t[7].createdDate,ee(()=>D=!1)),r.$set(Ae);const Ge={};m[0]&8&&(Ge.isLoading=t[3]),C.$set(Ge);const Te={};m[0]&8&&(Te.isLoading=t[3]),M.$set(Te),(!ae||m[0]&2)&&X!==(X=(t[1]??0)+"")&&ke(te,X),t[8]>0?F?F.p(t,m):(F=Pe(t),F.c(),F.m(j,ne)):F&&(F.d(1),F=null);const be={};m[0]&256&&(be.disabled=t[8]===0),m[0]&32&&(be.isLoading=t[5]),s.$set(be);const $e={};m[0]&256&&($e.disabled=t[8]===0),m[0]&32&&($e.isLoading=t[5]),q.$set($e);const Ne={};!me&&m[0]&64&&(me=!0,Ne.value=t[6].sortBy,ee(()=>me=!1)),R.$set(Ne);const Me={};!ge&&m[0]&16&&(ge=!0,Me.checked=t[4],ee(()=>ge=!1)),E.$set(Me),t[0]?v?(v.p(t,m),m[0]&1&&b(v,1)):(v=He(t),v.c(),b(v,1),v.m(se,null)):v&&(Ue(),w(v,1,1,()=>{v=null}),Je());const je={};m[0]&32&&(je.isLoading=t[5]),P.$set(je)},i(t){ae||(b(a.$$.fragment,t),b(n.$$.fragment,t),b(f.$$.fragment,t),b(_.$$.fragment,t),b(r.$$.fragment,t),b(C.$$.fragment,t),b(M.$$.fragment,t),b(s.$$.fragment,t),b(q.$$.fragment,t),b(R.$$.fragment,t),b(E.$$.fragment,t),b(v),b(P.$$.fragment,t),ae=!0)},o(t){w(a.$$.fragment,t),w(n.$$.fragment,t),w(f.$$.fragment,t),w(_.$$.fragment,t),w(r.$$.fragment,t),w(C.$$.fragment,t),w(M.$$.fragment,t),w(s.$$.fragment,t),w(q.$$.fragment,t),w(R.$$.fragment,t),w(E.$$.fragment,t),w(v),w(P.$$.fragment,t),ae=!1},d(t){A(a,t),t&&z(l),t&&z(i),A(n),A(f),A(_),A(r),A(C),A(M),t&&z(Q),t&&z(T),F&&F.d(),A(s),A(q),A(R),A(E),v&&v.d(),t&&z(_e),e[29](null),A(P,t)}}}function St(e){let a,l;return a=new at({props:{isShowLoading:e[3],$$slots:{default:[wt]},$$scope:{ctx:e}}}),{c(){L(a.$$.fragment)},m(i,n){B(a,i,n),l=!0},p(i,n){const g={};n[0]&8&&(g.isShowLoading=i[3]),n[0]&511|n[1]&32&&(g.$$scope={dirty:n,ctx:i}),a.$set(g)},i(i){l||(b(a.$$.fragment,i),l=!0)},o(i){w(a.$$.fragment,i),l=!1},d(i){A(a,i)}}}function yt(e,a,l){let i;lt.set({vertical:it.Middle});let n,g,o=ot.FixAndGeneralDocumentStatus,f,u=!1,k=!1,_=!1,c={sortBy:void 0,ascending:!1};const p={documentNo:"",status:{key:o.Verifying,value:he[o.Verifying]},createdDate:null};let r={...p};function D(){var s,S;return{documentNo:r.documentNo.trim(),status:r.status.key,startCreatedDate:xe((s=r.createdDate)==null?void 0:s[0]),endCreatedDate:xe((S=r.createdDate)==null?void 0:S[1],!0)}}function H(){G()}function N(){l(7,r={...p})}function C(s){ft(qe.FixGeneralDetail,{parent:qe.FixGeneralOnbehalfofList,recordId:s.recordId})}function I(){let s=n.every(S=>S.isSelected);l(4,k=s)}function M(s){l(4,k=s),l(0,n=n.map(S=>({...S,isSelected:s})))}function Q(){l(5,_=!0),ce.VerifyMultipleFixAndGeneral({inputs:n}).then(s=>{Re.success("ยืนยันใบงานสำเร็จ"),G()}).finally(()=>{l(5,_=!1)})}function T(s){l(5,_=!0),ce.RejectMultipleFixAndGeneral({inputs:n,comment:s}).then(S=>{Re.success("ส่งกลับใบงานสำเร็จ"),G()}).finally(()=>{l(5,_=!1)})}function G(){l(3,u=!0),ce.GetFixAndGeneralList({filter:{...D()},sortByParam:c,pageParam:null}).then(s=>{l(3,u=!1),l(0,n=s)}),ce.GetFixAndGeneralListCount({filter:{...D()}}).then(s=>{l(1,g=s)})}rt(()=>{G()});function x(s){e.$$.not_equal(r.documentNo,s)&&(r.documentNo=s,l(7,r))}function W(s){e.$$.not_equal(r.status,s)&&(r.status=s,l(7,r))}function le(s){e.$$.not_equal(r.createdDate,s)&&(r.createdDate=s,l(7,r))}const K=()=>{f.open({title:"ยืนยันใบงาน",detail:"คุณต้องการยืนยันใบงานนี้ใช่หรือไม่",isThai:!0,onConfirm:()=>{f.close(),Q()}})},ie=()=>{f.open({title:"ยืนยันการปฏิเสธใบงาน",detail:"คุณต้องการปฏิเสธใบงานนี้ใช่หรือไม่",reasonLabel:"โปรดระบุเหตุผลในการปฏิเสธใบงานนี้",isThai:!0,canComment:!0,requiredComment:!0,emptyCommentText:"โปรดระบุเหตุผลในการปฏิเสธใบงานนี้",onConfirm:s=>{f.close(),T(s)}})};function O(s){e.$$.not_equal(c.sortBy,s)&&(c.sortBy=s,l(6,c))}const oe=({detail:s})=>{l(6,c.sortBy=s==null?void 0:s.id,c),G()};function X(s){k=s,l(4,k)}const te=({detail:{checked:s}})=>M(s);function re(s,S){e.$$.not_equal(S.isSelected,s)&&(S.isSelected=s,l(0,n))}const fe=(s,S,q,{detail:{checked:ue}})=>{I(),l(0,S[q].isSelected=ue,n)},j=s=>{C(s)};function ne(s){U[s?"unshift":"push"](()=>{f=s,l(2,f)})}return e.$$.update=()=>{var s;e.$$.dirty[0]&1&&l(8,i=((s=n==null?void 0:n.filter(S=>S.isSelected))==null?void 0:s.length)??0)},[n,g,f,u,k,_,c,r,i,H,N,C,I,M,Q,T,G,x,W,le,K,ie,O,oe,X,te,re,fe,j,ne]}class Dt extends tt{constructor(a){super(),nt(this,a,yt,St,st,{},null,[-1,-1])}}new Dt({target:document.getElementById("app")});
