import{v as X,aM as et,aN as Xt,S as dn,i as fn,s as mn,w as v,o as $,x as S,a as y,t as k,b as w,y as L,d as C,D as Zt,A as En,R as en,C as Pn,z as Wn,aH as tn,B as R,F as E,h,j as m,p as u,G as P,g as _t,c as ht,aI as nn,ak as rn,al as qn,r as _n,a6 as an,af as Vn,at as In,m as Nn,aJ as nt,q as On,a3 as ce,aa as zn,M as Bn}from"./MainLayout.js";import{B as rt}from"./Button.js";import{D as tt}from"./DatePicker.js";import{B as xn}from"./BaseInput.js";import{C as ne}from"./CheckBox.js";import{C as ft,T as Mn}from"./Table.js";import{C as mt}from"./Card.js";import{F as Un,D as Hn}from"./FunctionDropdown.js";import{S as jn}from"./SectionDropdown.js";import{U as Jn}from"./UnitDropdown.js";import{R as Yn}from"./Radio.js";import{C as Kn}from"./ColumnChart.js";import"./flatpickr.js";import"./Label.js";import"./DatePicker.svelte_svelte_type_style_lang.js";import"./formatter.js";import"./html.js";import"./_commonjsHelpers.js";import"./Dropdown.js";import"./highcharts.js";class re{static UserViewPrivilege(){return X({remoteAction:"ESS_RecommendationLetterReport.UserViewPrivilege",params:[]})}static GetRecommendationLetterGraph(o){return X({remoteAction:"ESS_RecommendationLetterReport.GetRecommendationLetterGraph",params:[et.RecommendationLetterSearchCriteriaFormatter(o.filter)],responseFormatter:a=>Xt.RecommendationLetterGraphDTOFormatter(a,!0)})}static GetRecommendationLetterTableCount(o){return X({remoteAction:"ESS_RecommendationLetterReport.GetRecommendationLetterTableCount",params:[et.RecommendationLetterSearchCriteriaFormatter(o.filter)]})}static GetRecommendationLetterTables(o){return X({remoteAction:"ESS_RecommendationLetterReport.GetRecommendationLetterTables",params:[et.RecommendationLetterSearchCriteriaFormatter(o.filter),o.sortByParam,o.pageParam],responseFormatter:a=>a.map(l=>Xt.RecommendationLetterTableDTOFormatter(l,!0))})}static ExportRecommendationLetterExcel(o){return X({remoteAction:"ESS_RecommendationLetterReport.ExportRecommendationLetterExcel",params:[et.RecommendationLetterSearchCriteriaFormatter(o.filter)]})}static ESSGlobal_GetLevels(){return X({remoteAction:"ESS_RecommendationLetterReport.ESSGlobal_GetLevels",params:[]})}static ESSGlobal_GetFunctions(){return X({remoteAction:"ESS_RecommendationLetterReport.ESSGlobal_GetFunctions",params:[]})}static ESSGlobal_GetDepartments(o){return X({remoteAction:"ESS_RecommendationLetterReport.ESSGlobal_GetDepartments",params:[o.function]})}static ESSGlobal_GetSections(o){return X({remoteAction:"ESS_RecommendationLetterReport.ESSGlobal_GetSections",params:[o.department]})}static ESSGlobal_GetUnits(o){return X({remoteAction:"ESS_RecommendationLetterReport.ESSGlobal_GetUnits",params:[o.section]})}}function on(t,o,a){const l=t.slice();return l[59]=o[a],l}function ln(t,o,a){const l=t.slice();return l[59]=o[a],l}function sn(t){let o,a,l,c,i=t[7],e=[];for(let s=0;s<i.length;s+=1)e[s]=pn(ln(t,i,s));const p=s=>w(e[s],1,1,()=>{e[s]=null});return{c(){o=h("label"),o.textContent="Company",a=$(),l=h("div");for(let s=0;s<e.length;s+=1)e[s].c();m(o,"for","companyStatus"),m(o,"class","_label svelte-ck7r2p"),m(l,"class","flex gap-2 w-full")},m(s,b){y(s,o,b),y(s,a,b),y(s,l,b);for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(l,null);c=!0},p(s,b){if(b[0]&130){i=s[7];let f;for(f=0;f<i.length;f+=1){const D=ln(s,i,f);e[f]?(e[f].p(D,b),k(e[f],1)):(e[f]=pn(D),e[f].c(),k(e[f],1),e[f].m(l,null))}for(_t(),f=i.length;f<e.length;f+=1)p(f);ht()}},i(s){if(!c){for(let b=0;b<i.length;b+=1)k(e[b]);c=!0}},o(s){e=e.filter(Boolean);for(let b=0;b<e.length;b+=1)w(e[b]);c=!1},d(s){s&&C(o),s&&C(a),s&&C(l),_n(e,s)}}}function pn(t){let o,a,l;function c(e){t[20](e)}let i={isForm:!0,name:"companyName",value:t[59].value,label:t[59].label};return t[1].companyName!==void 0&&(i.group=t[1].companyName),o=new Yn({props:i}),R.push(()=>E(o,"group",c)),{c(){v(o.$$.fragment)},m(e,p){S(o,e,p),l=!0},p(e,p){const s={};p[0]&128&&(s.value=e[59].value),p[0]&128&&(s.label=e[59].label),!a&&p[0]&2&&(a=!0,s.group=e[1].companyName,P(()=>a=!1)),o.$set(s)},i(e){l||(k(o.$$.fragment,e),l=!0)},o(e){w(o.$$.fragment,e),l=!1},d(e){L(o,e)}}}function cn(t){let o,a,l;function c(e){t[44](e)}let i={label:"จดหมายผ่านสิทธิ์ (สำหรับทำธุรกรรมกับธนาคาร ธอส.)",isForm:!0,labelClass:"whitespace-pre-wrap desktop:whitespace-nowrap"};return t[1].letterTypeGrantedLetter!==void 0&&(i.checked=t[1].letterTypeGrantedLetter),o=new ne({props:i}),R.push(()=>E(o,"checked",c)),o.$on("change",t[45]),{c(){v(o.$$.fragment)},m(e,p){S(o,e,p),l=!0},p(e,p){const s={};!a&&p[0]&2&&(a=!0,s.checked=e[1].letterTypeGrantedLetter,P(()=>a=!1)),o.$set(s)},i(e){l||(k(o.$$.fragment,e),l=!0)},o(e){w(o.$$.fragment,e),l=!1},d(e){L(o,e)}}}function Qn(t){let o,a,l,c,i,e,p,s,b,f,D,_,d,T,F,O,G,ye,Ne,_e,N,ue,Y,Z,K,Ce,he,ee,ge,Oe,be,Q,ke,z,Fe,ze,B,Te,Be,x,Ge,Re,te,$e,xe,we,I,ve,M,Ae,Me,U,Ee,Ue,H,Pe,He,j,We,je,J,r,W,A,qe,Se,Le,Ve,gt,ae,oe,at,bt,Je,kt,le,ot,$t,De,Ie,wt,se,ie,lt,vt,Ye,St,pe,st,it,de,fe,Lt,me,Ke;function hn(n){t[19](n)}let Dt={name:"employeeId",isHorizontal:!0};t[1].employeeId!==void 0&&(Dt.value=t[1].employeeId),p=new xn({props:Dt}),R.push(()=>E(p,"value",hn));let q=t[6]&&sn(t);function gn(n){t[21](n)}let yt={service:re.ESSGlobal_GetFunctions,labelClass:"text-gray-800 mr-1 w-[130px]"};t[1].function!==void 0&&(yt.value=t[1].function),d=new Un({props:yt}),R.push(()=>E(d,"value",gn)),d.$on("change",t[22]);function bn(n){t[23](n)}let Ct={service:re.ESSGlobal_GetDepartments,function:t[1].function,labelClass:"text-gray-800 mr-1 w-[130px]",disabled:!t[1].function||t[1].function==="All"};t[1].department!==void 0&&(Ct.value=t[1].department),G=new Hn({props:Ct}),R.push(()=>E(G,"value",bn)),G.$on("change",t[24]);function kn(n){t[25](n)}let Ft={service:re.ESSGlobal_GetSections,department:t[1].department,labelClass:"text-gray-800 mr-1 w-[130px]",disabled:!t[1].department||t[1].department==="All"};t[1].section!==void 0&&(Ft.value=t[1].section),N=new jn({props:Ft}),R.push(()=>E(N,"value",kn)),N.$on("change",t[26]);function $n(n){t[27](n)}let Tt={service:re.ESSGlobal_GetUnits,section:t[1].section,labelClass:"text-gray-800 mr-1 w-[130px]",disabled:!t[1].section||t[1].section==="All"};t[1].unit!==void 0&&(Tt.value=t[1].unit),K=new Jn({props:Tt}),R.push(()=>E(K,"value",$n));function wn(n){t[28](n)}let Gt={label:"All",isForm:!0,labelMultipleLines:!0};t[1].statusAll!==void 0&&(Gt.checked=t[1].statusAll),z=new ne({props:Gt}),R.push(()=>E(z,"checked",wn)),z.$on("change",t[29]);function vn(n){t[30](n)}let Rt={label:"Created",isForm:!0};t[1].statusCreated!==void 0&&(Rt.checked=t[1].statusCreated),B=new ne({props:Rt}),R.push(()=>E(B,"checked",vn)),B.$on("change",t[31]);function Sn(n){t[32](n)}let At={label:"Generated to PDF",isForm:!0,labelClass:"whitespace-pre-wrap desktop:whitespace-nowrap"};t[1].statusGeneratedToPDF!==void 0&&(At.checked=t[1].statusGeneratedToPDF),x=new ne({props:At}),R.push(()=>E(x,"checked",Sn)),x.$on("change",t[33]);function Ln(n){t[34](n)}let Et={label:"All",isForm:!0,labelMultipleLines:!0};t[1].letterTypeAll!==void 0&&(Et.checked=t[1].letterTypeAll),M=new ne({props:Et}),R.push(()=>E(M,"checked",Ln)),M.$on("change",t[35]);function Dn(n){t[36](n)}let Pt={label:"จดหมายรับรองเงินเดือน (สำหรับทำธุรกรรมทางการเงิน)",isForm:!0,labelMultipleLines:!0};t[1].letterTypeSalaryLetterForFinancial!==void 0&&(Pt.checked=t[1].letterTypeSalaryLetterForFinancial),U=new ne({props:Pt}),R.push(()=>E(U,"checked",Dn)),U.$on("change",t[37]);function yn(n){t[38](n)}let Wt={label:"จดหมายรับรองเงินเดือน แบบระบุวันลา (สำหรับยื่นขอ Visa)",isForm:!0,labelClass:"whitespace-pre-wrap desktop:whitespace-nowrap"};t[1].letterTypeSalaryLetterWithLeaveForVisa!==void 0&&(Wt.checked=t[1].letterTypeSalaryLetterWithLeaveForVisa),H=new ne({props:Wt}),R.push(()=>E(H,"checked",yn)),H.$on("change",t[39]);function Cn(n){t[40](n)}let qt={label:"จดหมายรับรองเงินเดือน แบบไม่ระบุวันลา (สำหรับยื่นขอ Visa)",isForm:!0,labelClass:"whitespace-pre-wrap desktop:whitespace-nowrap"};t[1].letterTypeSalaryLetterWithoutLeaveForVisa!==void 0&&(qt.checked=t[1].letterTypeSalaryLetterWithoutLeaveForVisa),j=new ne({props:qt}),R.push(()=>E(j,"checked",Cn)),j.$on("change",t[41]);function Fn(n){t[42](n)}let Vt={label:"จดหมายรับรองการทำงาน ไม่ระบุเงินเดือน",isForm:!0,labelClass:"whitespace-pre-wrap desktop:whitespace-nowrap"};t[1].letterTypeWorkLetterWithoutSalary!==void 0&&(Vt.checked=t[1].letterTypeWorkLetterWithoutSalary),J=new ne({props:Vt}),R.push(()=>E(J,"checked",Fn)),J.$on("change",t[43]);let V=t[6]!=="TOP"&&cn(t);function Tn(n){t[46](n)}let It={name:"createdDate",maxDate:t[1].endCreatedDate};t[1].startCreatedDate!==void 0&&(It.value=t[1].startCreatedDate),oe=new tt({props:It}),R.push(()=>E(oe,"value",Tn));function Gn(n){t[47](n)}let Nt={minDate:t[1].startCreatedDate};t[1].endCreatedDate!==void 0&&(Nt.value=t[1].endCreatedDate),le=new tt({props:Nt}),R.push(()=>E(le,"value",Gn));function Rn(n){t[48](n)}let Ot={name:"submittedDate",maxDate:t[1].endGeneratedPDFDate};t[1].startGeneratedPDFDate!==void 0&&(Ot.value=t[1].startGeneratedPDFDate),ie=new tt({props:Ot}),R.push(()=>E(ie,"value",Rn));function An(n){t[49](n)}let zt={minDate:t[1].startGeneratedPDFDate};return t[1].endGeneratedPDFDate!==void 0&&(zt.value=t[1].endGeneratedPDFDate),pe=new tt({props:zt}),R.push(()=>E(pe,"value",An)),fe=new rt({props:{label:"Search",class:"w-[96px]",icon:"ic-search",outline:!0}}),fe.$on("click",t[13]),me=new rt({props:{clear:!0,label:"Clear",class:"w-[96px]"}}),me.$on("click",t[14]),{c(){o=h("div"),o.textContent="Request for Letter of Recommendation",a=$(),l=h("div"),c=h("div"),i=h("label"),i.textContent="Employee ID",e=$(),v(p.$$.fragment),b=$(),f=h("div"),q&&q.c(),D=$(),_=h("div"),v(d.$$.fragment),F=$(),O=h("div"),v(G.$$.fragment),Ne=$(),_e=h("div"),v(N.$$.fragment),Y=$(),Z=h("div"),v(K.$$.fragment),he=$(),ee=h("div"),ge=h("div"),ge.textContent="Current Status",Oe=$(),be=h("div"),Q=h("div"),ke=h("div"),v(z.$$.fragment),ze=$(),v(B.$$.fragment),Be=$(),v(x.$$.fragment),Re=$(),te=h("div"),$e=h("div"),$e.textContent="Letter Type",xe=$(),we=h("div"),I=h("div"),ve=h("div"),v(M.$$.fragment),Me=$(),v(U.$$.fragment),Ue=$(),v(H.$$.fragment),He=$(),v(j.$$.fragment),je=$(),v(J.$$.fragment),W=$(),V&&V.c(),A=$(),qe=h("div"),Se=h("div"),Le=h("div"),Ve=h("label"),Ve.textContent="Created Date",gt=$(),ae=h("div"),v(oe.$$.fragment),bt=$(),Je=h("p"),Je.textContent="-",kt=$(),v(le.$$.fragment),$t=$(),De=h("div"),Ie=h("label"),Ie.textContent="Generated to PDF Date",wt=$(),se=h("div"),v(ie.$$.fragment),vt=$(),Ye=h("p"),Ye.textContent="-",St=$(),v(pe.$$.fragment),it=$(),de=h("div"),v(fe.$$.fragment),Lt=$(),v(me.$$.fragment),m(o,"class","text-size-xlarge font-weight-bold pb-2"),m(i,"for","employeeId"),m(i,"class","_label svelte-ck7r2p"),m(c,"class","_input-wrapper svelte-ck7r2p"),m(f,"class","_input-wrapper svelte-ck7r2p"),m(_,"class","_dropdown-wrapper svelte-ck7r2p"),m(O,"class","_dropdown-wrapper svelte-ck7r2p"),m(_e,"class","_dropdown-wrapper svelte-ck7r2p"),m(Z,"class","_dropdown-wrapper svelte-ck7r2p"),m(l,"class","_search-wrapper grid grid-cols-1 desktop:grid-cols-3 gap-x-3 gap-y-2 svelte-ck7r2p"),m(ge,"class","_label-checkbox-wrapper svelte-ck7r2p"),m(ke,"class","col-span-2"),m(Q,"class","flex desktop:flex gap-2 px-2 py-2"),m(be,"class","_checkbox-wrapper svelte-ck7r2p"),m(ee,"class","_search-wrapper desktop:flex items-center svelte-ck7r2p"),m($e,"class","_label-checkbox-wrapper svelte-ck7r2p"),m(ve,"class","col-span-2"),m(I,"class","desktop:grid desktop:grid-cols-2 flex flex-col gap-2 px-2 py-2"),m(we,"class","_checkbox-wrapper svelte-ck7r2p"),m(te,"class","_search-wrapper desktop:flex items-center svelte-ck7r2p"),m(Ve,"for","createdDate"),m(Ve,"class","_label-date-picker svelte-ck7r2p"),m(Je,"class","self-center"),m(ae,"class","flex gap-0.5"),m(Le,"class","_date-picker-wrapper svelte-ck7r2p"),m(Ie,"for","submittedDate"),m(Ie,"class","_label-date-picker svelte-ck7r2p"),m(Ye,"class","self-center"),m(se,"class","flex gap-0.5"),m(De,"class","_date-picker-wrapper svelte-ck7r2p"),m(Se,"class","grid gap-y-2 gap-x-3 desktop:grid-cols-3"),m(qe,"class","_search-wrapper svelte-ck7r2p"),m(de,"class","text-center pb-3")},m(n,g){y(n,o,g),y(n,a,g),y(n,l,g),u(l,c),u(c,i),u(c,e),S(p,c,null),u(l,b),u(l,f),q&&q.m(f,null),u(l,D),u(l,_),S(d,_,null),u(l,F),u(l,O),S(G,O,null),u(l,Ne),u(l,_e),S(N,_e,null),u(l,Y),u(l,Z),S(K,Z,null),y(n,he,g),y(n,ee,g),u(ee,ge),u(ee,Oe),u(ee,be),u(be,Q),u(Q,ke),S(z,ke,null),u(Q,ze),S(B,Q,null),u(Q,Be),S(x,Q,null),y(n,Re,g),y(n,te,g),u(te,$e),u(te,xe),u(te,we),u(we,I),u(I,ve),S(M,ve,null),u(I,Me),S(U,I,null),u(I,Ue),S(H,I,null),u(I,He),S(j,I,null),u(I,je),S(J,I,null),u(I,W),V&&V.m(I,null),y(n,A,g),y(n,qe,g),u(qe,Se),u(Se,Le),u(Le,Ve),u(Le,gt),u(Le,ae),S(oe,ae,null),u(ae,bt),u(ae,Je),u(ae,kt),S(le,ae,null),u(Se,$t),u(Se,De),u(De,Ie),u(De,wt),u(De,se),S(ie,se,null),u(se,vt),u(se,Ye),u(se,St),S(pe,se,null),y(n,it,g),y(n,de,g),S(fe,de,null),u(de,Lt),S(me,de,null),Ke=!0},p(n,g){const Bt={};!s&&g[0]&2&&(s=!0,Bt.value=n[1].employeeId,P(()=>s=!1)),p.$set(Bt),n[6]?q?(q.p(n,g),g[0]&64&&k(q,1)):(q=sn(n),q.c(),k(q,1),q.m(f,null)):q&&(_t(),w(q,1,1,()=>{q=null}),ht());const xt={};!T&&g[0]&2&&(T=!0,xt.value=n[1].function,P(()=>T=!1)),d.$set(xt);const Qe={};g[0]&2&&(Qe.function=n[1].function),g[0]&2&&(Qe.disabled=!n[1].function||n[1].function==="All"),!ye&&g[0]&2&&(ye=!0,Qe.value=n[1].department,P(()=>ye=!1)),G.$set(Qe);const Xe={};g[0]&2&&(Xe.department=n[1].department),g[0]&2&&(Xe.disabled=!n[1].department||n[1].department==="All"),!ue&&g[0]&2&&(ue=!0,Xe.value=n[1].section,P(()=>ue=!1)),N.$set(Xe);const Ze={};g[0]&2&&(Ze.section=n[1].section),g[0]&2&&(Ze.disabled=!n[1].section||n[1].section==="All"),!Ce&&g[0]&2&&(Ce=!0,Ze.value=n[1].unit,P(()=>Ce=!1)),K.$set(Ze);const Mt={};!Fe&&g[0]&2&&(Fe=!0,Mt.checked=n[1].statusAll,P(()=>Fe=!1)),z.$set(Mt);const Ut={};!Te&&g[0]&2&&(Te=!0,Ut.checked=n[1].statusCreated,P(()=>Te=!1)),B.$set(Ut);const Ht={};!Ge&&g[0]&2&&(Ge=!0,Ht.checked=n[1].statusGeneratedToPDF,P(()=>Ge=!1)),x.$set(Ht);const jt={};!Ae&&g[0]&2&&(Ae=!0,jt.checked=n[1].letterTypeAll,P(()=>Ae=!1)),M.$set(jt);const Jt={};!Ee&&g[0]&2&&(Ee=!0,Jt.checked=n[1].letterTypeSalaryLetterForFinancial,P(()=>Ee=!1)),U.$set(Jt);const Yt={};!Pe&&g[0]&2&&(Pe=!0,Yt.checked=n[1].letterTypeSalaryLetterWithLeaveForVisa,P(()=>Pe=!1)),H.$set(Yt);const Kt={};!We&&g[0]&2&&(We=!0,Kt.checked=n[1].letterTypeSalaryLetterWithoutLeaveForVisa,P(()=>We=!1)),j.$set(Kt);const Qt={};!r&&g[0]&2&&(r=!0,Qt.checked=n[1].letterTypeWorkLetterWithoutSalary,P(()=>r=!1)),J.$set(Qt),n[6]!=="TOP"?V?(V.p(n,g),g[0]&64&&k(V,1)):(V=cn(n),V.c(),k(V,1),V.m(I,null)):V&&(_t(),w(V,1,1,()=>{V=null}),ht());const pt={};g[0]&2&&(pt.maxDate=n[1].endCreatedDate),!at&&g[0]&2&&(at=!0,pt.value=n[1].startCreatedDate,P(()=>at=!1)),oe.$set(pt);const ct={};g[0]&2&&(ct.minDate=n[1].startCreatedDate),!ot&&g[0]&2&&(ot=!0,ct.value=n[1].endCreatedDate,P(()=>ot=!1)),le.$set(ct);const ut={};g[0]&2&&(ut.maxDate=n[1].endGeneratedPDFDate),!lt&&g[0]&2&&(lt=!0,ut.value=n[1].startGeneratedPDFDate,P(()=>lt=!1)),ie.$set(ut);const dt={};g[0]&2&&(dt.minDate=n[1].startGeneratedPDFDate),!st&&g[0]&2&&(st=!0,dt.value=n[1].endGeneratedPDFDate,P(()=>st=!1)),pe.$set(dt)},i(n){Ke||(k(p.$$.fragment,n),k(q),k(d.$$.fragment,n),k(G.$$.fragment,n),k(N.$$.fragment,n),k(K.$$.fragment,n),k(z.$$.fragment,n),k(B.$$.fragment,n),k(x.$$.fragment,n),k(M.$$.fragment,n),k(U.$$.fragment,n),k(H.$$.fragment,n),k(j.$$.fragment,n),k(J.$$.fragment,n),k(V),k(oe.$$.fragment,n),k(le.$$.fragment,n),k(ie.$$.fragment,n),k(pe.$$.fragment,n),k(fe.$$.fragment,n),k(me.$$.fragment,n),Ke=!0)},o(n){w(p.$$.fragment,n),w(q),w(d.$$.fragment,n),w(G.$$.fragment,n),w(N.$$.fragment,n),w(K.$$.fragment,n),w(z.$$.fragment,n),w(B.$$.fragment,n),w(x.$$.fragment,n),w(M.$$.fragment,n),w(U.$$.fragment,n),w(H.$$.fragment,n),w(j.$$.fragment,n),w(J.$$.fragment,n),w(V),w(oe.$$.fragment,n),w(le.$$.fragment,n),w(ie.$$.fragment,n),w(pe.$$.fragment,n),w(fe.$$.fragment,n),w(me.$$.fragment,n),Ke=!1},d(n){n&&C(o),n&&C(a),n&&C(l),L(p),q&&q.d(),L(d),L(G),L(N),L(K),n&&C(he),n&&C(ee),L(z),L(B),L(x),n&&C(Re),n&&C(te),L(M),L(U),L(H),L(j),L(J),V&&V.d(),n&&C(A),n&&C(qe),L(oe),L(le),L(ie),L(pe),n&&C(it),n&&C(de),L(fe),L(me)}}}function un(t){let o,a,l,c,i=t[59].name+"",e,p;return{c(){o=h("span"),a=h("div"),l=$(),c=h("span"),e=Nn(i),p=$(),m(a,"class","icon inline-block w-1 h-1 rounded-full"),nt(a,"background-color",t[59].color),m(c,"class","text-gray-800"),m(o,"class","icon-text mr-1 flex items-center")},m(s,b){y(s,o,b),u(o,a),u(o,l),u(o,c),u(c,e),u(o,p)},p(s,b){b[0]&32&&nt(a,"background-color",s[59].color),b[0]&32&&i!==(i=s[59].name+"")&&On(e,i)},d(s){s&&C(o)}}}function Xn(t){return{c:ce,m:ce,p:ce,i:ce,o:ce,d:ce}}function Zn(t){let o,a,l,c={series:t[5].series,categories:t[5].categories,options:t[12]};return a=new Kn({props:c}),t[50](a),{c(){o=h("div"),v(a.$$.fragment),nt(o,"width",t[8]?`${t[8]}px`:"auto")},m(i,e){y(i,o,e),S(a,o,null),l=!0},p(i,e){const p={};e[0]&32&&(p.series=i[5].series),e[0]&32&&(p.categories=i[5].categories),a.$set(p),(!l||e[0]&256)&&nt(o,"width",i[8]?`${i[8]}px`:"auto")},i(i){l||(k(a.$$.fragment,i),l=!0)},o(i){w(a.$$.fragment,i),l=!1},d(i){i&&C(o),t[50](null),L(a)}}}function er(t){let o,a;return o=new zn({props:{isShow:!0,isbgTransparent:!0}}),{c(){v(o.$$.fragment)},m(l,c){S(o,l,c),a=!0},p:ce,i(l){a||(k(o.$$.fragment,l),a=!0)},o(l){w(o.$$.fragment,l),a=!1},d(l){L(o,l)}}}function tr(t){let o,a,l,c,i,e,p,s,b,f=nn(t[5].series),D=[];for(let d=0;d<f.length;d+=1)D[d]=un(on(t,f,d));let _={ctx:t,current:null,token:null,hasCatch:!1,pending:er,then:Zn,catch:Xn,blocks:[,,,]};return rn(s=t[4],_),{c(){o=h("div"),o.textContent="Number of Recommendation Letter",a=$(),l=h("div"),c=h("span"),c.textContent="Company",i=$();for(let d=0;d<D.length;d+=1)D[d].c();e=$(),p=h("div"),_.block.c(),m(o,"class","text-size-xlarge font-weight-bold pb-3"),m(c,"class","mr-3"),m(l,"class","flex flex-col desktop:flex-row desktop:items-center gap-1 justify-center pb-4"),m(p,"class","overflow-auto")},m(d,T){y(d,o,T),y(d,a,T),y(d,l,T),u(l,c),u(l,i);for(let F=0;F<D.length;F+=1)D[F]&&D[F].m(l,null);y(d,e,T),y(d,p,T),_.block.m(p,_.anchor=null),_.mount=()=>p,_.anchor=null,b=!0},p(d,T){if(t=d,T[0]&32){f=nn(t[5].series);let F;for(F=0;F<f.length;F+=1){const O=on(t,f,F);D[F]?D[F].p(O,T):(D[F]=un(O),D[F].c(),D[F].m(l,null))}for(;F<D.length;F+=1)D[F].d(1);D.length=f.length}_.ctx=t,T[0]&16&&s!==(s=t[4])&&rn(s,_)||qn(_,t,T)},i(d){b||(k(_.block),b=!0)},o(d){for(let T=0;T<3;T+=1){const F=_.blocks[T];w(F)}b=!1},d(d){d&&C(o),d&&C(a),d&&C(l),_n(D,d),d&&C(e),d&&C(p),_.block.d(),_.token=null,_=null}}}function nr(t){let o,a,l,c,i,e,p,s,b,f;c=new rt({props:{class:"icon-excel desktop:mr-2",label:"Export Excel",icon:"ic-excel text-excel",outline:!0,isLoading:t[3]}}),c.$on("click",t[17]),e=new rt({props:{class:"hidden desktop:block",label:"Export PDF",icon:"ic-pdf text-pdf",outline:!0}}),e.$on("click",t[18]);let D={tableConfig:t[11]};return b=new Mn({props:D}),t[51](b),{c(){o=h("div"),o.textContent="Request for Letter of Recommendation",a=$(),l=h("div"),v(c.$$.fragment),i=$(),v(e.$$.fragment),p=$(),s=h("div"),v(b.$$.fragment),m(o,"class","place-self-start text-size-xlarge font-weight-bold"),m(l,"class","mt-2 mb-3 flex justify-end"),m(s,"class","overflow-x-auto"),an(s,"_export-pdf",t[9])},m(_,d){y(_,o,d),y(_,a,d),y(_,l,d),S(c,l,null),u(l,i),S(e,l,null),y(_,p,d),y(_,s,d),S(b,s,null),t[52](s),f=!0},p(_,d){const T={};d[0]&8&&(T.isLoading=_[3]),c.$set(T);const F={};d[0]&2048&&(F.tableConfig=_[11]),b.$set(F),(!f||d[0]&512)&&an(s,"_export-pdf",_[9])},i(_){f||(k(c.$$.fragment,_),k(e.$$.fragment,_),k(b.$$.fragment,_),f=!0)},o(_){w(c.$$.fragment,_),w(e.$$.fragment,_),w(b.$$.fragment,_),f=!1},d(_){_&&C(o),_&&C(a),_&&C(l),L(c),L(e),_&&C(p),_&&C(s),t[51](null),L(b),t[52](null)}}}function rr(t){let o,a,l,c,i,e;return o=new mt({props:{$$slots:{default:[Qn]},$$scope:{ctx:t}}}),l=new mt({props:{class:"relative",$$slots:{default:[tr]},$$scope:{ctx:t}}}),i=new mt({props:{$$slots:{default:[nr]},$$scope:{ctx:t}}}),{c(){v(o.$$.fragment),a=$(),v(l.$$.fragment),c=$(),v(i.$$.fragment)},m(p,s){S(o,p,s),y(p,a,s),S(l,p,s),y(p,c,s),S(i,p,s),e=!0},p(p,s){const b={};s[0]&194|s[2]&4&&(b.$$scope={dirty:s,ctx:p}),o.$set(b);const f={};s[0]&305|s[2]&4&&(f.$$scope={dirty:s,ctx:p}),l.$set(f);const D={};s[0]&3596|s[2]&4&&(D.$$scope={dirty:s,ctx:p}),i.$set(D)},i(p){e||(k(o.$$.fragment,p),k(l.$$.fragment,p),k(i.$$.fragment,p),e=!0)},o(p){w(o.$$.fragment,p),w(l.$$.fragment,p),w(i.$$.fragment,p),e=!1},d(p){L(o,p),p&&C(a),L(l,p),p&&C(c),L(i,p)}}}function ar(t,o,a){const l=Zt.now().startOf("year").toJSDate(),c=Zt.now().endOf("month").toJSDate(),i={employeeId:void 0,companyName:"all",function:"All",department:"All",section:"All",unit:"All",statusAll:!1,statusCreated:!1,statusGeneratedToPDF:!0,letterTypeAll:!0,letterTypeSalaryLetterForFinancial:!0,letterTypeSalaryLetterWithLeaveForVisa:!0,letterTypeSalaryLetterWithoutLeaveForVisa:!0,letterTypeWorkLetterWithoutSalary:!0,letterTypeGrantedLetter:!0,startCreatedDate:l,endCreatedDate:c,startGeneratedPDFDate:l,endGeneratedPDFDate:c};let e={...i},p,s=!1,b,f={},D,_=tn,d,T,F=!1,O,G={columns:[{name:"Document No.",prop:"documentNo",width:"85px",cellTemplate:ft.Link,onClick:(r,W)=>{var A;En(en.RecommendationLetterDetail,{parent:en.RecommendationLetterReport,letterId:W.recordId,letterType:(A=W.letterType)==null?void 0:A.key})}},{name:"Employee Id",prop:"employeeId",width:"65px"},{name:"Employee Name",prop:"employeeName",width:"120px"},{name:"Position",prop:"position",width:"300px",render(r,W){return r}},{name:"Letter Type",prop:"letterType",width:"80px",render:r=>r.value??"-"},{name:"Language",prop:"language",width:"50px",render:r=>r.value??"-"},{name:"Purpose",prop:"purpose",width:"65px"},{name:"To Organization",prop:"toOrganization",width:"110px"},{name:"Created Date",prop:"createdDate",cellTemplate:ft.Date,width:"90px"},{name:"Generated Date",prop:"generatedDate",cellTemplate:ft.Date,width:"95px"},{name:"Current Status",prop:"status",width:"81px",render:r=>r.value??"-"},{name:"Function",prop:"function",width:"60px"},{name:"Department",prop:"department",width:"65px"},{name:"Section",prop:"section",width:"60px"},{name:"Unit",prop:"unit",width:"80px",render(r,W){return r}}],getData:(r,W)=>Pn.all([re.GetRecommendationLetterTableCount({filter:{...e}}),re.GetRecommendationLetterTables({filter:{...e},sortByParam:W,pageParam:r})]),isStriped:!1,freezeHeader:!0},ye={tooltip:{formatter(){var r;return`<span>Letter Type : ${this.x}</span><br><span>Company : ${this.point.series.name}</span><br><span>Count of Letter : ${this.y}</span><br><span>Percentage : ${((r=f.series[this.series.index])==null?void 0:r.custom[this.point.index])??0}%</span>`}},plotOptions:{column:{pointWidth:40,centerInCategory:!0,borderWidth:0,pointPadding:0,dataLabels:{enabled:!0,formatter(){var r;return`<span class="font-weight-normal">${this.y} (${((r=f.series[this.series.index])==null?void 0:r.custom[this.point.index])??0}%)</span>`}}}}};function Ne(){he(),p.reload()}function _e(){a(1,e={...i})}const N=["letterTypeSalaryLetterForFinancial","letterTypeSalaryLetterWithLeaveForVisa","letterTypeSalaryLetterWithoutLeaveForVisa","letterTypeWorkLetterWithoutSalary","letterTypeGrantedLetter"],ue=["statusCreated","statusGeneratedToPDF"];function Y(r,W=!1){W?r?N.forEach(A=>{a(1,e[A]=!0,e)}):N.forEach(A=>{a(1,e[A]=!1,e)}):N.every(A=>e[A])?a(1,e.letterTypeAll=!0,e):a(1,e.letterTypeAll=!1,e)}function Z(r,W=!1){W?r?ue.forEach(A=>{a(1,e[A]=!0,e)}):ue.forEach(A=>{a(1,e[A]=!1,e)}):ue.every(A=>e[A])?a(1,e.statusAll=!0,e):a(1,e.statusAll=!1,e)}function K(){a(3,s=!0),re.ExportRecommendationLetterExcel({filter:e}).then(r=>{a(3,s=!1),window.open(r,"_blank")}).catch(()=>{a(3,s=!1)})}async function Ce(){a(9,F=!0),a(11,G.freezeHeader=!1,G);const r=[...G.columns];a(11,G.columns=G.columns.map((W,A)=>({...W,width:A===G.columns.length-1?"120px":W.width})),G),await Vn(),In.export(O,{fileName:"recommendation-letter-report",landscape:!0,paperSize:"auto",margin:{top:10,left:10,right:10,bottom:10},scale:1}).then(()=>{a(11,G.columns=r,G),a(9,F=!1),a(11,G.freezeHeader=!0,G)})}function he(){a(4,b=re.GetRecommendationLetterGraph({filter:e}).then(r=>(a(5,f=r),r)))}Wn(()=>{re.UserViewPrivilege().then(r=>{a(6,D=r),a(1,e.companyName=D.toLowerCase(),e),a(7,_=tn.filter(W=>r==="All"?!0:W.value===r.toLowerCase()))}),he()});function ee(r){t.$$.not_equal(e.employeeId,r)&&(e.employeeId=r,a(1,e))}function ge(r){t.$$.not_equal(e.companyName,r)&&(e.companyName=r,a(1,e))}function Oe(r){t.$$.not_equal(e.function,r)&&(e.function=r,a(1,e))}const be=()=>{a(1,e.department="All",e),a(1,e.section="All",e),a(1,e.unit="All",e)};function Q(r){t.$$.not_equal(e.department,r)&&(e.department=r,a(1,e))}const ke=()=>{a(1,e.section="All",e),a(1,e.unit="All",e)};function z(r){t.$$.not_equal(e.section,r)&&(e.section=r,a(1,e))}const Fe=()=>{a(1,e.unit="All",e)};function ze(r){t.$$.not_equal(e.unit,r)&&(e.unit=r,a(1,e))}function B(r){t.$$.not_equal(e.statusAll,r)&&(e.statusAll=r,a(1,e))}const Te=({detail:{checked:r}})=>Z(r,!0);function Be(r){t.$$.not_equal(e.statusCreated,r)&&(e.statusCreated=r,a(1,e))}const x=({detail:{checked:r}})=>Z(r);function Ge(r){t.$$.not_equal(e.statusGeneratedToPDF,r)&&(e.statusGeneratedToPDF=r,a(1,e))}const Re=({detail:{checked:r}})=>Z(r);function te(r){t.$$.not_equal(e.letterTypeAll,r)&&(e.letterTypeAll=r,a(1,e))}const $e=({detail:{checked:r}})=>Y(r,!0);function xe(r){t.$$.not_equal(e.letterTypeSalaryLetterForFinancial,r)&&(e.letterTypeSalaryLetterForFinancial=r,a(1,e))}const we=({detail:{checked:r}})=>Y(r);function I(r){t.$$.not_equal(e.letterTypeSalaryLetterWithLeaveForVisa,r)&&(e.letterTypeSalaryLetterWithLeaveForVisa=r,a(1,e))}const ve=({detail:{checked:r}})=>Y(r);function M(r){t.$$.not_equal(e.letterTypeSalaryLetterWithoutLeaveForVisa,r)&&(e.letterTypeSalaryLetterWithoutLeaveForVisa=r,a(1,e))}const Ae=({detail:{checked:r}})=>Y(r);function Me(r){t.$$.not_equal(e.letterTypeWorkLetterWithoutSalary,r)&&(e.letterTypeWorkLetterWithoutSalary=r,a(1,e))}const U=({detail:{checked:r}})=>Y(r);function Ee(r){t.$$.not_equal(e.letterTypeGrantedLetter,r)&&(e.letterTypeGrantedLetter=r,a(1,e))}const Ue=({detail:{checked:r}})=>Y(r);function H(r){t.$$.not_equal(e.startCreatedDate,r)&&(e.startCreatedDate=r,a(1,e))}function Pe(r){t.$$.not_equal(e.endCreatedDate,r)&&(e.endCreatedDate=r,a(1,e))}function He(r){t.$$.not_equal(e.startGeneratedPDFDate,r)&&(e.startGeneratedPDFDate=r,a(1,e))}function j(r){t.$$.not_equal(e.endGeneratedPDFDate,r)&&(e.endGeneratedPDFDate=r,a(1,e))}function We(r){R[r?"unshift":"push"](()=>{d=r,a(0,d)})}function je(r){R[r?"unshift":"push"](()=>{p=r,a(2,p)})}function J(r){R[r?"unshift":"push"](()=>{O=r,a(10,O)})}return t.$$.update=()=>{t.$$.dirty[0]&1&&d&&a(8,T=d.makeChartWidthBySeries())},[d,e,p,s,b,f,D,_,T,F,O,G,ye,Ne,_e,Y,Z,K,Ce,ee,ge,Oe,be,Q,ke,z,Fe,ze,B,Te,Be,x,Ge,Re,te,$e,xe,we,I,ve,M,Ae,Me,U,Ee,Ue,H,Pe,He,j,We,je,J]}class or extends dn{constructor(o){super(),fn(this,o,ar,rr,mn,{},null,[-1,-1,-1])}}function lr(t){let o,a,l,c;return l=new or({}),{c(){o=h("div"),o.innerHTML=`<div class="icon-text svelte-1g0inf"><span class="icon svelte-1g0inf"><i class="ic ic-report-square"></i></span> 
      <span class="font-weight-bold text-size-xlarge">Tracking Report</span></div>`,a=$(),v(l.$$.fragment),m(o,"class","bg-gray-100 border-gray-400 border border-b-0 p-2")},m(i,e){y(i,o,e),y(i,a,e),S(l,i,e),c=!0},p:ce,i(i){c||(k(l.$$.fragment,i),c=!0)},o(i){w(l.$$.fragment,i),c=!1},d(i){i&&C(o),i&&C(a),L(l,i)}}}function sr(t){let o,a;return o=new Bn({props:{$$slots:{default:[lr]},$$scope:{ctx:t}}}),{c(){v(o.$$.fragment)},m(l,c){S(o,l,c),a=!0},p(l,[c]){const i={};c&1&&(i.$$scope={dirty:c,ctx:l}),o.$set(i)},i(l){a||(k(o.$$.fragment,l),a=!0)},o(l){w(o.$$.fragment,l),a=!1},d(l){L(o,l)}}}class ir extends dn{constructor(o){super(),fn(this,o,null,sr,mn,{})}}new ir({target:document.getElementById("app")});
