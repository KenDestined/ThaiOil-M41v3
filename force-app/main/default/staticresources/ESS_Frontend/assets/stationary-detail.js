import{bf as wl,S as Wt,i as Jt,s as Ht,e as wn,a as P,a3 as Ee,d as z,U as mn,af as vr,bG as kl,B as fe,m as G,q as le,h as g,o as M,j as v,a6 as he,p as u,ab as bt,aW as yl,bt as li,ar as ao,O as Sr,w as L,x as q,P as fo,Q as co,t as _,b as C,y as V,T as oi,V as uo,W as po,g as de,c as pe,a4 as mo,a5 as ho,F as we,G as ke,L as je,ap as hn,X as go,a0 as _o,ae as bo,r as vl,D as Sl,M as wo,b3 as ko,b4 as yo,bV as vo,K as Cr,bM as So,z as Co,bR as si,bW as Oo,at as Mo,A as Io,R as $o,ac as ai}from"./MainLayout.js";import{a as Je,f as Le}from"./formatter.js";import{E as Re}from"./ESS_Stationary.service.js";import{P as Eo}from"./PageTitle.js";import{R as fi}from"./RatingForm.js";import{B as Ye}from"./Button.js";import{A as No}from"./Alert.js";import{M as er}from"./Modal.js";import{R as gn}from"./Radio.js";import{B as _n}from"./BaseInput.js";import{c as qt,d as Mn,f as Wn,b as dr}from"./array.js";import{c as ci,r as Vt,a as In,b as Bo,g as $n}from"./sharedValidate.js";import{N as Cl}from"./NumberInput.js";import{D as Er}from"./Dropdown.js";import{C as Fo,T as To}from"./Table.js";import{F as Ao}from"./FileInput.js";import{C as Do}from"./CheckBox.js";import{E as Po}from"./EmployeeDropdown.js";import{a as Ut,R as zo}from"./RequesterData.js";import{T as rn}from"./TextArea.js";import{P as Ro}from"./PreviewModal.js";import{D as Ol}from"./DatePicker.js";import{C as Lo}from"./ConfirmModal.js";import{a as qo}from"./stationaryEnum.js";import"./Label.js";import"./_commonjsHelpers.js";import"./html.js";import"./flatpickr.js";import"./DatePicker.svelte_svelte_type_style_lang.js";const Vo=r=>{const e=qt({attachmentFiles:Mn().nullable().of(qt({id:Vt.required(In.upload)}).required(In.upload)).required(In.upload).min(1,In.upload),name:Vt.label("ชื่ออุปกรณ์"),quantity:$n.label("จำนวนที่เบิก"),unit:Vt.label("หน่วย")});return wl(e,r)};function ui(r){let e;return r.canSubmit?e=qt({withdrawFrom:ci("ต้องการเบิกจาก"),serviceFor:ci("เพื่อใช้ในบริษัท (Service For)"),location:Vt.label("สถานที่จัดส่ง (Location)"),internalNo:Vt.label("เบอร์โทรศัพท์ภายใน"),mobileNo:Vt.length(10,In.exactLength).label("เบอร์โทรศัพท์มือถือ (Mobile)"),needDate:Bo.label("ต้องการของวันที่ (Need Date)"),withdraws:Mn().of(qt({stockOnHand:Wn(),quantity:Wn().required().test("quantity-lower-stockOnHand","จำนวนที่เบิก ต้องน้อยกว่าหรือเท่ากับ จำนวนคงคลัง",function(t){return t<=this.parent.stockOnHand}).min(1,"จำนวนที่เบิก ต้องมากกว่า 0")})),withdrawOthers:Mn().of(qt({quantity:$n.label("จำนวนที่เบิก").min(1,"จำนวนที่เบิก ต้องมากกว่า 0")})),comment:dr().when(["withdrawOthers"],{is:t=>t.length,then:t=>Vt.label("ใช้สำหรับ (For)"),otherwise:t=>t.nullable()}),onBehalfOfId:r.isOnBehalf?Vt.label("On Behalf of"):dr().nullable()}):r.canComplete&&(e=qt({withdraws:Mn().of(qt({quantity:Wn(),actualWithdraw:$n.label("จำนวนที่จ่ายจริง").test("actualWithdraw-lower-stockOnHand","จำนวนที่จ่ายจริง ต้องน้อยกว่าหรือเท่ากับ จำนวนคงคลัง",function(t){return t<=this.parent.stockOnHand})})),withdrawOthers:Mn().of(qt({stationaryId:dr().nullable(),quantity:Wn(),actualWithdraw:$n.label("จำนวนที่จ่ายจริง").test("actualWithdraw-lower-stockOnHand","จำนวนที่จ่ายจริง ต้องน้อยกว่าหรือเท่ากับ จำนวนคงคลัง",function(t){return this.parent.stationaryId?t<=this.parent.stockOnHand:!0}),pricePerUnit:$n.label("ราคา/หน่วย (บาท)").min(1,"ราคา/หน่วย (บาท) ต้องมากกว่า 0")}))})),wl(e,r)}function jo(r){const e=t=>{r&&!r.contains(t.target)&&!t.defaultPrevented&&r.dispatchEvent(new CustomEvent("click_outside",r))};return document.addEventListener("click",e,!0),{destroy(){document.removeEventListener("click",e,!0)}}}function Wo(r){let e=Je(r[0])+"",t;return{c(){t=G(e)},m(n,i){P(n,t,i)},p(n,i){i&1&&e!==(e=Je(n[0])+"")&&le(t,e)},d(n){n&&z(t)}}}function Jo(r){let e,t,n,i,o,l,s,a;function f(p,m){return p[3]?Ho:Uo}let c=f(r),d=c(r);return{c(){e=g("div"),t=g("button"),t.textContent="-",n=M(),i=g("div"),d.c(),o=M(),l=g("button"),l.textContent="+",v(t,"type","button"),v(t,"class","_withdraw-button svelte-s2y4f7"),he(t,"_disabled",r[0]===0),v(i,"class","flex-1 border-x border-gray-400 leading-[24px] w-[80px]"),he(i,"cursor-pointer",r[1]),v(l,"class","_withdraw-button svelte-s2y4f7"),he(l,"_disabled",r[0]+1>r[2]),v(e,"class","flex h-4 border border-gray-400 text-center")},m(p,m){P(p,e,m),u(e,t),u(e,n),u(e,i),d.m(i,null),u(e,o),u(e,l),s||(a=[bt(t,"click",r[7]),bt(i,"click",r[6]),bt(l,"click",r[11])],s=!0)},p(p,m){m&1&&he(t,"_disabled",p[0]===0),c===(c=f(p))&&d?d.p(p,m):(d.d(1),d=c(p),d&&(d.c(),d.m(i,null))),m&2&&he(i,"cursor-pointer",p[1]),m&5&&he(l,"_disabled",p[0]+1>p[2])},d(p){p&&z(e),d.d(),s=!1,yl(a)}}}function Ho(r){let e,t,n,i;return{c(){e=g("div"),t=g("input"),v(t,"class","outline-none h-[22px] px-1 w-full"),v(t,"type","number"),v(t,"min",0),v(t,"max",r[2])},m(o,l){P(o,e,l),u(e,t),li(t,r[0]),r[9](t),n||(i=[bt(t,"change",r[5]),bt(t,"input",r[8]),ao(jo.call(null,e)),bt(e,"click_outside",r[10])],n=!0)},p(o,l){l&4&&v(t,"max",o[2]),l&1&&kl(t.value)!==o[0]&&li(t,o[0])},d(o){o&&z(e),r[9](null),n=!1,yl(i)}}}function Uo(r){let e,t=Je(r[0])+"",n;return{c(){e=g("span"),n=G(t)},m(i,o){P(i,e,o),u(e,n)},p(i,o){o&1&&t!==(t=Je(i[0])+"")&&le(n,t)},d(i){i&&z(e)}}}function Go(r){let e;function t(o,l){return o[1]?Jo:Wo}let n=t(r),i=n(r);return{c(){i.c(),e=wn()},m(o,l){i.m(o,l),P(o,e,l)},p(o,[l]){n===(n=t(o))&&i?i.p(o,l):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e)))},i:Ee,o:Ee,d(o){i.d(o),o&&z(e)}}}function Ko(r,e,t){let{canEdit:n}=e,{max:i}=e,{value:o}=e;const l=mn(),s=()=>l("change");let a=!1,f;async function c(){n&&(t(3,a=!0),await vr(),f.focus())}const d=()=>{t(0,o--,o),s()};function p(){o=kl(this.value),t(0,o)}function m(k){fe[k?"unshift":"push"](()=>{f=k,t(4,f)})}const h=()=>t(3,a=!1),b=()=>{t(0,o++,o),s()};return r.$$set=k=>{"canEdit"in k&&t(1,n=k.canEdit),"max"in k&&t(2,i=k.max),"value"in k&&t(0,o=k.value)},[o,n,i,a,f,s,c,d,p,m,h,b]}class Ml extends Wt{constructor(e){super(),Jt(this,e,Ko,Go,Ht,{canEdit:1,max:2,value:0})}}function Qo(r){let e,t;const n=[{valueKey:"stationaryId"},{labelKey:"stationaryId"},{getOptionList:r[1]},{value:r[0]},r[2]];let i={};for(let o=0;o<n.length;o+=1)i=Sr(i,n[o]);return e=new Er({props:i}),e.$on("change",r[4]),{c(){L(e.$$.fragment)},m(o,l){q(e,o,l),t=!0},p(o,[l]){const s=l&7?fo(n,[n[0],n[1],l&2&&{getOptionList:o[1]},l&1&&{value:o[0]},l&4&&co(o[2])]):{};e.$set(s)},i(o){t||(_(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){V(e,o)}}}function Zo(r,e,t){const n=["value","withdrawFrom"];let i=oi(e,n),{value:o}=e,{withdrawFrom:l}=e;function s(f){return Re.GetInActiveMasterStationaryList({search:{recordId:"",search:f},serviceFor:l==null?void 0:l.key})}function a(f){po.call(this,r,f)}return r.$$set=f=>{e=Sr(Sr({},e),uo(f)),t(2,i=oi(e,n)),"value"in f&&t(0,o=f.value),"withdrawFrom"in f&&t(3,l=f.withdrawFrom)},r.$$.update=()=>{r.$$.dirty&8&&l&&s("")},[o,s,i,l,a]}class Xo extends Wt{constructor(e){super(),Jt(this,e,Zo,Qo,Ht,{value:0,withdrawFrom:3})}}function Il(r,e,t){for(let n=0;;n++){if(n==r.childCount||n==e.childCount)return r.childCount==e.childCount?null:t;let i=r.child(n),o=e.child(n);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let l=0;i.text[l]==o.text[l];l++)t++;return t}if(i.content.size||o.content.size){let l=Il(i.content,o.content,t+1);if(l!=null)return l}t+=i.nodeSize}}function $l(r,e,t,n){for(let i=r.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:n};let l=r.child(--i),s=e.child(--o),a=l.nodeSize;if(l==s){t-=a,n-=a;continue}if(!l.sameMarkup(s))return{a:t,b:n};if(l.isText&&l.text!=s.text){let f=0,c=Math.min(l.text.length,s.text.length);for(;f<c&&l.text[l.text.length-f-1]==s.text[s.text.length-f-1];)f++,t--,n--;return{a:t,b:n}}if(l.content.size||s.content.size){let f=$l(l.content,s.content,t-1,n-1);if(f)return f}t-=a,n-=a}}class ee{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,i=0,o){for(let l=0,s=0;s<t;l++){let a=this.content[l],f=s+a.nodeSize;if(f>e&&n(a,i+s,o||null,l)!==!1&&a.content.size){let c=s+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,t-c),n,i+c)}s=f}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,i){let o="",l=!0;return this.nodesBetween(e,t,(s,a)=>{s.isText?(o+=s.text.slice(Math.max(e,a)-a,t-a),l=!n):s.isLeaf?(i?o+=typeof i=="function"?i(s):i:s.type.spec.leafText&&(o+=s.type.spec.leafText(s)),l=!n):!l&&s.isBlock&&(o+=n,l=!0)},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(i[i.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new ee(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let n=[],i=0;if(t>e)for(let o=0,l=0;l<t;o++){let s=this.content[o],a=l+s.nodeSize;a>e&&((l<e||a>t)&&(s.isText?s=s.cut(Math.max(0,e-l),Math.min(s.text.length,t-l)):s=s.cut(Math.max(0,e-l-1),Math.min(s.content.size,t-l-1))),n.push(s),i+=s.nodeSize),l=a}return new ee(n,i)}cutByIndex(e,t){return e==t?ee.empty:e==0&&t==this.content.length?this:new ee(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return i[e]=t,new ee(i,o)}addToStart(e){return new ee([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new ee(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let i=this.content[t];e(i,n,t),n+=i.nodeSize}}findDiffStart(e,t=0){return Il(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return $l(this,e,t,n)}findIndex(e,t=-1){if(e==0)return Jn(0,e);if(e==this.size)return Jn(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let o=this.child(n),l=i+o.nodeSize;if(l>=e)return l==e||t>0?Jn(n+1,l):Jn(n,i);i=l}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return ee.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new ee(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return ee.empty;let t,n=0;for(let i=0;i<e.length;i++){let o=e[i];n+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new ee(t||e,n)}static from(e){if(!e)return ee.empty;if(e instanceof ee)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new ee([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ee.empty=new ee([],0);const pr={index:0,offset:0};function Jn(r,e){return pr.index=r,pr.offset=e,pr}function Or(r,e){if(r===e)return!0;if(!(r&&typeof r=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(r);if(Array.isArray(e)!=t)return!1;if(t){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!Or(r[n],e[n]))return!1}else{for(let n in r)if(!(n in e)||!Or(r[n],e[n]))return!1;for(let n in e)if(!(n in r))return!1}return!0}class mt{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Or(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);return n.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return mt.none;if(e instanceof mt)return[e];let t=e.slice();return t.sort((n,i)=>n.type.rank-i.type.rank),t}}mt.none=[];class Yo extends Error{}class se{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=Nl(this.content,e+this.openStart,t);return n&&new se(n,this.openStart,this.openEnd)}removeBetween(e,t){return new se(El(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return se.empty;let n=t.openStart||0,i=t.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new se(ee.fromJSON(e,t.content),n,i)}static maxOpen(e,t=!0){let n=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new se(e,n,i)}}se.empty=new se(ee.empty,0,0);function El(r,e,t){let{index:n,offset:i}=r.findIndex(e),o=r.maybeChild(n),{index:l,offset:s}=r.findIndex(t);if(i==e||o.isText){if(s!=t&&!r.child(l).isText)throw new RangeError("Removing non-flat range");return r.cut(0,e).append(r.cut(t))}if(n!=l)throw new RangeError("Removing non-flat range");return r.replaceChild(n,o.copy(El(o.content,e-i-1,t-i-1)))}function Nl(r,e,t,n){let{index:i,offset:o}=r.findIndex(e),l=r.maybeChild(i);if(o==e||l.isText)return n&&!n.canReplace(i,i,t)?null:r.cut(0,e).append(t).append(r.cut(e));let s=Nl(l.content,e-o-1,t);return s&&r.replaceChild(i,l.copy(s))}class Mr{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}class Qn{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(n=>{n.tag?this.tags.push(n):n.style&&this.styles.push(n)}),this.normalizeLists=!this.tags.some(n=>{if(!/^(ul|ol)\b/.test(n.tag)||!n.node)return!1;let i=e.nodes[n.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let n=new pi(this,t,!1);return n.addAll(e,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new pi(this,t,!0);return n.addAll(e,t.from,t.to),se.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(ts(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let l=o.getAttrs(e);if(l===!1)continue;o.attrs=l||void 0}return o}}}matchStyle(e,t,n,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let l=this.styles[o],s=l.style;if(!(s.indexOf(e)!=0||l.context&&!n.matchesContext(l.context)||s.length>e.length&&(s.charCodeAt(e.length)!=61||s.slice(e.length+1)!=t))){if(l.getAttrs){let a=l.getAttrs(t);if(a===!1)continue;l.attrs=a||void 0}return l}}}static schemaRules(e){let t=[];function n(i){let o=i.priority==null?50:i.priority,l=0;for(;l<t.length;l++){let s=t[l];if((s.priority==null?50:s.priority)<o)break}t.splice(l,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(l=>{n(l=mi(l)),l.mark||l.ignore||l.clearMark||(l.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(l=>{n(l=mi(l)),l.node||l.ignore||l.mark||(l.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Qn(e,Qn.schemaRules(e)))}}const Bl={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},xo={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Fl={ol:!0,ul:!0},Zn=1,Xn=2,Bn=4;function di(r,e,t){return e!=null?(e?Zn:0)|(e==="full"?Xn:0):r&&r.whitespace=="pre"?Zn|Xn:t&~Bn}class Hn{constructor(e,t,n,i,o,l,s){this.type=e,this.attrs=t,this.marks=n,this.pendingMarks=i,this.solid=o,this.options=s,this.content=[],this.activeMarks=mt.none,this.stashMarks=[],this.match=l||(s&Bn?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(ee.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Zn)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let o=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=ee.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(ee.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,n=this.pendingMarks;t<n.length;t++){let i=n[t];(this.type?this.type.allowsMarkType(i.type):rs(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Bl.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class pi{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0;let i=t.topNode,o,l=di(null,t.preserveWhitespace,0)|(n?Bn:0);i?o=new Hn(i.type,i.attrs,mt.none,mt.none,!0,t.topMatch||i.type.contentMatch,l):n?o=new Hn(null,null,mt.none,mt.none,!0,null,l):o=new Hn(e.schema.topNodeType,null,mt.none,mt.none,!0,null,l),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){if(e.nodeType==3)this.addTextNode(e);else if(e.nodeType==1){let t=e.getAttribute("style");if(!t)this.addElement(e);else{let n=this.readStyles(ns(t));if(!n)return;let[i,o]=n,l=this.top;for(let s=0;s<o.length;s++)this.removePendingMark(o[s],l);for(let s=0;s<i.length;s++)this.addPendingMark(i[s]);this.addElement(e);for(let s=0;s<i.length;s++)this.removePendingMark(i[s],l);for(let s=0;s<o.length;s++)this.addPendingMark(o[s])}}}addTextNode(e){let t=e.nodeValue,n=this.top;if(n.options&Xn||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(n.options&Zn)n.options&Xn?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=n.content[n.content.length-1],o=e.previousSibling;(!i||o&&o.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let n=e.nodeName.toLowerCase(),i;Fl.hasOwnProperty(n)&&this.parser.normalizeLists&&es(e);let o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(o?o.ignore:xo.hasOwnProperty(n))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);let l,s=this.top,a=this.needsBlock;if(Bl.hasOwnProperty(n))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),l=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}this.addAll(e),l&&this.sync(s),this.needsBlock=a}else this.addElementByRule(e,o,o.consuming===!1?i:void 0)}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=mt.none,n=mt.none;e:for(let i=0;i<e.length;i+=2)for(let o=void 0;;){let l=this.parser.matchStyle(e[i],e[i+1],this,o);if(!l)continue e;if(l.ignore)return null;if(l.clearMark?this.top.pendingMarks.forEach(s=>{l.clearMark(s)&&(n=s.addToSet(n))}):t=this.parser.schema.marks[l.mark].create(l.attrs).addToSet(t),l.consuming===!1)o=l;else break}return[t,n]}addElementByRule(e,t,n){let i,o,l;t.node?(o=this.parser.schema.nodes[t.node],o.isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):i=this.enter(o,t.attrs||null,t.preserveWhitespace)):(l=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(l));let s=this.top;if(o&&o.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a)}i&&this.sync(s)&&this.open--,l&&this.removePendingMark(l,s)}addAll(e,t,n){let i=t||0;for(let o=t?e.childNodes[t]:e.firstChild,l=n==null?null:e.childNodes[n];o!=l;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o);this.findAtPoint(e,i)}findPlace(e){let t,n;for(let i=this.open;i>=0;i--){let o=this.nodes[i],l=o.findWrapping(e);if(l&&(!t||t.length>l.length)&&(t=l,n=o,!l.length)||o.solid)break}if(!t)return!1;this.sync(n);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let n=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(n=e.marks[i].addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,n),i}enterInner(e,t=null,n=!1,i){this.closeExtra();let o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e);let l=di(e,i,o.options);o.options&Bn&&o.content.length==0&&(l|=Bn),this.nodes.push(new Hn(e,t,o.activeMarks,o.pendingMarks,n,null,l)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+(i?0:1),l=(s,a)=>{for(;s>=0;s--){let f=t[s];if(f==""){if(s==t.length-1||s==0)continue;for(;a>=o;a--)if(l(s-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:n&&a>=o?n.node(a-o).type:null;if(!c||c.name!=f&&c.groups.indexOf(f)==-1)return!1;a--}}return!0};return l(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let n=this.parser.schema.nodes[t];if(n.isTextblock&&n.defaultAttrs)return n}}addPendingMark(e){let t=is(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let n=this.open;n>=0;n--){let i=this.nodes[n];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let l=i.popFromStashMark(e);l&&i.type&&i.type.allowsMarkType(l.type)&&(i.activeMarks=l.addToSet(i.activeMarks))}if(i==t)break}}}function es(r){for(let e=r.firstChild,t=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&Fl.hasOwnProperty(n)&&t?(t.appendChild(e),e=t):n=="li"?t=e:n&&(t=null)}}function ts(r,e){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,e)}function ns(r){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,n=[];for(;t=e.exec(r);)n.push(t[1],t[2].trim());return n}function mi(r){let e={};for(let t in r)e[t]=r[t];return e}function rs(r,e){let t=e.schema.nodes;for(let n in t){let i=t[n];if(!i.allowsMarkType(r))continue;let o=[],l=s=>{o.push(s);for(let a=0;a<s.edgeCount;a++){let{type:f,next:c}=s.edge(a);if(f==e||o.indexOf(c)<0&&l(c))return!0}};if(l(i.contentMatch))return!0}}function is(r,e){for(let t=0;t<e.length;t++)if(r.eq(e[t]))return e[t]}const Tl=65535,Al=Math.pow(2,16);function ls(r,e){return r+e*Al}function hi(r){return r&Tl}function ss(r){return(r-(r&Tl))/Al}const Dl=1,Pl=2,Gn=4,zl=8;class gi{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(this.delInfo&zl)>0}get deletedBefore(){return(this.delInfo&(Dl|Gn))>0}get deletedAfter(){return(this.delInfo&(Pl|Gn))>0}get deletedAcross(){return(this.delInfo&Gn)>0}}class _t{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&_t.empty)return _t.empty}recover(e){let t=0,n=hi(e);if(!this.inverted)for(let i=0;i<n;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+t+ss(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let i=0,o=this.inverted?2:1,l=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?i:0);if(a>e)break;let f=this.ranges[s+o],c=this.ranges[s+l],d=a+f;if(e<=d){let p=f?e==a?-1:e==d?1:t:t,m=a+i+(p<0?0:c);if(n)return m;let h=e==(t<0?a:d)?null:ls(s/3,e-a),b=e==a?Pl:e==d?Dl:Gn;return(t<0?e!=a:e!=d)&&(b|=zl),new gi(m,b,h)}i+=c-f}return n?e+i:new gi(e+i,0,null)}touches(e,t){let n=0,i=hi(t),o=this.inverted?2:1,l=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?n:0);if(a>e)break;let f=this.ranges[s+o],c=a+f;if(e<=c&&s==i*3)return!0;n+=this.ranges[s+l]-f}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let l=this.ranges[i],s=l-(this.inverted?o:0),a=l+(this.inverted?0:o),f=this.ranges[i+t],c=this.ranges[i+n];e(s,s+f,a,a+c),o+=c-f}}invert(){return new _t(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?_t.empty:new _t(e<0?[0,-e,0]:[0,0,e])}}_t.empty=new _t([]);const mr=Object.create(null);class dt{getMap(){return _t.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=mr[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in mr)throw new RangeError("Duplicate use of step JSON ID "+e);return mr[e]=t,t.prototype.jsonID=e,t}}class We{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new We(e,null)}static fail(e){return new We(null,e)}static fromReplace(e,t,n,i){try{return We.ok(e.replace(t,n,i))}catch(o){if(o instanceof Yo)return We.fail(o.message);throw o}}}function Nr(r,e,t){let n=[];for(let i=0;i<r.childCount;i++){let o=r.child(i);o.content.size&&(o=o.copy(Nr(o.content,e,o))),o.isInline&&(o=e(o,t,i)),n.push(o)}return ee.fromArray(n)}class xt extends dt{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),o=new se(Nr(t.content,(l,s)=>!l.isAtom||!s.type.allowsMarkType(this.mark.type)?l:l.mark(this.mark.addToSet(l.marks)),i),t.openStart,t.openEnd);return We.fromReplace(e,this.from,this.to,o)}invert(){return new en(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new xt(t.pos,n.pos,this.mark)}merge(e){return e instanceof xt&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new xt(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new xt(t.from,t.to,e.markFromJSON(t.mark))}}dt.jsonID("addMark",xt);class en extends dt{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new se(Nr(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return We.fromReplace(e,this.from,this.to,n)}invert(){return new xt(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new en(t.pos,n.pos,this.mark)}merge(e){return e instanceof en&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new en(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new en(t.from,t.to,e.markFromJSON(t.mark))}}dt.jsonID("removeMark",en);class tn extends dt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return We.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return We.fromReplace(e,this.pos,this.pos+1,new se(ee.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let n=this.mark.addToSet(t.marks);if(n.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(n))return new tn(this.pos,t.marks[i]);return new tn(this.pos,this.mark)}}return new Tn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new tn(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new tn(t.pos,e.markFromJSON(t.mark))}}dt.jsonID("addNodeMark",tn);class Tn extends dt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return We.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return We.fromReplace(e,this.pos,this.pos+1,new se(ee.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new tn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Tn(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Tn(t.pos,e.markFromJSON(t.mark))}}dt.jsonID("removeNodeMark",Tn);class gt extends dt{constructor(e,t,n,i=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=i}apply(e){return this.structure&&Ir(e,this.from,this.to)?We.fail("Structure replace would overwrite content"):We.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new _t([this.from,this.to-this.from,this.slice.size])}invert(e){return new gt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new gt(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof gt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?se.empty:new se(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new gt(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?se.empty:new se(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new gt(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new gt(t.from,t.to,se.fromJSON(e,t.slice),!!t.structure)}}dt.jsonID("replace",gt);class ut extends dt{constructor(e,t,n,i,o,l,s=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=i,this.slice=o,this.insert=l,this.structure=s}apply(e){if(this.structure&&(Ir(e,this.from,this.gapFrom)||Ir(e,this.gapTo,this.to)))return We.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return We.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?We.fromReplace(e,this.from,this.to,n):We.fail("Content does not fit in gap")}getMap(){return new _t([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ut(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||i<t.pos||o>n.pos?null:new ut(t.pos,n.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ut(t.from,t.to,t.gapFrom,t.gapTo,se.fromJSON(e,t.slice),t.insert,!!t.structure)}}dt.jsonID("replaceAround",ut);function Ir(r,e,t){let n=r.resolve(e),i=t-e,o=n.depth;for(;i>0&&o>0&&n.indexAfter(o)==n.node(o).childCount;)o--,i--;if(i>0){let l=n.node(o).maybeChild(n.indexAfter(o));for(;i>0;){if(!l||l.isLeaf)return!0;l=l.firstChild,i--}}return!1}function as(r,e,t){return(e==0||r.canReplace(e,r.childCount))&&(t==r.childCount||r.canReplace(0,t))}function kn(r){let t=r.parent.content.cutByIndex(r.startIndex,r.endIndex);for(let n=r.depth;;--n){let i=r.$from.node(n),o=r.$from.index(n),l=r.$to.indexAfter(n);if(n<r.depth&&i.canReplace(o,l,t))return n;if(n==0||i.type.spec.isolating||!as(i,o,l))break}return null}function Rl(r,e,t=null,n=r){let i=fs(r,e),o=i&&cs(n,e);return o?i.map(_i).concat({type:e,attrs:t}).concat(o.map(_i)):null}function _i(r){return{type:r,attrs:null}}function fs(r,e){let{parent:t,startIndex:n,endIndex:i}=r,o=t.contentMatchAt(n).findWrapping(e);if(!o)return null;let l=o.length?o[0]:e;return t.canReplaceWith(n,i,l)?o:null}function cs(r,e){let{parent:t,startIndex:n,endIndex:i}=r,o=t.child(n),l=e.contentMatch.findWrapping(o.type);if(!l)return null;let a=(l.length?l[l.length-1]:e).contentMatch;for(let f=n;a&&f<i;f++)a=a.matchType(t.child(f).type);return!a||!a.validEnd?null:l}function pn(r,e,t=1,n){let i=r.resolve(e),o=i.depth-t,l=n&&n[n.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!l.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let f=i.depth-1,c=t-2;f>o;f--,c--){let d=i.node(f),p=i.index(f);if(d.type.spec.isolating)return!1;let m=d.content.cutByIndex(p,d.childCount),h=n&&n[c]||d;if(h!=d&&(m=m.replaceChild(0,h.type.create(h.attrs))),!d.canReplace(p+1,d.childCount)||!h.type.validContent(m))return!1}let s=i.indexAfter(o),a=n&&n[0];return i.node(o).canReplaceWith(s,s,a?a.type:i.node(o+1).type)}function ln(r,e){let t=r.resolve(e),n=t.index();return Ll(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(n,n+1)}function Ll(r,e){return!!(r&&e&&!r.isLeaf&&r.canAppend(e))}function ql(r,e,t=-1){let n=r.resolve(e);for(let i=n.depth;;i--){let o,l,s=n.index(i);if(i==n.depth?(o=n.nodeBefore,l=n.nodeAfter):t>0?(o=n.node(i+1),s++,l=n.node(i).maybeChild(s)):(o=n.node(i).maybeChild(s-1),l=n.node(i+1)),o&&!o.isTextblock&&Ll(o,l)&&n.node(i).canReplace(s,s+1))return e;if(i==0)break;e=t<0?n.before(i):n.after(i)}}function Vl(r,e,t=e,n=se.empty){if(e==t&&!n.size)return null;let i=r.resolve(e),o=r.resolve(t);return us(i,o,n)?new gt(e,t,n):new ds(i,o,n).fit()}function us(r,e,t){return!t.openStart&&!t.openEnd&&r.start()==e.start()&&r.parent.canReplace(r.index(),e.index(),t.content)}class ds{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=ee.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=ee.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let f=this.findFittable();f?this.placeNodes(f):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let o=this.placed,l=n.depth,s=i.depth;for(;l&&s&&o.childCount==1;)o=o.firstChild.content,l--,s--;let a=new se(o,l,s);return e>-1?new ut(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new gt(n.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=t==1?e:this.unplaced.openStart;n>=0;n--){let i,o=null;n?(o=hr(this.unplaced.content,n-1).firstChild,i=o.content):i=this.unplaced.content;let l=i.firstChild;for(let s=this.depth;s>=0;s--){let{type:a,match:f}=this.frontier[s],c,d=null;if(t==1&&(l?f.matchType(l.type)||(d=f.fillBefore(ee.from(l),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:s,parent:o,inject:d};if(t==2&&l&&(c=f.findWrapping(l.type)))return{sliceDepth:n,frontierDepth:s,parent:o,wrap:c};if(o&&f.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=hr(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new se(e,t+1,Math.max(n,i.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=hr(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new se(En(e,t-1,1),t-1,o?t-1:n)}else this.unplaced=new se(En(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let b=0;b<o.length;b++)this.openFrontierNode(o[b]);let l=this.unplaced,s=n?n.content:l.content,a=l.openStart-e,f=0,c=[],{match:d,type:p}=this.frontier[t];if(i){for(let b=0;b<i.childCount;b++)c.push(i.child(b));d=d.matchFragment(i)}let m=s.size+e-(l.content.size-l.openEnd);for(;f<s.childCount;){let b=s.child(f),k=d.matchType(b.type);if(!k)break;f++,(f>1||a==0||b.content.size)&&(d=k,c.push(jl(b.mark(p.allowedMarks(b.marks)),f==1?a:0,f==s.childCount?m:-1)))}let h=f==s.childCount;h||(m=-1),this.placed=Nn(this.placed,t,ee.from(c)),this.frontier[t].match=d,h&&m<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let b=0,k=s;b<m;b++){let S=k.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),k=S.content}this.unplaced=h?e==0?se.empty:new se(En(l.content,e-1,1),e-1,m<0?l.openEnd:e-1):new se(En(l.content,e,f),l.openStart,l.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!gr(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),l=gr(e,t,i,n,o);if(l){for(let s=t-1;s>=0;s--){let{match:a,type:f}=this.frontier[s],c=gr(e,s,f,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:l,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Nn(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let i=e.node(n),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Nn(this.placed,this.depth,ee.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(ee.empty,!0);t.childCount&&(this.placed=Nn(this.placed,this.frontier.length,t))}}function En(r,e,t){return e==0?r.cutByIndex(t,r.childCount):r.replaceChild(0,r.firstChild.copy(En(r.firstChild.content,e-1,t)))}function Nn(r,e,t){return e==0?r.append(t):r.replaceChild(r.childCount-1,r.lastChild.copy(Nn(r.lastChild.content,e-1,t)))}function hr(r,e){for(let t=0;t<e;t++)r=r.firstChild.content;return r}function jl(r,e,t){if(e<=0)return r;let n=r.content;return e>1&&(n=n.replaceChild(0,jl(n.firstChild,e-1,n.childCount==1?t-1:0))),e>0&&(n=r.type.contentMatch.fillBefore(n).append(n),t<=0&&(n=n.append(r.type.contentMatch.matchFragment(n).fillBefore(ee.empty,!0)))),r.copy(n)}function gr(r,e,t,n,i){let o=r.node(e),l=i?r.indexAfter(e):r.index(e);if(l==o.childCount&&!t.compatibleContent(o.type))return null;let s=n.fillBefore(o.content,!0,l);return s&&!ps(t,o.content,l)?s:null}function ps(r,e,t){for(let n=t;n<e.childCount;n++)if(!r.allowsMarks(e.child(n).marks))return!0;return!1}class Fn extends dt{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return We.fail("No node at attribute step's position");let n=Object.create(null);for(let o in t.attrs)n[o]=t.attrs[o];n[this.attr]=this.value;let i=t.type.create(n,null,t.marks);return We.fromReplace(e,this.pos,this.pos+1,new se(ee.from(i),0,t.isLeaf?0:1))}getMap(){return _t.empty}invert(e){return new Fn(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Fn(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Fn(t.pos,t.attr,t.value)}}dt.jsonID("attr",Fn);let An=class extends Error{};An=function r(e){let t=Error.call(this,e);return t.__proto__=r.prototype,t};An.prototype=Object.create(Error.prototype);An.prototype.constructor=An;An.prototype.name="TransformError";const _r=Object.create(null);class ve{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new ms(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=se.empty){let n=t.content.lastChild,i=null;for(let s=0;s<t.openEnd;s++)i=n,n=n.lastChild;let o=e.steps.length,l=this.ranges;for(let s=0;s<l.length;s++){let{$from:a,$to:f}=l[s],c=e.mapping.slice(o);e.replaceRange(c.map(a.pos),c.map(f.pos),s?se.empty:t),s==0&&ki(e,o,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:l,$to:s}=i[o],a=e.mapping.slice(n),f=a.map(l.pos),c=a.map(s.pos);o?e.deleteRange(f,c):(e.replaceRangeWith(f,c,t),ki(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let i=e.parent.inlineContent?new De(e):un(e.node(0),e.parent,e.pos,e.index(),t,n);if(i)return i;for(let o=e.depth-1;o>=0;o--){let l=t<0?un(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):un(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(l)return l}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Mt(e.node(0))}static atStart(e){return un(e,e,0,0,1)||new Mt(e)}static atEnd(e){return un(e,e,e.content.size,e.childCount,-1)||new Mt(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=_r[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in _r)throw new RangeError("Duplicate use of selection JSON ID "+e);return _r[e]=t,t.prototype.jsonID=e,t}getBookmark(){return De.between(this.$anchor,this.$head).getBookmark()}}ve.prototype.visible=!0;class ms{constructor(e,t){this.$from=e,this.$to=t}}let bi=!1;function wi(r){!bi&&!r.parent.inlineContent&&(bi=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}class De extends ve{constructor(e,t=e){wi(e),wi(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return ve.near(n);let i=e.resolve(t.map(this.anchor));return new De(i.parent.inlineContent?i:n,n)}replace(e,t=se.empty){if(super.replace(e,t),t==se.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof De&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new tr(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new De(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let i=e.resolve(t);return new this(i,n==t?i:e.resolve(n))}static between(e,t,n){let i=e.pos-t.pos;if((!n||i)&&(n=i>=0?1:-1),!t.parent.inlineContent){let o=ve.findFrom(t,n,!0)||ve.findFrom(t,-n,!0);if(o)t=o.$head;else return ve.near(t,n)}return e.parent.inlineContent||(i==0?e=t:(e=(ve.findFrom(e,-n,!0)||ve.findFrom(e,n,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new De(e,t)}}ve.jsonID("text",De);class tr{constructor(e,t){this.anchor=e,this.head=t}map(e){return new tr(e.map(this.anchor),e.map(this.head))}resolve(e){return De.between(e.resolve(this.anchor),e.resolve(this.head))}}class $e extends ve{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return n?ve.near(o):new $e(o)}content(){return new se(ee.from(this.node),0,0)}eq(e){return e instanceof $e&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Br(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new $e(e.resolve(t.anchor))}static create(e,t){return new $e(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}$e.prototype.visible=!1;ve.jsonID("node",$e);class Br{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new tr(n,n):new Br(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&$e.isSelectable(n)?new $e(t):ve.near(t)}}class Mt extends ve{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=se.empty){if(t==se.empty){e.delete(0,e.doc.content.size);let n=ve.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Mt(e)}map(e){return new Mt(e)}eq(e){return e instanceof Mt}getBookmark(){return hs}}ve.jsonID("all",Mt);const hs={map(){return this},resolve(r){return new Mt(r)}};function un(r,e,t,n,i,o=!1){if(e.inlineContent)return De.create(r,t);for(let l=n-(i>0?0:1);i>0?l<e.childCount:l>=0;l+=i){let s=e.child(l);if(s.isAtom){if(!o&&$e.isSelectable(s))return $e.create(r,t-(i<0?s.nodeSize:0))}else{let a=un(r,s,t+i,i<0?s.childCount:0,i,o);if(a)return a}t+=s.nodeSize*i}return null}function ki(r,e,t){let n=r.steps.length-1;if(n<e)return;let i=r.steps[n];if(!(i instanceof gt||i instanceof ut))return;let o=r.mapping.maps[n],l;o.forEach((s,a,f,c)=>{l==null&&(l=c)}),r.setSelection(ve.near(r.doc.resolve(l),t))}function yi(r,e){return!e||!r?r:r.bind(e)}class Un{constructor(e,t,n){this.name=e,this.init=yi(t.init,n),this.apply=yi(t.apply,n)}}new Un("doc",{init(r){return r.doc||r.schema.topNodeType.createAndFill()},apply(r){return r.doc}}),new Un("selection",{init(r,e){return r.selection||ve.atStart(e.doc)},apply(r){return r.selection}}),new Un("storedMarks",{init(r){return r.storedMarks||null},apply(r,e,t,n){return n.selection.$cursor?r.storedMarks:null}}),new Un("scrollToSelection",{init(){return 0},apply(r,e){return r.scrolledIntoView?e+1:e}});function Wl(r,e,t){for(let n in r){let i=r[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=Wl(i,e,{})),t[n]=i}return t}class Dn{constructor(e){this.spec=e,this.props={},e.props&&Wl(e.props,this,this.props),this.key=e.key?e.key.key:Jl("plugin")}getState(e){return e[this.key]}}const br=Object.create(null);function Jl(r){return r in br?r+"$"+ ++br[r]:(br[r]=0,r+"$")}class Pn{constructor(e="key"){this.key=Jl(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const gs=(r,e)=>r.selection.empty?!1:(e&&e(r.tr.deleteSelection().scrollIntoView()),!0);function _s(r,e){let{$cursor:t}=r.selection;return!t||(e?!e.endOfTextblock("backward",r):t.parentOffset>0)?null:t}const bs=(r,e,t)=>{let n=_s(r,t);if(!n)return!1;let i=Hl(n);if(!i){let l=n.blockRange(),s=l&&kn(l);return s==null?!1:(e&&e(r.tr.lift(l,s).scrollIntoView()),!0)}let o=i.nodeBefore;if(!o.type.spec.isolating&&Kl(r,i,e))return!0;if(n.parent.content.size==0&&(bn(o,"end")||$e.isSelectable(o))){let l=Vl(r.doc,n.before(),n.after(),se.empty);if(l&&l.slice.size<l.to-l.from){if(e){let s=r.tr.step(l);s.setSelection(bn(o,"end")?ve.findFrom(s.doc.resolve(s.mapping.map(i.pos,-1)),-1):$e.create(s.doc,i.pos-o.nodeSize)),e(s.scrollIntoView())}return!0}}return o.isAtom&&i.depth==n.depth-1?(e&&e(r.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1};function bn(r,e,t=!1){for(let n=r;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&n.childCount!=1)return!1}return!1}const ws=(r,e,t)=>{let{$head:n,empty:i}=r.selection,o=n;if(!i)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("backward",r):n.parentOffset>0)return!1;o=Hl(n)}let l=o&&o.nodeBefore;return!l||!$e.isSelectable(l)?!1:(e&&e(r.tr.setSelection($e.create(r.doc,o.pos-l.nodeSize)).scrollIntoView()),!0)};function Hl(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){if(r.index(e)>0)return r.doc.resolve(r.before(e+1));if(r.node(e).type.spec.isolating)break}return null}function ks(r,e){let{$cursor:t}=r.selection;return!t||(e?!e.endOfTextblock("forward",r):t.parentOffset<t.parent.content.size)?null:t}const ys=(r,e,t)=>{let n=ks(r,t);if(!n)return!1;let i=Ul(n);if(!i)return!1;let o=i.nodeAfter;if(Kl(r,i,e))return!0;if(n.parent.content.size==0&&(bn(o,"start")||$e.isSelectable(o))){let l=Vl(r.doc,n.before(),n.after(),se.empty);if(l&&l.slice.size<l.to-l.from){if(e){let s=r.tr.step(l);s.setSelection(bn(o,"start")?ve.findFrom(s.doc.resolve(s.mapping.map(i.pos)),1):$e.create(s.doc,s.mapping.map(i.pos))),e(s.scrollIntoView())}return!0}}return o.isAtom&&i.depth==n.depth-1?(e&&e(r.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},vs=(r,e,t)=>{let{$head:n,empty:i}=r.selection,o=n;if(!i)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("forward",r):n.parentOffset<n.parent.content.size)return!1;o=Ul(n)}let l=o&&o.nodeAfter;return!l||!$e.isSelectable(l)?!1:(e&&e(r.tr.setSelection($e.create(r.doc,o.pos)).scrollIntoView()),!0)};function Ul(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){let t=r.node(e);if(r.index(e)+1<t.childCount)return r.doc.resolve(r.after(e+1));if(t.type.spec.isolating)break}return null}const Ss=(r,e)=>{let t=r.selection,n=t instanceof $e,i;if(n){if(t.node.isTextblock||!ln(r.doc,t.from))return!1;i=t.from}else if(i=ql(r.doc,t.from,-1),i==null)return!1;if(e){let o=r.tr.join(i);n&&o.setSelection($e.create(o.doc,i-r.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},Cs=(r,e)=>{let t=r.selection,n;if(t instanceof $e){if(t.node.isTextblock||!ln(r.doc,t.to))return!1;n=t.to}else if(n=ql(r.doc,t.to,1),n==null)return!1;return e&&e(r.tr.join(n).scrollIntoView()),!0},Os=(r,e)=>{let{$from:t,$to:n}=r.selection,i=t.blockRange(n),o=i&&kn(i);return o==null?!1:(e&&e(r.tr.lift(i,o).scrollIntoView()),!0)},Ms=(r,e)=>{let{$head:t,$anchor:n}=r.selection;return!t.parent.type.spec.code||!t.sameParent(n)?!1:(e&&e(r.tr.insertText(`
`).scrollIntoView()),!0)};function Gl(r){for(let e=0;e<r.edgeCount;e++){let{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const Is=(r,e)=>{let{$head:t,$anchor:n}=r.selection;if(!t.parent.type.spec.code||!t.sameParent(n))return!1;let i=t.node(-1),o=t.indexAfter(-1),l=Gl(i.contentMatchAt(o));if(!l||!i.canReplaceWith(o,o,l))return!1;if(e){let s=t.after(),a=r.tr.replaceWith(s,s,l.createAndFill());a.setSelection(ve.near(a.doc.resolve(s),1)),e(a.scrollIntoView())}return!0},$s=(r,e)=>{let t=r.selection,{$from:n,$to:i}=t;if(t instanceof Mt||n.parent.inlineContent||i.parent.inlineContent)return!1;let o=Gl(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let l=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,s=r.tr.insert(l,o.createAndFill());s.setSelection(De.create(s.doc,l+1)),e(s.scrollIntoView())}return!0},Es=(r,e)=>{let{$cursor:t}=r.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(pn(r.doc,o))return e&&e(r.tr.split(o).scrollIntoView()),!0}let n=t.blockRange(),i=n&&kn(n);return i==null?!1:(e&&e(r.tr.lift(n,i).scrollIntoView()),!0)},Ns=(r,e)=>{let{$from:t,to:n}=r.selection,i,o=t.sharedDepth(n);return o==0?!1:(i=t.before(o),e&&e(r.tr.setSelection($e.create(r.doc,i))),!0)};function Bs(r,e,t){let n=e.nodeBefore,i=e.nodeAfter,o=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(o-1,o)?(t&&t(r.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||ln(r.doc,e.pos))?!1:(t&&t(r.tr.clearIncompatible(e.pos,n.type,n.contentMatchAt(n.childCount)).join(e.pos).scrollIntoView()),!0)}function Kl(r,e,t){let n=e.nodeBefore,i=e.nodeAfter,o,l;if(n.type.spec.isolating||i.type.spec.isolating)return!1;if(Bs(r,e,t))return!0;let s=e.parent.canReplace(e.index(),e.index()+1);if(s&&(o=(l=n.contentMatchAt(n.childCount)).findWrapping(i.type))&&l.matchType(o[0]||i.type).validEnd){if(t){let d=e.pos+i.nodeSize,p=ee.empty;for(let b=o.length-1;b>=0;b--)p=ee.from(o[b].create(null,p));p=ee.from(n.copy(p));let m=r.tr.step(new ut(e.pos-1,d,e.pos,d,new se(p,1,0),o.length,!0)),h=d+2*o.length;ln(m.doc,h)&&m.join(h),t(m.scrollIntoView())}return!0}let a=ve.findFrom(e,1),f=a&&a.$from.blockRange(a.$to),c=f&&kn(f);if(c!=null&&c>=e.depth)return t&&t(r.tr.lift(f,c).scrollIntoView()),!0;if(s&&bn(i,"start",!0)&&bn(n,"end")){let d=n,p=[];for(;p.push(d),!d.isTextblock;)d=d.lastChild;let m=i,h=1;for(;!m.isTextblock;m=m.firstChild)h++;if(d.canReplace(d.childCount,d.childCount,m.content)){if(t){let b=ee.empty;for(let S=p.length-1;S>=0;S--)b=ee.from(p[S].copy(b));let k=r.tr.step(new ut(e.pos-p.length,e.pos+i.nodeSize,e.pos+h,e.pos+i.nodeSize-h,new se(b,p.length,0),0,!0));t(k.scrollIntoView())}return!0}}return!1}function Ql(r){return function(e,t){let n=e.selection,i=r<0?n.$from:n.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(De.create(e.doc,r<0?i.start(o):i.end(o)))),!0):!1}}const Fs=Ql(-1),Ts=Ql(1);function As(r,e=null){return function(t,n){let{$from:i,$to:o}=t.selection,l=i.blockRange(o),s=l&&Rl(l,r,e);return s?(n&&n(t.tr.wrap(l,s).scrollIntoView()),!0):!1}}function vi(r,e=null){return function(t,n){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:l},$to:{pos:s}}=t.selection.ranges[o];t.doc.nodesBetween(l,s,(a,f)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(r,e)))if(a.type==r)i=!0;else{let c=t.doc.resolve(f),d=c.index();i=c.parent.canReplaceWith(d,d+1,r)}})}if(!i)return!1;if(n){let o=t.tr;for(let l=0;l<t.selection.ranges.length;l++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[l];o.setBlockType(s,a,r,e)}n(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Ds(r,e=null){return function(t,n){let{$from:i,$to:o}=t.selection,l=i.blockRange(o),s=!1,a=l;if(!l)return!1;if(l.depth>=2&&i.node(l.depth-1).type.compatibleContent(r)&&l.startIndex==0){if(i.index(l.depth-1)==0)return!1;let c=t.doc.resolve(l.start-2);a=new Mr(c,c,l.depth),l.endIndex<l.parent.childCount&&(l=new Mr(i,t.doc.resolve(o.end(l.depth)),l.depth)),s=!0}let f=Rl(a,r,e,l);return f?(n&&n(Ps(t.tr,l,f,s,r).scrollIntoView()),!0):!1}}function Ps(r,e,t,n,i){let o=ee.empty;for(let c=t.length-1;c>=0;c--)o=ee.from(t[c].type.create(t[c].attrs,o));r.step(new ut(e.start-(n?2:0),e.end,e.start,e.end,new se(o,0,0),t.length,!0));let l=0;for(let c=0;c<t.length;c++)t[c].type==i&&(l=c+1);let s=t.length-l,a=e.start+t.length-(n?2:0),f=e.parent;for(let c=e.startIndex,d=e.endIndex,p=!0;c<d;c++,p=!1)!p&&pn(r.doc,a,s)&&(r.split(a,s),a+=2*s),a+=f.child(c).nodeSize;return r}function zs(r){return function(e,t){let{$from:n,$to:i}=e.selection,o=n.blockRange(i,l=>l.childCount>0&&l.firstChild.type==r);return o?t?n.node(o.depth-1).type==r?Rs(e,t,r,o):Ls(e,t,o):!0:!1}}function Rs(r,e,t,n){let i=r.tr,o=n.end,l=n.$to.end(n.depth);o<l&&(i.step(new ut(o-1,l,o,l,new se(ee.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new Mr(i.doc.resolve(n.$from.pos),i.doc.resolve(l),n.depth));const s=kn(n);if(s==null)return!1;i.lift(n,s);let a=i.mapping.map(o,-1)-1;return ln(i.doc,a)&&i.join(a),e(i.scrollIntoView()),!0}function Ls(r,e,t){let n=r.tr,i=t.parent;for(let m=t.end,h=t.endIndex-1,b=t.startIndex;h>b;h--)m-=i.child(h).nodeSize,n.delete(m-1,m+1);let o=n.doc.resolve(t.start),l=o.nodeAfter;if(n.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let s=t.startIndex==0,a=t.endIndex==i.childCount,f=o.node(-1),c=o.index(-1);if(!f.canReplace(c+(s?0:1),c+1,l.content.append(a?ee.empty:ee.from(i))))return!1;let d=o.pos,p=d+l.nodeSize;return n.step(new ut(d-(s?1:0),p+(a?1:0),d+1,p-1,new se((s?ee.empty:ee.from(i.copy(ee.empty))).append(a?ee.empty:ee.from(i.copy(ee.empty))),s?0:1,a?0:1),s?0:1)),e(n.scrollIntoView()),!0}function qs(r){return function(e,t){let{$from:n,$to:i}=e.selection,o=n.blockRange(i,f=>f.childCount>0&&f.firstChild.type==r);if(!o)return!1;let l=o.startIndex;if(l==0)return!1;let s=o.parent,a=s.child(l-1);if(a.type!=r)return!1;if(t){let f=a.lastChild&&a.lastChild.type==s.type,c=ee.from(f?r.create():null),d=new se(ee.from(r.create(null,ee.from(s.type.create(null,c)))),f?3:1,0),p=o.start,m=o.end;t(e.tr.step(new ut(p-(f?3:1),m,p,m,d,1,!0)).scrollIntoView())}return!0}}function Zl(r){const{state:e,transaction:t}=r;let{selection:n}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return n},get doc(){return i},get tr(){return n=t.selection,i=t.doc,o=t.storedMarks,t}}}class Vs{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:i}=t,{tr:o}=n,l=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([s,a])=>[s,(...c)=>{const d=a(...c)(l);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:i,state:o}=this,{view:l}=i,s=[],a=!!e,f=e||o.tr,c=()=>(!a&&t&&!f.getMeta("preventDispatch")&&!this.hasCustomState&&l.dispatch(f),s.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(n).map(([p,m])=>[p,(...b)=>{const k=this.buildProps(f,t),S=m(...b)(k);return s.push(S),d}])),run:c};return d}createCan(e){const{rawCommands:t,state:n}=this,i=!1,o=e||n.tr,l=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(t).map(([a,f])=>[a,(...c)=>f(...c)({...l,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,t=!0){const{rawCommands:n,editor:i,state:o}=this,{view:l}=i;o.storedMarks&&e.setStoredMarks(o.storedMarks);const s={tr:e,editor:i,view:l,state:Zl({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([a,f])=>[a,(...c)=>f(...c)(s)]))}};return s}}function jt(r,e,t){return r.config[e]===void 0&&r.parent?jt(r.parent,e,t):typeof r.config[e]=="function"?r.config[e].bind({...t,parent:r.parent?jt(r.parent,e,t):null}):r.config[e]}function js(r){const e=r.filter(i=>i.type==="extension"),t=r.filter(i=>i.type==="node"),n=r.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:n}}function rt(r,e){if(typeof r=="string"){if(!e.nodes[r])throw Error(`There is no node type named '${r}'. Maybe you forgot to add the extension?`);return e.nodes[r]}return r}function Ws(r){return typeof r=="function"}function dn(r,e=void 0,...t){return Ws(r)?e?r.bind(e)(...t):r(...t):r}function Js(r){return Object.prototype.toString.call(r)==="[object RegExp]"}function Hs(r){return Object.prototype.toString.call(r).slice(8,-1)}function wr(r){return Hs(r)!=="Object"?!1:r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype}function Fr(r,e){const t={...r};return wr(r)&&wr(e)&&Object.keys(e).forEach(n=>{wr(e[n])?n in r?t[n]=Fr(r[n],e[n]):Object.assign(t,{[n]:e[n]}):Object.assign(t,{[n]:e[n]})}),t}class Et{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=dn(jt(this,"addOptions",{name:this.name}))),this.storage=dn(jt(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Et(e)}configure(e={}){const t=this.extend();return t.options=Fr(this.options,e),t.storage=dn(jt(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Et(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=dn(jt(t,"addOptions",{name:t.name})),t.storage=dn(jt(t,"addStorage",{name:t.name,options:t.options})),t}}function Us(r,e,t){const{from:n,to:i}=e,{blockSeparator:o=`

`,textSerializers:l={}}=t||{};let s="",a=!0;return r.nodesBetween(n,i,(f,c,d,p)=>{var m;const h=l==null?void 0:l[f.type.name];h?(f.isBlock&&!a&&(s+=o,a=!0),d&&(s+=h({node:f,pos:c,parent:d,index:p,range:e}))):f.isText?(s+=(m=f==null?void 0:f.text)===null||m===void 0?void 0:m.slice(Math.max(n,c)-c,i-c),a=!1):f.isBlock&&!a&&(s+=o,a=!0)}),s}function Gs(r){return Object.fromEntries(Object.entries(r.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}Et.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new Dn({key:new Pn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:r}=this,{state:e,schema:t}=r,{doc:n,selection:i}=e,{ranges:o}=i,l=Math.min(...o.map(c=>c.$from.pos)),s=Math.max(...o.map(c=>c.$to.pos)),a=Gs(t);return Us(n,{from:l,to:s},{textSerializers:a})}}})]}});const Ks=()=>({editor:r,view:e})=>(requestAnimationFrame(()=>{var t;r.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),Qs=(r=!1)=>({commands:e})=>e.setContent("",r),Zs=()=>({state:r,tr:e,dispatch:t})=>{const{selection:n}=e,{ranges:i}=n;return t&&i.forEach(({$from:o,$to:l})=>{r.doc.nodesBetween(o.pos,l.pos,(s,a)=>{if(s.type.isText)return;const{doc:f,mapping:c}=e,d=f.resolve(c.map(a)),p=f.resolve(c.map(a+s.nodeSize)),m=d.blockRange(p);if(!m)return;const h=kn(m);if(s.type.isTextblock){const{defaultType:b}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(m.start,b)}(h||h===0)&&e.lift(m,h)})}),!0},Xs=r=>e=>r(e),Ys=()=>({state:r,dispatch:e})=>$s(r,e),xs=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,n=t.$anchor.node();if(n.content.size>0)return!1;const i=r.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===n.type){if(e){const s=i.before(o),a=i.after(o);r.delete(s,a).scrollIntoView()}return!0}return!1},ea=r=>({tr:e,state:t,dispatch:n})=>{const i=rt(r,t.schema),o=e.selection.$anchor;for(let l=o.depth;l>0;l-=1)if(o.node(l).type===i){if(n){const a=o.before(l),f=o.after(l);e.delete(a,f).scrollIntoView()}return!0}return!1},ta=r=>({tr:e,dispatch:t})=>{const{from:n,to:i}=r;return t&&e.delete(n,i),!0},na=()=>({state:r,dispatch:e})=>gs(r,e),ra=()=>({commands:r})=>r.keyboardShortcut("Enter"),ia=()=>({state:r,dispatch:e})=>Is(r,e);function Yn(r,e,t={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>t.strict?e[i]===r[i]:Js(e[i])?e[i].test(r[i]):e[i]===r[i]):!0}function $r(r,e,t={}){return r.find(n=>n.type===e&&Yn(n.attrs,t))}function la(r,e,t={}){return!!$r(r,e,t)}function Xl(r,e,t={}){if(!r||!e)return;let n=r.parent.childAfter(r.parentOffset);if(r.parentOffset===n.offset&&n.offset!==0&&(n=r.parent.childBefore(r.parentOffset)),!n.node)return;const i=$r([...n.node.marks],e,t);if(!i)return;let o=n.index,l=r.start()+n.offset,s=o+1,a=l+n.node.nodeSize;for($r([...n.node.marks],e,t);o>0&&i.isInSet(r.parent.child(o-1).marks);)o-=1,l-=r.parent.child(o).nodeSize;for(;s<r.parent.childCount&&la([...r.parent.child(s).marks],e,t);)a+=r.parent.child(s).nodeSize,s+=1;return{from:l,to:a}}function Gt(r,e){if(typeof r=="string"){if(!e.marks[r])throw Error(`There is no mark type named '${r}'. Maybe you forgot to add the extension?`);return e.marks[r]}return r}const oa=(r,e={})=>({tr:t,state:n,dispatch:i})=>{const o=Gt(r,n.schema),{doc:l,selection:s}=t,{$from:a,from:f,to:c}=s;if(i){const d=Xl(a,o,e);if(d&&d.from<=f&&d.to>=c){const p=De.create(l,d.from,d.to);t.setSelection(p)}}return!0},sa=r=>e=>{const t=typeof r=="function"?r(e):r;for(let n=0;n<t.length;n+=1)if(t[n](e))return!0;return!1};function Yl(r){return r instanceof De}function nn(r=0,e=0,t=0){return Math.min(Math.max(r,e),t)}function aa(r,e=null){if(!e)return null;const t=ve.atStart(r),n=ve.atEnd(r);if(e==="start"||e===!0)return t;if(e==="end")return n;const i=t.from,o=n.to;return e==="all"?De.create(r,nn(0,i,o),nn(r.content.size,i,o)):De.create(r,nn(e,i,o),nn(e,i,o))}function Tr(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const fa=(r=null,e={})=>({editor:t,view:n,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const l=()=>{Tr()&&n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(n.hasFocus()&&r===null||r===!1)return!0;if(o&&r===null&&!Yl(t.state.selection))return l(),!0;const s=aa(i.doc,r)||t.state.selection,a=t.state.selection.eq(s);return o&&(a||i.setSelection(s),a&&i.storedMarks&&i.setStoredMarks(i.storedMarks),l()),!0},ca=(r,e)=>t=>r.every((n,i)=>e(n,{...t,index:i})),ua=(r,e)=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},r,e);function Si(r){const e=`<body>${r}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function xn(r,e,t){if(t={slice:!0,parseOptions:{},...t},typeof r=="object"&&r!==null)try{return Array.isArray(r)&&r.length>0?ee.fromArray(r.map(n=>e.nodeFromJSON(n))):e.nodeFromJSON(r)}catch(n){return console.warn("[tiptap warn]: Invalid content.","Passed value:",r,"Error:",n),xn("",e,t)}if(typeof r=="string"){const n=Qn.fromSchema(e);return t.slice?n.parseSlice(Si(r),t.parseOptions).content:n.parse(Si(r),t.parseOptions)}return xn("",e,t)}function da(r,e,t){const n=r.steps.length-1;if(n<e)return;const i=r.steps[n];if(!(i instanceof gt||i instanceof ut))return;const o=r.mapping.maps[n];let l=0;o.forEach((s,a,f,c)=>{l===0&&(l=c)}),r.setSelection(ve.near(r.doc.resolve(l),t))}const pa=r=>r.toString().startsWith("<"),ma=(r,e,t)=>({tr:n,dispatch:i,editor:o})=>{if(i){t={parseOptions:{},updateSelection:!0,...t};const l=xn(e,o.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(l.toString()==="<>")return!0;let{from:s,to:a}=typeof r=="number"?{from:r,to:r}:r,f=!0,c=!0;if((pa(l)?l:[l]).forEach(p=>{p.check(),f=f?p.isText&&p.marks.length===0:!1,c=c?p.isBlock:!1}),s===a&&c){const{parent:p}=n.doc.resolve(s);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(s-=1,a+=1)}f?Array.isArray(e)?n.insertText(e.map(p=>p.text||"").join(""),s,a):typeof e=="object"&&e&&e.text?n.insertText(e.text,s,a):n.insertText(e,s,a):n.replaceWith(s,a,l),t.updateSelection&&da(n,n.steps.length-1,-1)}return!0},ha=()=>({state:r,dispatch:e})=>Ss(r,e),ga=()=>({state:r,dispatch:e})=>Cs(r,e),_a=()=>({state:r,dispatch:e})=>bs(r,e),ba=()=>({state:r,dispatch:e})=>ys(r,e);function xl(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function wa(r){const e=r.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let n,i,o,l;for(let s=0;s<e.length-1;s+=1){const a=e[s];if(/^(cmd|meta|m)$/i.test(a))l=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))Tr()||xl()?l=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return n&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),l&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const ka=r=>({editor:e,view:t,tr:n,dispatch:i})=>{const o=wa(r).split(/-(?!$)/),l=o.find(f=>!["Alt","Ctrl","Meta","Shift"].includes(f)),s=new KeyboardEvent("keydown",{key:l==="Space"?" ":l,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{t.someProp("handleKeyDown",f=>f(t,s))});return a==null||a.steps.forEach(f=>{const c=f.map(n.mapping);c&&i&&n.maybeStep(c)}),!0};function Ar(r,e,t={}){const{from:n,to:i,empty:o}=r.selection,l=e?rt(e,r.schema):null,s=[];r.doc.nodesBetween(n,i,(d,p)=>{if(d.isText)return;const m=Math.max(n,p),h=Math.min(i,p+d.nodeSize);s.push({node:d,from:m,to:h})});const a=i-n,f=s.filter(d=>l?l.name===d.node.type.name:!0).filter(d=>Yn(d.node.attrs,t,{strict:!1}));return o?!!f.length:f.reduce((d,p)=>d+p.to-p.from,0)>=a}const ya=(r,e={})=>({state:t,dispatch:n})=>{const i=rt(r,t.schema);return Ar(t,i,e)?Os(t,n):!1},va=()=>({state:r,dispatch:e})=>Es(r,e),Sa=r=>({state:e,dispatch:t})=>{const n=rt(r,e.schema);return zs(n)(e,t)},Ca=()=>({state:r,dispatch:e})=>Ms(r,e);function eo(r,e){return e.nodes[r]?"node":e.marks[r]?"mark":null}function Ci(r,e){const t=typeof e=="string"?[e]:e;return Object.keys(r).reduce((n,i)=>(t.includes(i)||(n[i]=r[i]),n),{})}const Oa=(r,e)=>({tr:t,state:n,dispatch:i})=>{let o=null,l=null;const s=eo(typeof r=="string"?r:r.name,n.schema);return s?(s==="node"&&(o=rt(r,n.schema)),s==="mark"&&(l=Gt(r,n.schema)),i&&t.selection.ranges.forEach(a=>{n.doc.nodesBetween(a.$from.pos,a.$to.pos,(f,c)=>{o&&o===f.type&&t.setNodeMarkup(c,void 0,Ci(f.attrs,e)),l&&f.marks.length&&f.marks.forEach(d=>{l===d.type&&t.addMark(c,c+f.nodeSize,l.create(Ci(d.attrs,e)))})})}),!0):!1},Ma=()=>({tr:r,dispatch:e})=>(e&&r.scrollIntoView(),!0),Ia=()=>({tr:r,commands:e})=>e.setTextSelection({from:0,to:r.doc.content.size}),$a=()=>({state:r,dispatch:e})=>ws(r,e),Ea=()=>({state:r,dispatch:e})=>vs(r,e),Na=()=>({state:r,dispatch:e})=>Ns(r,e),Ba=()=>({state:r,dispatch:e})=>Ts(r,e),Fa=()=>({state:r,dispatch:e})=>Fs(r,e);function Ta(r,e,t={}){return xn(r,e,{slice:!1,parseOptions:t})}const Aa=(r,e=!1,t={})=>({tr:n,editor:i,dispatch:o})=>{const{doc:l}=n,s=Ta(r,i.schema,t);return o&&n.replaceWith(0,l.content.size,s).setMeta("preventUpdate",!e),!0};function Da(r){for(let e=0;e<r.edgeCount;e+=1){const{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function Pa(r,e){for(let t=r.depth;t>0;t-=1){const n=r.node(t);if(e(n))return{pos:t>0?r.before(t):0,start:r.start(t),depth:t,node:n}}}function Dr(r){return e=>Pa(e.$from,r)}function za(r,e){const t=Gt(e,r.schema),{from:n,to:i,empty:o}=r.selection,l=[];o?(r.storedMarks&&l.push(...r.storedMarks),l.push(...r.selection.$head.marks())):r.doc.nodesBetween(n,i,a=>{l.push(...a.marks)});const s=l.find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function Kn(r,e,t){return Object.fromEntries(Object.entries(t).filter(([n])=>{const i=r.find(o=>o.type===e&&o.name===n);return i?i.attribute.keepOnSplit:!1}))}function Ra(r,e,t={}){const{empty:n,ranges:i}=r.selection,o=e?Gt(e,r.schema):null;if(n)return!!(r.storedMarks||r.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>Yn(d.attrs,t,{strict:!1}));let l=0;const s=[];if(i.forEach(({$from:d,$to:p})=>{const m=d.pos,h=p.pos;r.doc.nodesBetween(m,h,(b,k)=>{if(!b.isText&&!b.marks.length)return;const S=Math.max(m,k),O=Math.min(h,k+b.nodeSize),$=O-S;l+=$,s.push(...b.marks.map(F=>({mark:F,from:S,to:O})))})}),l===0)return!1;const a=s.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>Yn(d.mark.attrs,t,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),f=s.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,p)=>d+p.to-p.from,0);return(a>0?a+f:a)>=l}function Oi(r,e){const{nodeExtensions:t}=js(e),n=t.find(l=>l.name===r);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},o=dn(jt(n,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function La(r,e,t){var n;const{selection:i}=e;let o=null;if(Yl(i)&&(o=i.$cursor),o){const s=(n=r.storedMarks)!==null&&n!==void 0?n:o.marks();return!!t.isInSet(s)||!s.some(a=>a.type.excludes(t))}const{ranges:l}=i;return l.some(({$from:s,$to:a})=>{let f=s.depth===0?r.doc.inlineContent&&r.doc.type.allowsMarkType(t):!1;return r.doc.nodesBetween(s.pos,a.pos,(c,d,p)=>{if(f)return!1;if(c.isInline){const m=!p||p.type.allowsMarkType(t),h=!!t.isInSet(c.marks)||!c.marks.some(b=>b.type.excludes(t));f=m&&h}return!f}),f})}const qa=(r,e={})=>({tr:t,state:n,dispatch:i})=>{const{selection:o}=t,{empty:l,ranges:s}=o,a=Gt(r,n.schema);if(i)if(l){const f=za(n,a);t.addStoredMark(a.create({...f,...e}))}else s.forEach(f=>{const c=f.$from.pos,d=f.$to.pos;n.doc.nodesBetween(c,d,(p,m)=>{const h=Math.max(m,c),b=Math.min(m+p.nodeSize,d);p.marks.find(S=>S.type===a)?p.marks.forEach(S=>{a===S.type&&t.addMark(h,b,a.create({...S.attrs,...e}))}):t.addMark(h,b,a.create(e))})});return La(n,t,a)},Va=(r,e)=>({tr:t})=>(t.setMeta(r,e),!0),ja=(r,e={})=>({state:t,dispatch:n,chain:i})=>{const o=rt(r,t.schema);return o.isTextblock?i().command(({commands:l})=>vi(o,e)(t)?!0:l.clearNodes()).command(({state:l})=>vi(o,e)(l,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Wa=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,i=nn(r,0,n.content.size),o=$e.create(n,i);e.setSelection(o)}return!0},Ja=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,{from:i,to:o}=typeof r=="number"?{from:r,to:r}:r,l=De.atStart(n).from,s=De.atEnd(n).to,a=nn(i,l,s),f=nn(o,l,s),c=De.create(n,a,f);e.setSelection(c)}return!0},Ha=r=>({state:e,dispatch:t})=>{const n=rt(r,e.schema);return qs(n)(e,t)};function Mi(r,e){const t=r.storedMarks||r.selection.$to.parentOffset&&r.selection.$from.marks();if(t){const n=t.filter(i=>e==null?void 0:e.includes(i.type.name));r.tr.ensureMarks(n)}}const Ua=({keepMarks:r=!0}={})=>({tr:e,state:t,dispatch:n,editor:i})=>{const{selection:o,doc:l}=e,{$from:s,$to:a}=o,f=i.extensionManager.attributes,c=Kn(f,s.node().type.name,s.node().attrs);if(o instanceof $e&&o.node.isBlock)return!s.parentOffset||!pn(l,s.pos)?!1:(n&&(r&&Mi(t,i.extensionManager.splittableMarks),e.split(s.pos).scrollIntoView()),!0);if(!s.parent.isBlock)return!1;if(n){const d=a.parentOffset===a.parent.content.size;o instanceof De&&e.deleteSelection();const p=s.depth===0?void 0:Da(s.node(-1).contentMatchAt(s.indexAfter(-1)));let m=d&&p?[{type:p,attrs:c}]:void 0,h=pn(e.doc,e.mapping.map(s.pos),1,m);if(!m&&!h&&pn(e.doc,e.mapping.map(s.pos),1,p?[{type:p}]:void 0)&&(h=!0,m=p?[{type:p,attrs:c}]:void 0),h&&(e.split(e.mapping.map(s.pos),1,m),p&&!d&&!s.parentOffset&&s.parent.type!==p)){const b=e.mapping.map(s.before()),k=e.doc.resolve(b);s.node(-1).canReplaceWith(k.index(),k.index()+1,p)&&e.setNodeMarkup(e.mapping.map(s.before()),p)}r&&Mi(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0},Ga=r=>({tr:e,state:t,dispatch:n,editor:i})=>{var o;const l=rt(r,t.schema),{$from:s,$to:a}=t.selection,f=t.selection.node;if(f&&f.isBlock||s.depth<2||!s.sameParent(a))return!1;const c=s.node(-1);if(c.type!==l)return!1;const d=i.extensionManager.attributes;if(s.parent.content.size===0&&s.node(-1).childCount===s.indexAfter(-1)){if(s.depth===2||s.node(-3).type!==l||s.index(-2)!==s.node(-2).childCount-1)return!1;if(n){let k=ee.empty;const S=s.index(-1)?1:s.index(-2)?2:3;for(let H=s.depth-S;H>=s.depth-3;H-=1)k=ee.from(s.node(H).copy(k));const O=s.indexAfter(-1)<s.node(-2).childCount?1:s.indexAfter(-2)<s.node(-3).childCount?2:3,$=Kn(d,s.node().type.name,s.node().attrs),F=((o=l.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill($))||void 0;k=k.append(ee.from(l.createAndFill(null,F)||void 0));const A=s.before(s.depth-(S-1));e.replace(A,s.after(-O),new se(k,4-S,0));let R=-1;e.doc.nodesBetween(A,e.doc.content.size,(H,j)=>{if(R>-1)return!1;H.isTextblock&&H.content.size===0&&(R=j+1)}),R>-1&&e.setSelection(De.near(e.doc.resolve(R))),e.scrollIntoView()}return!0}const p=a.pos===s.end()?c.contentMatchAt(0).defaultType:null,m=Kn(d,c.type.name,c.attrs),h=Kn(d,s.node().type.name,s.node().attrs);e.delete(s.pos,a.pos);const b=p?[{type:l,attrs:m},{type:p,attrs:h}]:[{type:l,attrs:m}];if(!pn(e.doc,s.pos,2))return!1;if(n){const{selection:k,storedMarks:S}=t,{splittableMarks:O}=i.extensionManager,$=S||k.$to.parentOffset&&k.$from.marks();if(e.split(s.pos,2,b).scrollIntoView(),!$||!n)return!0;const F=$.filter(A=>O.includes(A.type.name));e.ensureMarks(F)}return!0},kr=(r,e)=>{const t=Dr(l=>l.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(n===void 0)return!0;const i=r.doc.nodeAt(n);return t.node.type===(i==null?void 0:i.type)&&ln(r.doc,t.pos)&&r.join(t.pos),!0},yr=(r,e)=>{const t=Dr(l=>l.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(t.start).after(t.depth);if(n===void 0)return!0;const i=r.doc.nodeAt(n);return t.node.type===(i==null?void 0:i.type)&&ln(r.doc,n)&&r.join(n),!0},Ka=(r,e,t,n={})=>({editor:i,tr:o,state:l,dispatch:s,chain:a,commands:f,can:c})=>{const{extensions:d,splittableMarks:p}=i.extensionManager,m=rt(r,l.schema),h=rt(e,l.schema),{selection:b,storedMarks:k}=l,{$from:S,$to:O}=b,$=S.blockRange(O),F=k||b.$to.parentOffset&&b.$from.marks();if(!$)return!1;const A=Dr(R=>Oi(R.type.name,d))(b);if($.depth>=1&&A&&$.depth-A.depth<=1){if(A.node.type===m)return f.liftListItem(h);if(Oi(A.node.type.name,d)&&m.validContent(A.node.content)&&s)return a().command(()=>(o.setNodeMarkup(A.pos,m),!0)).command(()=>kr(o,m)).command(()=>yr(o,m)).run()}return!t||!F||!s?a().command(()=>c().wrapInList(m,n)?!0:f.clearNodes()).wrapInList(m,n).command(()=>kr(o,m)).command(()=>yr(o,m)).run():a().command(()=>{const R=c().wrapInList(m,n),H=F.filter(j=>p.includes(j.type.name));return o.ensureMarks(H),R?!0:f.clearNodes()}).wrapInList(m,n).command(()=>kr(o,m)).command(()=>yr(o,m)).run()},Qa=(r,e={},t={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,l=Gt(r,n.schema);return Ra(n,l,e)?i.unsetMark(l,{extendEmptyMarkRange:o}):i.setMark(l,e)},Za=(r,e,t={})=>({state:n,commands:i})=>{const o=rt(r,n.schema),l=rt(e,n.schema);return Ar(n,o,t)?i.setNode(l):i.setNode(o,t)},Xa=(r,e={})=>({state:t,commands:n})=>{const i=rt(r,t.schema);return Ar(t,i,e)?n.lift(i):n.wrapIn(i,e)},Ya=()=>({state:r,dispatch:e})=>{const t=r.plugins;for(let n=0;n<t.length;n+=1){const i=t[n];let o;if(i.spec.isInputRules&&(o=i.getState(r))){if(e){const l=r.tr,s=o.transform;for(let a=s.steps.length-1;a>=0;a-=1)l.step(s.steps[a].invert(s.docs[a]));if(o.text){const a=l.doc.resolve(o.from).marks();l.replaceWith(o.from,o.to,r.schema.text(o.text,a))}else l.delete(o.from,o.to)}return!0}}return!1},xa=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,{empty:n,ranges:i}=t;return n||e&&i.forEach(o=>{r.removeMark(o.$from.pos,o.$to.pos)}),!0},ef=(r,e={})=>({tr:t,state:n,dispatch:i})=>{var o;const{extendEmptyMarkRange:l=!1}=e,{selection:s}=t,a=Gt(r,n.schema),{$from:f,empty:c,ranges:d}=s;if(!i)return!0;if(c&&l){let{from:p,to:m}=s;const h=(o=f.marks().find(k=>k.type===a))===null||o===void 0?void 0:o.attrs,b=Xl(f,a,h);b&&(p=b.from,m=b.to),t.removeMark(p,m,a)}else d.forEach(p=>{t.removeMark(p.$from.pos,p.$to.pos,a)});return t.removeStoredMark(a),!0},tf=(r,e={})=>({tr:t,state:n,dispatch:i})=>{let o=null,l=null;const s=eo(typeof r=="string"?r:r.name,n.schema);return s?(s==="node"&&(o=rt(r,n.schema)),s==="mark"&&(l=Gt(r,n.schema)),i&&t.selection.ranges.forEach(a=>{const f=a.$from.pos,c=a.$to.pos;n.doc.nodesBetween(f,c,(d,p)=>{o&&o===d.type&&t.setNodeMarkup(p,void 0,{...d.attrs,...e}),l&&d.marks.length&&d.marks.forEach(m=>{if(l===m.type){const h=Math.max(p,f),b=Math.min(p+d.nodeSize,c);t.addMark(h,b,l.create({...m.attrs,...e}))}})})}),!0):!1},nf=(r,e={})=>({state:t,dispatch:n})=>{const i=rt(r,t.schema);return As(i,e)(t,n)},rf=(r,e={})=>({state:t,dispatch:n})=>{const i=rt(r,t.schema);return Ds(i,e)(t,n)};var lf=Object.freeze({__proto__:null,blur:Ks,clearContent:Qs,clearNodes:Zs,command:Xs,createParagraphNear:Ys,deleteCurrentNode:xs,deleteNode:ea,deleteRange:ta,deleteSelection:na,enter:ra,exitCode:ia,extendMarkRange:oa,first:sa,focus:fa,forEach:ca,insertContent:ua,insertContentAt:ma,joinUp:ha,joinDown:ga,joinBackward:_a,joinForward:ba,keyboardShortcut:ka,lift:ya,liftEmptyBlock:va,liftListItem:Sa,newlineInCode:Ca,resetAttributes:Oa,scrollIntoView:Ma,selectAll:Ia,selectNodeBackward:$a,selectNodeForward:Ea,selectParentNode:Na,selectTextblockEnd:Ba,selectTextblockStart:Fa,setContent:Aa,setMark:qa,setMeta:Va,setNode:ja,setNodeSelection:Wa,setTextSelection:Ja,sinkListItem:Ha,splitBlock:Ua,splitListItem:Ga,toggleList:Ka,toggleMark:Qa,toggleNode:Za,toggleWrap:Xa,undoInputRule:Ya,unsetAllMarks:xa,unsetMark:ef,updateAttributes:tf,wrapIn:nf,wrapInList:rf});Et.create({name:"commands",addCommands(){return{...lf}}});Et.create({name:"editable",addProseMirrorPlugins(){return[new Dn({key:new Pn("editable"),props:{editable:()=>this.editor.options.editable}})]}});Et.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:r}=this;return[new Dn({key:new Pn("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{r.isFocused=!0;const n=r.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,t)=>{r.isFocused=!1;const n=r.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}});Et.create({name:"keymap",addKeyboardShortcuts(){const r=()=>this.editor.commands.first(({commands:l})=>[()=>l.undoInputRule(),()=>l.command(({tr:s})=>{const{selection:a,doc:f}=s,{empty:c,$anchor:d}=a,{pos:p,parent:m}=d,h=ve.atStart(f).from===p;return!c||!h||!m.type.isTextblock||m.textContent.length?!1:l.clearNodes()}),()=>l.deleteSelection(),()=>l.joinBackward(),()=>l.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:l})=>[()=>l.deleteSelection(),()=>l.deleteCurrentNode(),()=>l.joinForward(),()=>l.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:l})=>[()=>l.newlineInCode(),()=>l.createParagraphNear(),()=>l.liftEmptyBlock(),()=>l.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:r,"Mod-Backspace":r,"Shift-Backspace":r,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},o={...n,"Ctrl-h":r,"Alt-Backspace":r,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Tr()||xl()?o:i},addProseMirrorPlugins(){return[new Dn({key:new Pn("clearDocument"),appendTransaction:(r,e,t)=>{if(!(r.some(h=>h.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:i,from:o,to:l}=e.selection,s=ve.atStart(e.doc).from,a=ve.atEnd(e.doc).to;if(i||!(o===s&&l===a)||!(t.doc.textBetween(0,t.doc.content.size," "," ").length===0))return;const d=t.tr,p=Zl({state:t,transaction:d}),{commands:m}=new Vs({editor:this.editor,state:p});if(m.clearNodes(),!!d.steps.length)return d}})]}});Et.create({name:"tabindex",addProseMirrorPlugins(){return[new Dn({key:new Pn("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});function Ii(r,e,t){const n=r.slice();return n[26]=e[t],n[27]=e,n[28]=t,n}function $i(r){let e,t;return e=new Ye({props:{outline:!0,class:"font-weight-normal",label:r[8]?"เพิ่มรายการอื่นๆ":"เพิ่มรายการจากคลัง",icon:"ic-add"}}),e.$on("click",r[13]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i&256&&(o.label=n[8]?"เพิ่มรายการอื่นๆ":"เพิ่มรายการจากคลัง"),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function Ei(r){let e;return{c(){e=g("th"),e.innerHTML="Stock<br/>On<br/>Hand",v(e,"class","_large svelte-l6o0zf")},m(t,n){P(t,e,n)},d(t){t&&z(e)}}}function Ni(r){let e;return{c(){e=g("th"),e.innerHTML="จ่ายจริง<br/>(R. Qty)",v(e,"class","_large svelte-l6o0zf")},m(t,n){P(t,e,n)},d(t){t&&z(e)}}}function Bi(r){let e;return{c(){e=g("th"),v(e,"class","_small svelte-l6o0zf")},m(t,n){P(t,e,n)},d(t){t&&z(e)}}}function Fi(r){let e;return{c(){e=g("th"),e.innerHTML="ราคารวม<br/>(Total)",v(e,"class","_large svelte-l6o0zf")},m(t,n){P(t,e,n)},d(t){t&&z(e)}}}function Ti(r){let e=[],t=new Map,n,i,o=r[0];const l=s=>s[26].no;for(let s=0;s<o.length;s+=1){let a=Ii(r,o,s),f=l(a);t.set(f,e[s]=Ri(f,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();n=wn()},m(s,a){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(s,a);P(s,n,a),i=!0},p(s,a){a&8095&&(o=s[0],de(),e=mo(e,a,l,1,s,o,t,n.parentNode,ho,Ri,n,Ii),pe())},i(s){if(!i){for(let a=0;a<o.length;a+=1)_(e[a]);i=!0}},o(s){for(let a=0;a<e.length;a+=1)C(e[a]);i=!1},d(s){for(let a=0;a<e.length;a+=1)e[a].d(s);s&&z(n)}}}function of(r){let e;return{c(){e=G("-")},m(t,n){P(t,e,n)},p:Ee,i:Ee,o:Ee,d(t){t&&z(e)}}}function sf(r){let e=r[26].stationaryId+"",t;return{c(){t=G(e)},m(n,i){P(n,t,i)},p(n,i){i&1&&e!==(e=n[26].stationaryId+"")&&le(t,e)},i:Ee,o:Ee,d(n){n&&z(t)}}}function af(r){let e,t;function n(...i){return r[14](r[28],...i)}return e=new Xo({props:{withdrawFrom:r[7],value:r[26].stationaryId?{stationaryId:r[26].stationaryId}:null,clearable:!!r[1][r[28]]}}),e.$on("change",n),{c(){L(e.$$.fragment)},m(i,o){q(e,i,o),t=!0},p(i,o){r=i;const l={};o&128&&(l.withdrawFrom=r[7]),o&1&&(l.value=r[26].stationaryId?{stationaryId:r[26].stationaryId}:null),o&3&&(l.clearable=!!r[1][r[28]]),e.$set(l)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){C(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function ff(r){let e;return{c(){e=g("span"),e.innerHTML='<i class="ic ic-photo"></i>',v(e,"class","text-size-xlarge text-gray-700")},m(t,n){P(t,e,n)},p:Ee,d(t){t&&z(e)}}}function cf(r){let e,t;return{c(){var n,i;e=g("img"),hn(e.src,t=(i=(n=r[26].attachmentFiles)==null?void 0:n[0])==null?void 0:i.url)||v(e,"src",t),v(e,"alt","preview")},m(n,i){P(n,e,i)},p(n,i){var o,l;i&1&&!hn(e.src,t=(l=(o=n[26].attachmentFiles)==null?void 0:o[0])==null?void 0:l.url)&&v(e,"src",t)},d(n){n&&z(e)}}}function uf(r){let e,t;return{c(){e=g("img"),hn(e.src,t=r[26].imageSrc)||v(e,"src",t),v(e,"alt","preview")},m(n,i){P(n,e,i)},p(n,i){i&1&&!hn(e.src,t=n[26].imageSrc)&&v(e,"src",t)},d(n){n&&z(e)}}}function Ai(r){let e,t=Je(r[26].stockOnHand)+"",n;return{c(){e=g("td"),n=G(t),v(e,"class","svelte-l6o0zf")},m(i,o){P(i,e,o),u(e,n)},p(i,o){o&1&&t!==(t=Je(i[26].stockOnHand)+"")&&le(n,t)},d(i){i&&z(e)}}}function Di(r){let e,t,n,i;function o(a){r[17](a,r[26])}function l(){return r[18](r[28])}let s={canEdit:r[3],max:r[8]&&!r[26].stationaryId?1e6:r[26].stockOnHand};return r[26].actualWithdraw!==void 0&&(s.value=r[26].actualWithdraw),t=new Ml({props:s}),fe.push(()=>we(t,"value",o)),t.$on("change",l),{c(){e=g("td"),L(t.$$.fragment),v(e,"class","svelte-l6o0zf")},m(a,f){P(a,e,f),q(t,e,null),i=!0},p(a,f){r=a;const c={};f&8&&(c.canEdit=r[3]),f&257&&(c.max=r[8]&&!r[26].stationaryId?1e6:r[26].stockOnHand),!n&&f&1&&(n=!0,c.value=r[26].actualWithdraw,ke(()=>n=!1)),t.$set(c)},i(a){i||(_(t.$$.fragment,a),i=!0)},o(a){C(t.$$.fragment,a),i=!1},d(a){a&&z(e),V(t)}}}function df(r){let e;return{c(){e=G("-")},m(t,n){P(t,e,n)},p:Ee,i:Ee,o:Ee,d(t){t&&z(e)}}}function pf(r){let e=Je(r[26].pricePerUnit,2)+"",t;return{c(){t=G(e)},m(n,i){P(n,t,i)},p(n,i){i&1&&e!==(e=Je(n[26].pricePerUnit,2)+"")&&le(t,e)},i:Ee,o:Ee,d(n){n&&z(t)}}}function mf(r){let e,t,n;function i(s){r[19](s,r[26])}function o(){return r[20](r[28])}let l={name:"pricePerUnit",digits:2};return r[26].pricePerUnit!==void 0&&(l.value=r[26].pricePerUnit),e=new Cl({props:l}),fe.push(()=>we(e,"value",i)),e.$on("change",o),{c(){L(e.$$.fragment)},m(s,a){q(e,s,a),n=!0},p(s,a){r=s;const f={};!t&&a&1&&(t=!0,f.value=r[26].pricePerUnit,ke(()=>t=!1)),e.$set(f)},i(s){n||(_(e.$$.fragment,s),n=!0)},o(s){C(e.$$.fragment,s),n=!1},d(s){V(e,s)}}}function Pi(r){let e,t,n,i;function o(){return r[21](r[28])}return{c(){e=g("td"),t=g("span"),t.innerHTML='<i class="ic ic-delete"></i>',v(t,"class","icon is-medium text-primary cursor-pointer tooltip"),v(t,"data-tip","Delete"),v(e,"class","text-center svelte-l6o0zf")},m(l,s){P(l,e,s),u(e,t),n||(i=bt(t,"click",o),n=!0)},p(l,s){r=l},d(l){l&&z(e),n=!1,i()}}}function zi(r){let e,t=Je(r[26].totalPrice,2)+"",n;return{c(){e=g("td"),n=G(t),v(e,"class","svelte-l6o0zf")},m(i,o){P(i,e,o),u(e,n)},p(i,o){o&1&&t!==(t=Je(i[26].totalPrice,2)+"")&&le(n,t)},d(i){i&&z(e)}}}function Ri(r,e){let t,n,i=e[26].no+"",o,l,s,a,f,c,d,p,m,h,b=e[26].name+"",k,S,O,$,F,A,R,H,j,Q=e[26].unit+"",ne,K,X,E,I,B,re,Y,te,ae,x;const U=[af,sf,of],W=[];function Oe(ce,ie){return ce[3]&&ce[8]?0:ce[26].stationaryId?1:2}a=Oe(e),f=W[a]=U[a](e);function D(ce,ie){var Pe,N;return ce[26].imageSrc?uf:(N=(Pe=ce[26].attachmentFiles)==null?void 0:Pe[0])!=null&&N.url?cf:ff}let ue=D(e),_e=ue(e);function xe(){return e[15](e[26])}let ge=!e[8]&&Ai(e);function nt(ce){e[16](ce,e[26])}let Me={canEdit:e[2],max:e[8]?1e6:e[26].stockOnHand};e[26].quantity!==void 0&&(Me.value=e[26].quantity),F=new Ml({props:Me}),fe.push(()=>we(F,"value",nt));let oe=e[4]&&Di(e);const qe=[mf,pf,df],Ne=[];function et(ce,ie){return ce[3]&&ce[8]?0:ce[26].pricePerUnit?1:2}E=et(e),I=Ne[E]=qe[E](e);let ye=e[2]&&Pi(e),be=e[4]&&zi(e);return{key:r,first:null,c(){var ce,ie;t=g("tr"),n=g("td"),o=G(i),l=M(),s=g("td"),f.c(),c=M(),d=g("td"),p=g("figure"),_e.c(),m=M(),h=g("td"),k=G(b),S=M(),ge&&ge.c(),O=M(),$=g("td"),L(F.$$.fragment),R=M(),oe&&oe.c(),H=M(),j=g("td"),ne=G(Q),K=M(),X=g("td"),I.c(),B=M(),ye&&ye.c(),re=M(),be&&be.c(),Y=M(),v(n,"class","text-center svelte-l6o0zf"),v(s,"class","svelte-l6o0zf"),v(p,"class","h-6 w-6 flex items-center justify-center border border-gray-400 mx-auto"),he(p,"cursor-pointer",e[26].imageSrc||((ie=(ce=e[26].attachmentFiles)==null?void 0:ce[0])==null?void 0:ie.url)),v(d,"class","svelte-l6o0zf"),v(h,"class","svelte-l6o0zf"),v($,"class","svelte-l6o0zf"),v(j,"class","svelte-l6o0zf"),v(X,"class","svelte-l6o0zf"),this.first=t},m(ce,ie){P(ce,t,ie),u(t,n),u(n,o),u(t,l),u(t,s),W[a].m(s,null),u(t,c),u(t,d),u(d,p),_e.m(p,null),u(t,m),u(t,h),u(h,k),u(t,S),ge&&ge.m(t,null),u(t,O),u(t,$),q(F,$,null),u(t,R),oe&&oe.m(t,null),u(t,H),u(t,j),u(j,ne),u(t,K),u(t,X),Ne[E].m(X,null),u(t,B),ye&&ye.m(t,null),u(t,re),be&&be.m(t,null),u(t,Y),te=!0,ae||(x=bt(p,"click",xe),ae=!0)},p(ce,ie){var Be,ze;e=ce,(!te||ie&1)&&i!==(i=e[26].no+"")&&le(o,i);let Pe=a;a=Oe(e),a===Pe?W[a].p(e,ie):(de(),C(W[Pe],1,1,()=>{W[Pe]=null}),pe(),f=W[a],f?f.p(e,ie):(f=W[a]=U[a](e),f.c()),_(f,1),f.m(s,null)),ue===(ue=D(e))&&_e?_e.p(e,ie):(_e.d(1),_e=ue(e),_e&&(_e.c(),_e.m(p,null))),(!te||ie&1)&&he(p,"cursor-pointer",e[26].imageSrc||((ze=(Be=e[26].attachmentFiles)==null?void 0:Be[0])==null?void 0:ze.url)),(!te||ie&1)&&b!==(b=e[26].name+"")&&le(k,b),e[8]?ge&&(ge.d(1),ge=null):ge?ge.p(e,ie):(ge=Ai(e),ge.c(),ge.m(t,O));const N={};ie&4&&(N.canEdit=e[2]),ie&257&&(N.max=e[8]?1e6:e[26].stockOnHand),!A&&ie&1&&(A=!0,N.value=e[26].quantity,ke(()=>A=!1)),F.$set(N),e[4]?oe?(oe.p(e,ie),ie&16&&_(oe,1)):(oe=Di(e),oe.c(),_(oe,1),oe.m(t,H)):oe&&(de(),C(oe,1,1,()=>{oe=null}),pe()),(!te||ie&1)&&Q!==(Q=e[26].unit+"")&&le(ne,Q);let J=E;E=et(e),E===J?Ne[E].p(e,ie):(de(),C(Ne[J],1,1,()=>{Ne[J]=null}),pe(),I=Ne[E],I?I.p(e,ie):(I=Ne[E]=qe[E](e),I.c()),_(I,1),I.m(X,null)),e[2]?ye?ye.p(e,ie):(ye=Pi(e),ye.c(),ye.m(t,re)):ye&&(ye.d(1),ye=null),e[4]?be?be.p(e,ie):(be=zi(e),be.c(),be.m(t,Y)):be&&(be.d(1),be=null)},i(ce){te||(_(f),_(F.$$.fragment,ce),_(oe),_(I),te=!0)},o(ce){C(f),C(F.$$.fragment,ce),C(oe),C(I),te=!1},d(ce){ce&&z(t),W[a].d(),_e.d(),ge&&ge.d(),V(F),oe&&oe.d(),Ne[E].d(),ye&&ye.d(),be&&be.d(),ae=!1,x()}}}function hf(r){let e,t,n=r[8]?"รายการขอเบิกอุปกรณ์(อื่นๆ)":"รายการขอเบิกอุปกรณ์ในคลัง",i,o,l,s,a,f,c,d,p,m,h,b,k,S,O,$,F,A,R,H,j,Q,ne,K,X,E,I,B=r[2]&&$i(r),re=!r[8]&&Ei(),Y=r[4]&&Ni(),te=r[2]&&Bi(),ae=r[4]&&Fi(),x=r[0]&&Ti(r);return{c(){e=g("div"),t=g("div"),i=G(n),o=M(),B&&B.c(),l=M(),s=g("div"),a=g("table"),f=g("thead"),c=g("tr"),d=g("th"),d.textContent="No",p=M(),m=g("th"),m.innerHTML="รหัสวัสดุ<br/>(Code)",h=M(),b=g("th"),b.innerHTML="รูป<br/>(Img)",k=M(),S=g("th"),S.innerHTML="รายการวัสดุ<br/>(Description)",O=M(),re&&re.c(),$=M(),F=g("th"),F.innerHTML="จำนวน<br/>(Qty)",A=M(),Y&&Y.c(),R=M(),H=g("th"),H.innerHTML="หน่วย<br/>(Unit)",j=M(),Q=g("th"),Q.innerHTML="ราคา/หน่วย<br/>(Price)",ne=M(),te&&te.c(),K=M(),ae&&ae.c(),X=M(),E=g("tbody"),x&&x.c(),v(t,"class","font-weight-bold"),v(e,"class","flex items-center justify-between mb-2"),v(d,"class","_small svelte-l6o0zf"),v(m,"class","_large svelte-l6o0zf"),v(b,"class","_img svelte-l6o0zf"),v(S,"class","svelte-l6o0zf"),v(F,"class","_large svelte-l6o0zf"),v(H,"class","_large svelte-l6o0zf"),v(Q,"class","_large svelte-l6o0zf"),v(a,"class","table w-full svelte-l6o0zf"),he(a,"_pdf",r[5]),v(s,"class","overflow-auto"),he(s,"mb-1",r[4]),he(s,"mb-3",!r[4])},m(U,W){P(U,e,W),u(e,t),u(t,i),u(e,o),B&&B.m(e,null),P(U,l,W),P(U,s,W),u(s,a),u(a,f),u(f,c),u(c,d),u(c,p),u(c,m),u(c,h),u(c,b),u(c,k),u(c,S),u(c,O),re&&re.m(c,null),u(c,$),u(c,F),u(c,A),Y&&Y.m(c,null),u(c,R),u(c,H),u(c,j),u(c,Q),u(c,ne),te&&te.m(c,null),u(c,K),ae&&ae.m(c,null),u(a,X),u(a,E),x&&x.m(E,null),I=!0},p(U,[W]){(!I||W&256)&&n!==(n=U[8]?"รายการขอเบิกอุปกรณ์(อื่นๆ)":"รายการขอเบิกอุปกรณ์ในคลัง")&&le(i,n),U[2]?B?(B.p(U,W),W&4&&_(B,1)):(B=$i(U),B.c(),_(B,1),B.m(e,null)):B&&(de(),C(B,1,1,()=>{B=null}),pe()),U[8]?re&&(re.d(1),re=null):re||(re=Ei(),re.c(),re.m(c,$)),U[4]?Y||(Y=Ni(),Y.c(),Y.m(c,R)):Y&&(Y.d(1),Y=null),U[2]?te||(te=Bi(),te.c(),te.m(c,K)):te&&(te.d(1),te=null),U[4]?ae||(ae=Fi(),ae.c(),ae.m(c,null)):ae&&(ae.d(1),ae=null),U[0]?x?(x.p(U,W),W&1&&_(x,1)):(x=Ti(U),x.c(),_(x,1),x.m(E,null)):x&&(de(),C(x,1,1,()=>{x=null}),pe()),(!I||W&32)&&he(a,"_pdf",U[5]),(!I||W&16)&&he(s,"mb-1",U[4]),(!I||W&16)&&he(s,"mb-3",!U[4])},i(U){I||(_(B),_(x),I=!0)},o(U){C(B),C(x),I=!1},d(U){U&&z(e),B&&B.d(),U&&z(l),U&&z(s),re&&re.d(),Y&&Y.d(),te&&te.d(),ae&&ae.d(),x&&x.d()}}}function gf(r,e,t){let{canSave:n}=e,{canSaveComplete:i}=e,{showCompleteForm:o}=e,{isPdfGenerating:l}=e,{items:s}=e,{addItemModal:a}=e,{withdrawFrom:f}=e,{isOther:c=!1}=e,{cacheWithdrawOther:d={}}=e;const p=mn(),m=E=>p("totalChange",E),h=mn(),b=E=>h("preview",E);function k(E){t(0,s=s.filter((I,B)=>B!==E).map((I,B)=>({...I,no:B+1})))}function S(E,I=void 0){const B=s[E];I=I??B.actualWithdraw,t(0,s[E]={...B,totalPrice:I*(B.pricePerUnit??0)},s),O()}function O(){const E=s.reduce((I,B)=>I+B.totalPrice,0);m(E)}function $({detail:E},I){const B=s[I];E?(B.stationaryId||t(1,d[I]=Fr({},B),d),t(0,s[I]={...B,stationaryId:E.stationaryId,attachmentFiles:E.attachmentFiles,name:E.stationaryName,stockOnHand:E.stockOnHand,unit:E.unit,pricePerUnit:E.price,actualWithdraw:B.actualWithdraw>E.stockOnHand?E.stockOnHand:B.actualWithdraw},s)):d[I]&&t(0,s[I]={...B,attachmentFiles:d[I].attachmentFiles,name:d[I].name,stockOnHand:0,unit:d[I].unit,pricePerUnit:d[I].pricePerUnit},s),S(I)}const F=()=>{f!=null&&f.key?a.open(c):je.error("โปรดระบุคลังก่อนทำการเพิ่มรายการ")},A=(E,I)=>$(I,E),R=E=>{var I,B;(E.imageSrc||(B=(I=E.attachmentFiles)==null?void 0:I[0])!=null&&B.url)&&b(E)};function H(E,I){r.$$.not_equal(I.quantity,E)&&(I.quantity=E,t(0,s))}function j(E,I){r.$$.not_equal(I.actualWithdraw,E)&&(I.actualWithdraw=E,t(0,s))}const Q=E=>{S(E)};function ne(E,I){r.$$.not_equal(I.pricePerUnit,E)&&(I.pricePerUnit=E,t(0,s))}const K=E=>{S(E)},X=E=>k(E);return r.$$set=E=>{"canSave"in E&&t(2,n=E.canSave),"canSaveComplete"in E&&t(3,i=E.canSaveComplete),"showCompleteForm"in E&&t(4,o=E.showCompleteForm),"isPdfGenerating"in E&&t(5,l=E.isPdfGenerating),"items"in E&&t(0,s=E.items),"addItemModal"in E&&t(6,a=E.addItemModal),"withdrawFrom"in E&&t(7,f=E.withdrawFrom),"isOther"in E&&t(8,c=E.isOther),"cacheWithdrawOther"in E&&t(1,d=E.cacheWithdrawOther)},[s,d,n,i,o,l,a,f,c,b,k,S,$,F,A,R,H,j,Q,ne,K,X]}class Li extends Wt{constructor(e){super(),Jt(this,e,gf,hf,Ht,{canSave:2,canSaveComplete:3,showCompleteForm:4,isPdfGenerating:5,items:0,addItemModal:6,withdrawFrom:7,isOther:8,cacheWithdrawOther:1})}}function qi(r,e,t){const n=r.slice();return n[37]=e[t],n}function Vi(r){let e,t,n;function i(l){r[21](l)}let o={isForm:!0,labelClass:"text-black",name:"itemType",value:r[37].value,label:r[37].label};return r[6]!==void 0&&(o.group=r[6]),e=new gn({props:o}),fe.push(()=>we(e,"group",i)),e.$on("change",r[13]),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};!t&&s[0]&64&&(t=!0,a.group=l[6],ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function _f(r){let e,t,n,i,o,l,s,a,f,c,d;function p(b){r[27](b)}let m={placeholder:"ID/Name"};r[5].id!==void 0&&(m.value=r[5].id),n=new _n({props:m}),fe.push(()=>we(n,"value",p)),n.$on("input",r[10]);let h={tableConfig:r[12]};return c=new To({props:h}),r[28](c),{c(){e=g("div"),t=g("div"),L(n.$$.fragment),o=M(),l=g("div"),l.innerHTML='<span class="icon"><i class="ic ic-search"></i></span>',s=M(),a=g("div"),a.textContent="รายการขอเบิกอุปกรณ์ในคลัง",f=M(),L(c.$$.fragment),v(l,"class","absolute inset-y-0 right-2 flex items-center pointer-events-none text-primary"),v(t,"class","relative w-[324px] mx-auto mb-2"),v(a,"class","font-weight-bold mb-3"),v(e,"class","max-w-[1032px] mx-auto")},m(b,k){P(b,e,k),u(e,t),q(n,t,null),u(t,o),u(t,l),u(e,s),u(e,a),u(e,f),q(c,e,null),d=!0},p(b,k){const S={};!i&&k[0]&32&&(i=!0,S.value=b[5].id,ke(()=>i=!1)),n.$set(S);const O={};c.$set(O)},i(b){d||(_(n.$$.fragment,b),_(c.$$.fragment,b),d=!0)},o(b){C(n.$$.fragment,b),C(c.$$.fragment,b),d=!1},d(b){b&&z(e),V(n),r[28](null),V(c)}}}function bf(r){var re,Y,te,ae,x,U;let e,t,n,i,o,l,s,a,f,c,d,p,m,h,b,k,S,O,$,F,A;function R(W,Oe){return W[7]?kf:wf}let H=R(r),j=H(r),Q={accept:"image/jpeg,image/png",fileName:(te=(Y=(re=r[2])==null?void 0:re.attachmentFiles)==null?void 0:Y[0])!=null&&te.id?r[8][(U=(x=(ae=r[2])==null?void 0:ae.attachmentFiles)==null?void 0:x[0])==null?void 0:U.id]??"Uploaded Image":void 0,isUploading:r[3]};c=new Ao({props:Q}),r[22](c),c.$on("change",r[14]);function ne(W){r[23](W)}let K={label:"ชื่ออุปกรณ์",required:!0};r[2].name!==void 0&&(K.value=r[2].name),m=new _n({props:K}),fe.push(()=>we(m,"value",ne));function X(W){r[24](W)}let E={digits:0,label:"จำนวนที่เบิก (Qty)",required:!0};r[2].quantity!==void 0&&(E.value=r[2].quantity),k=new Cl({props:E}),fe.push(()=>we(k,"value",X));function I(W){r[25](W)}let B={label:"หน่วย (Unit)",required:!0};return r[2].unit!==void 0&&(B.value=r[2].unit),$=new _n({props:B}),fe.push(()=>we($,"value",I)),$.$on("input",r[26]),$.$on("keypress",If),{c(){e=g("div"),t=g("div"),n=g("div"),i=g("div"),i.innerHTML=`<span>รูปภาพอุปกรณ์</span> 
            <span class="text-required-star mr-1">*</span> 
            <span>(Image File (.JPEG/.PNG))</span>`,o=M(),l=g("div"),s=g("figure"),j.c(),a=M(),f=g("div"),L(c.$$.fragment),d=M(),p=g("div"),L(m.$$.fragment),b=M(),L(k.$$.fragment),O=M(),L($.$$.fragment),v(i,"class","flex text-gray-800 mb-1"),v(s,"class","w-[66px] h-[66px] flex items-center justify-center bg-gray-100 border border-gray-400 mr-3"),v(l,"class","flex items-center"),v(n,"class","col-span-2"),v(p,"class","col-span-2"),v(t,"class","grid gap-2 grid-cols-2"),v(e,"class","max-w-[636px] mx-auto")},m(W,Oe){P(W,e,Oe),u(e,t),u(t,n),u(n,i),u(n,o),u(n,l),u(l,s),j.m(s,null),u(l,a),u(l,f),q(c,f,null),u(t,d),u(t,p),q(m,p,null),u(t,b),q(k,t,null),u(t,O),q($,t,null),A=!0},p(W,Oe){var ge,nt,Me,oe,qe,Ne;H===(H=R(W))&&j?j.p(W,Oe):(j.d(1),j=H(W),j&&(j.c(),j.m(s,null)));const D={};Oe[0]&260&&(D.fileName=(Me=(nt=(ge=W[2])==null?void 0:ge.attachmentFiles)==null?void 0:nt[0])!=null&&Me.id?W[8][(Ne=(qe=(oe=W[2])==null?void 0:oe.attachmentFiles)==null?void 0:qe[0])==null?void 0:Ne.id]??"Uploaded Image":void 0),Oe[0]&8&&(D.isUploading=W[3]),c.$set(D);const ue={};!h&&Oe[0]&4&&(h=!0,ue.value=W[2].name,ke(()=>h=!1)),m.$set(ue);const _e={};!S&&Oe[0]&4&&(S=!0,_e.value=W[2].quantity,ke(()=>S=!1)),k.$set(_e);const xe={};!F&&Oe[0]&4&&(F=!0,xe.value=W[2].unit,ke(()=>F=!1)),$.$set(xe)},i(W){A||(_(c.$$.fragment,W),_(m.$$.fragment,W),_(k.$$.fragment,W),_($.$$.fragment,W),A=!0)},o(W){C(c.$$.fragment,W),C(m.$$.fragment,W),C(k.$$.fragment,W),C($.$$.fragment,W),A=!1},d(W){W&&z(e),j.d(),r[22](null),V(c),V(m),V(k),V($)}}}function wf(r){let e;return{c(){e=g("span"),e.innerHTML='<i class="ic ic-photo"></i>',v(e,"class","text-size-3xlarge text-gray-700")},m(t,n){P(t,e,n)},p:Ee,d(t){t&&z(e)}}}function kf(r){let e,t;return{c(){e=g("img"),hn(e.src,t=r[7])||v(e,"src",t),v(e,"alt","preview")},m(n,i){P(n,e,i)},p(n,i){i[0]&128&&!hn(e.src,t=n[7])&&v(e,"src",t)},d(n){n&&z(e)}}}function yf(r){let e,t,n,i,o,l,s=r[11],a=[];for(let m=0;m<s.length;m+=1)a[m]=Vi(qi(r,s,m));const f=m=>C(a[m],1,1,()=>{a[m]=null}),c=[bf,_f],d=[];function p(m,h){return m[6]==="true"?0:1}return n=p(r),i=d[n]=c[n](r),{c(){e=g("div");for(let m=0;m<a.length;m+=1)a[m].c();t=M(),i.c(),o=wn(),v(e,"class","flex justify-center gap-3 mb-3")},m(m,h){P(m,e,h);for(let b=0;b<a.length;b+=1)a[b]&&a[b].m(e,null);P(m,t,h),d[n].m(m,h),P(m,o,h),l=!0},p(m,h){if(h[0]&10304){s=m[11];let k;for(k=0;k<s.length;k+=1){const S=qi(m,s,k);a[k]?(a[k].p(S,h),_(a[k],1)):(a[k]=Vi(S),a[k].c(),_(a[k],1),a[k].m(e,null))}for(de(),k=s.length;k<a.length;k+=1)f(k);pe()}let b=n;n=p(m),n===b?d[n].p(m,h):(de(),C(d[b],1,1,()=>{d[b]=null}),pe(),i=d[n],i?i.p(m,h):(i=d[n]=c[n](m),i.c()),_(i,1),i.m(o.parentNode,o))},i(m){if(!l){for(let h=0;h<s.length;h+=1)_(a[h]);_(i),l=!0}},o(m){a=a.filter(Boolean);for(let h=0;h<a.length;h+=1)C(a[h]);C(i),l=!1},d(m){m&&z(e),vl(a,m),m&&z(t),d[n].d(m),m&&z(o)}}}function vf(r){let e;return{c(){e=g("div"),e.textContent="เพิ่มรายการเบิกอุปกรณ์",v(e,"slot","title")},m(t,n){P(t,e,n)},p:Ee,d(t){t&&z(e)}}}function Sf(r){let e,t;return e=new Ye({props:{clear:!0,class:"w-[96px]",label:"Close"}}),e.$on("click",r[20]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p:Ee,i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function Cf(r){let e,t,n,i;return e=new Ye({props:{clear:!0,class:"mr-2 w-[96px]",label:"Close"}}),e.$on("click",r[18]),n=new Ye({props:{primary:!0,label:"Add",class:"w-[96px]"}}),n.$on("click",r[19]),{c(){L(e.$$.fragment),t=M(),L(n.$$.fragment)},m(o,l){q(e,o,l),P(o,t,l),q(n,o,l),i=!0},p:Ee,i(o){i||(_(e.$$.fragment,o),_(n.$$.fragment,o),i=!0)},o(o){C(e.$$.fragment,o),C(n.$$.fragment,o),i=!1},d(o){V(e,o),o&&z(t),V(n,o)}}}function Of(r){let e,t,n,i;const o=[Cf,Sf],l=[];function s(a,f){return a[6]==="true"?0:1}return t=s(r),n=l[t]=o[t](r),{c(){e=g("div"),n.c(),v(e,"slot","footer"),v(e,"class","flex")},m(a,f){P(a,e,f),l[t].m(e,null),i=!0},p(a,f){let c=t;t=s(a),t===c?l[t].p(a,f):(de(),C(l[c],1,1,()=>{l[c]=null}),pe(),n=l[t],n?n.p(a,f):(n=l[t]=o[t](a),n.c()),_(n,1),n.m(e,null))},i(a){i||(_(n),i=!0)},o(a){C(n),i=!1},d(a){a&&z(e),l[t].d()}}}function Mf(r){let e,t,n={$$slots:{footer:[Of],title:[vf],default:[yf]},$$scope:{ctx:r}};return e=new er({props:n}),r[29](e),{c(){L(e.$$.fragment)},m(i,o){q(e,i,o),t=!0},p(i,o){const l={};o[0]&511|o[1]&512&&(l.$$scope={dirty:o,ctx:i}),e.$set(l)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){C(e.$$.fragment,i),t=!1},d(i){r[29](null),V(e,i)}}}const If=r=>{/[^\u0E00-\u0E7Fa-zA-Z]/.test(r.key)&&r.preventDefault()};function $f(r,e,t){let n;go(r,_o,D=>t(8,n=D));let{recordId:i}=e,{withdrawFrom:o}=e;const l=mn(),s=D=>l("add",{item:D,isOther:O==="true"}),a=mn(),f=D=>a("preview",D);let c,d,p,m=!1,h,b={id:""},k=null;function S(){k&&clearTimeout(k),k=setTimeout(()=>{R()},400)}let O="false";const $=[{value:"false",label:"ค้นหาจากคลัง"},{value:"true",label:"อื่นๆ"}],F={columns:[{name:"No",prop:"recordId",width:"45px",headerClasses:"text-center",cellClasses:"text-center",cellTemplate:Fo.No,sortable:!1},{name:"เลือก",prop:"recordId",width:"72px",headerClasses:"text-center",cellClasses:"text-center",onClick:(D,ue)=>{console.log("add",ue),s({recordId:ue.recordId,no:null,stationaryId:ue.stationaryId,attachmentFiles:ue.attachmentFiles,name:ue.stationaryName,stockOnHand:ue.stockOnHand,quantity:ue.stockOnHand>0?1:0,unit:ue.unit,pricePerUnit:ue.price,totalPrice:0,actualWithdraw:0})},render:()=>'<span class="icon is-medium text-primary cursor-pointer"><i class="ic ic-add" /></span>',sortable:!1},{name:"รูป (Img)",prop:"attachmentFiles",width:"72px",headerClasses:"text-center",onClick:(D,ue)=>f(ue),render:D=>{var ue;return`<figure class="h-6 w-6 flex items-center justify-center border border-gray-400 mx-auto cursor-pointer">${(ue=D==null?void 0:D[0])!=null&&ue.url?`<img src="${D[0].url}" alt="preview" />`:'<span class="text-size-xlarge text-gray-700"><i class="ic ic-photo" /></span>'}</figure>`},sortable:!1},{name:"รหัสวัสดุ (Code)",prop:"stationaryId",width:"222px",sortable:!1},{name:"รายการวัสดุ (Description)",prop:"stationaryName",width:"222px",sortable:!1},{name:"Stock On Hand",prop:"stockOnHand",width:"144px",render:D=>Je(D),sortable:!1},{name:"หน่วย (Unit)",prop:"unit",width:"126px",sortable:!1},{name:"ราคา/หน่วย (Price)",prop:"price",width:"66px",headerClasses:"text-center",render:D=>Je(D,2),sortable:!1}],getData:async(D,ue)=>{const _e=await Re.GetMasterStationaryList({search:{recordId:"",search:b.id.trim()},serviceFor:o==null?void 0:o.key});return Promise.all([Promise.resolve(_e.length),Promise.resolve(_e)])},isExternalPaging:!1,isStriped:!1};function A(){O==="true"?Q():(t(5,b.id="",b),R())}function R(){d&&d.reload()}let H;function j({detail:{target:D}}){if(!i){je.error("Invalid recordId");return}t(3,m=!0);const ue=D.files[0];bo(Re.UploadFile,ue,i).then(_e=>{t(2,p.attachmentFiles[0]={id:_e,url:""},p),t(7,H=URL.createObjectURL(ue))}).finally(()=>{t(3,m=!1)})}function Q(){t(7,H=""),h==null||h.clearFilename(),t(2,p={...ne}),t(2,p.attachmentFiles=[],p)}const ne={recordId:null,stationaryId:null,attachmentFiles:[],name:"",stockOnHand:0,quantity:1,unit:"",pricePerUnit:0,totalPrice:0,actualWithdraw:0};function K(D){t(6,O=D?"true":"false"),Q(),c.open()}const X=()=>{c.close()},E=()=>{const{isValid:D}=Vo(p);D&&(s({...p,imageSrc:H}),c.close())},I=()=>{c.close()};function B(D){O=D,t(6,O)}function re(D){fe[D?"unshift":"push"](()=>{h=D,t(4,h)})}function Y(D){r.$$.not_equal(p.name,D)&&(p.name=D,t(2,p))}function te(D){r.$$.not_equal(p.quantity,D)&&(p.quantity=D,t(2,p))}function ae(D){r.$$.not_equal(p.unit,D)&&(p.unit=D,t(2,p))}const x=()=>{/[^\u0E00-\u0E7Fa-zA-Z]/.test(p.unit)&&t(2,p.unit=p.unit.replace(/[^\u0E00-\u0E7Fa-zA-Z]/g,""),p)};function U(D){r.$$.not_equal(b.id,D)&&(b.id=D,t(5,b))}function W(D){fe[D?"unshift":"push"](()=>{d=D,t(1,d)})}function Oe(D){fe[D?"unshift":"push"](()=>{c=D,t(0,c)})}return r.$$set=D=>{"recordId"in D&&t(15,i=D.recordId),"withdrawFrom"in D&&t(16,o=D.withdrawFrom)},[c,d,p,m,h,b,O,H,n,s,S,$,F,A,j,i,o,K,X,E,I,B,re,Y,te,ae,x,U,W,Oe]}class Ef extends Wt{constructor(e){super(),Jt(this,e,$f,Mf,Ht,{recordId:15,withdrawFrom:16,open:17},null,[-1,-1])}get open(){return this.$$.ctx[17]}}function Nf(r){let e;return{c(){e=g("div"),e.innerHTML=`<div class="text-size-xlarge text-center"><div class="mb-1">คุณต้องการแก้ไขคลังที่ต้องการเบิกใช่หรือไม่</div> 
      <div class="text-stationery-status-reject">ถ้าใช่รายการขอเบิกอุปกรณ์ในคลังจะถูกยกเลิก</div></div>`,v(e,"class","max-w-[852px] mx-auto")},m(t,n){P(t,e,n)},p:Ee,d(t){t&&z(e)}}}function Bf(r){let e;return{c(){e=g("div"),e.textContent="ยืนยันการแก้ไขคลังที่ต้องการเบิก",v(e,"slot","title")},m(t,n){P(t,e,n)},p:Ee,d(t){t&&z(e)}}}function Ff(r){let e,t,n,i,o;return t=new Ye({props:{class:"mr-2 w-[96px]",label:"ใช่",isLoading:r[1]}}),t.$on("click",r[4]),i=new Ye({props:{primary:!1,cancel:!0,class:"w-[96px]",label:"ไม่",isLoading:r[1]}}),i.$on("click",r[5]),{c(){e=g("div"),L(t.$$.fragment),n=M(),L(i.$$.fragment),v(e,"slot","footer"),v(e,"class","flex")},m(l,s){P(l,e,s),q(t,e,null),u(e,n),q(i,e,null),o=!0},p(l,s){const a={};s&2&&(a.isLoading=l[1]),t.$set(a);const f={};s&2&&(f.isLoading=l[1]),i.$set(f)},i(l){o||(_(t.$$.fragment,l),_(i.$$.fragment,l),o=!0)},o(l){C(t.$$.fragment,l),C(i.$$.fragment,l),o=!1},d(l){l&&z(e),V(t),V(i)}}}function Tf(r){let e,t,n={$$slots:{footer:[Ff],title:[Bf],default:[Nf]},$$scope:{ctx:r}};return e=new er({props:n}),r[6](e),{c(){L(e.$$.fragment)},m(i,o){q(e,i,o),t=!0},p(i,[o]){const l={};o&143&&(l.$$scope={dirty:o,ctx:i}),e.$set(l)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){C(e.$$.fragment,i),t=!1},d(i){r[6](null),V(e,i)}}}function Af(r,e,t){let{isLoading:n=!1}=e,{onConfirm:i}=e,{onCancel:o}=e,{modal:l=void 0}=e;const s=()=>{i()},a=()=>{o(),l.close()};function f(c){fe[c?"unshift":"push"](()=>{l=c,t(0,l)})}return r.$$set=c=>{"isLoading"in c&&t(1,n=c.isLoading),"onConfirm"in c&&t(2,i=c.onConfirm),"onCancel"in c&&t(3,o=c.onCancel),"modal"in c&&t(0,l=c.modal)},[l,n,i,o,s,a,f]}class Df extends Wt{constructor(e){super(),Jt(this,e,Af,Tf,Ht,{isLoading:1,onConfirm:2,onCancel:3,modal:0})}}function ji(r){let e,t,n,i,o,l,s,a,f,c,d,p,m,h,b=(r[0].onBehalfOfEmployeeId??"-")+"",k,S,O,$,F,A,R=(r[0].onBehalfOfEmployeeNameEN??"-")+"",H,j,Q,ne,K,X,E,I=(r[0].onBehalfOfEmail??"-")+"",B,re,Y,te,ae,x,U=(r[0].onBehalfOfPosition??"-")+"",W,Oe,D,ue,_e,xe,ge=(r[0].onBehalfOfUnit??"-")+"",nt,Me,oe,qe,Ne,et,ye=(r[0].onBehalfOfSection??"-")+"",be,ce,ie,Pe,N,J,Be=(r[0].onBehalfOfDepartment??"-")+"",ze,wt,lt,ot,kt,St,tt=(r[0].onBehalfOfFunction??"-")+"",pt,Ae;const yt=[zf,Pf],He=[];function vt(me,Ie){return me[2]?0:1}o=vt(r),l=He[o]=yt[o](r);const Ct=[Lf,Rf],Ve=[];function ht(me,Ie){return me[2]?0:1}a=ht(r),f=Ve[a]=Ct[a](r);let Fe=r[0].onBehalfOfEmployeeName&&Wi(r);return{c(){e=g("div"),t=g("div"),t.textContent="ON BEHALF OF",n=M(),i=g("div"),l.c(),s=M(),f.c(),c=M(),d=g("div"),p=g("span"),p.textContent="Employee ID :",m=M(),h=g("span"),k=G(b),S=M(),O=g("div"),$=g("span"),$.textContent="Employee Name :",F=M(),A=g("span"),H=G(R),j=M(),Fe&&Fe.c(),Q=M(),ne=g("div"),K=g("span"),K.textContent="Email :",X=M(),E=g("span"),B=G(I),re=M(),Y=g("div"),te=g("span"),te.textContent="Position :",ae=M(),x=g("span"),W=G(U),Oe=M(),D=g("div"),ue=g("span"),ue.textContent="Unit :",_e=M(),xe=g("span"),nt=G(ge),Me=M(),oe=g("div"),qe=g("span"),qe.textContent="Section :",Ne=M(),et=g("span"),be=G(ye),ce=M(),ie=g("div"),Pe=g("span"),Pe.textContent="Department :",N=M(),J=g("span"),ze=G(Be),wt=M(),lt=g("div"),ot=g("span"),ot.textContent="Function :",kt=M(),St=g("span"),pt=G(tt),v(t,"class","_title svelte-1v7icv2"),v(p,"class","text-gray-800"),v(d,"class","desktop:col-start-1"),v($,"class","text-gray-800"),v(K,"class","text-gray-800"),v(te,"class","text-gray-800"),v(ue,"class","text-gray-800"),v(qe,"class","text-gray-800"),v(Pe,"class","text-gray-800"),v(ot,"class","text-gray-800"),v(i,"class","grid desktop:grid-cols-3 desktop:gap-x-10 gap-y-2"),v(e,"class","_wrapper _desktop-spacing svelte-1v7icv2"),he(e,"_pdf-generating",r[2])},m(me,Ie){P(me,e,Ie),u(e,t),u(e,n),u(e,i),He[o].m(i,null),u(i,s),Ve[a].m(i,null),u(i,c),u(i,d),u(d,p),u(d,m),u(d,h),u(h,k),u(i,S),u(i,O),u(O,$),u(O,F),u(O,A),u(A,H),u(O,j),Fe&&Fe.m(O,null),u(i,Q),u(i,ne),u(ne,K),u(ne,X),u(ne,E),u(E,B),u(i,re),u(i,Y),u(Y,te),u(Y,ae),u(Y,x),u(x,W),u(i,Oe),u(i,D),u(D,ue),u(D,_e),u(D,xe),u(xe,nt),u(i,Me),u(i,oe),u(oe,qe),u(oe,Ne),u(oe,et),u(et,be),u(i,ce),u(i,ie),u(ie,Pe),u(ie,N),u(ie,J),u(J,ze),u(i,wt),u(i,lt),u(lt,ot),u(lt,kt),u(lt,St),u(St,pt),Ae=!0},p(me,Ie){let It=o;o=vt(me),o===It?He[o].p(me,Ie):(de(),C(He[It],1,1,()=>{He[It]=null}),pe(),l=He[o],l?l.p(me,Ie):(l=He[o]=yt[o](me),l.c()),_(l,1),l.m(i,s));let Nt=a;a=ht(me),a===Nt?Ve[a].p(me,Ie):(de(),C(Ve[Nt],1,1,()=>{Ve[Nt]=null}),pe(),f=Ve[a],f?f.p(me,Ie):(f=Ve[a]=Ct[a](me),f.c()),_(f,1),f.m(i,c)),(!Ae||Ie&1)&&b!==(b=(me[0].onBehalfOfEmployeeId??"-")+"")&&le(k,b),(!Ae||Ie&1)&&R!==(R=(me[0].onBehalfOfEmployeeNameEN??"-")+"")&&le(H,R),me[0].onBehalfOfEmployeeName?Fe?Fe.p(me,Ie):(Fe=Wi(me),Fe.c(),Fe.m(O,null)):Fe&&(Fe.d(1),Fe=null),(!Ae||Ie&1)&&I!==(I=(me[0].onBehalfOfEmail??"-")+"")&&le(B,I),(!Ae||Ie&1)&&U!==(U=(me[0].onBehalfOfPosition??"-")+"")&&le(W,U),(!Ae||Ie&1)&&ge!==(ge=(me[0].onBehalfOfUnit??"-")+"")&&le(nt,ge),(!Ae||Ie&1)&&ye!==(ye=(me[0].onBehalfOfSection??"-")+"")&&le(be,ye),(!Ae||Ie&1)&&Be!==(Be=(me[0].onBehalfOfDepartment??"-")+"")&&le(ze,Be),(!Ae||Ie&1)&&tt!==(tt=(me[0].onBehalfOfFunction??"-")+"")&&le(pt,tt),(!Ae||Ie&4)&&he(e,"_pdf-generating",me[2])},i(me){Ae||(_(l),_(f),Ae=!0)},o(me){C(l),C(f),Ae=!1},d(me){me&&z(e),He[o].d(),Ve[a].d(),Fe&&Fe.d()}}}function Pf(r){let e,t;return e=new Po({props:{isHorizontal:!0,label:"On Behalf of :",service:r[6],value:r[3],clearable:r[0].canSave,disabled:r[1]||!r[0].canSave}}),e.$on("change",r[7]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i&8&&(o.value=n[3]),i&1&&(o.clearable=n[0].canSave),i&3&&(o.disabled=n[1]||!n[0].canSave),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function zf(r){let e,t;return e=new Ut({props:{isHorizontal:!0,label:"On Behalf of :",value:r[3].employeeName}}),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i&8&&(o.value=n[3].employeeName),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function Rf(r){let e,t,n,i;function o(s){r[8](s)}let l={label:"เพื่อโปรดพิจารณาอนุมัติ (Request for Verifying)",isForm:!0,disabled:r[1]||!(r[0].canSave&&r[0].withdrawOthers.length===0)};return r[0].onBehalfOfVerifying!==void 0&&(l.checked=r[0].onBehalfOfVerifying),t=new Do({props:l}),fe.push(()=>we(t,"checked",o)),{c(){e=g("div"),L(t.$$.fragment),v(e,"class","flex items-center")},m(s,a){P(s,e,a),q(t,e,null),i=!0},p(s,a){const f={};a&3&&(f.disabled=s[1]||!(s[0].canSave&&s[0].withdrawOthers.length===0)),!n&&a&1&&(n=!0,f.checked=s[0].onBehalfOfVerifying,ke(()=>n=!1)),t.$set(f)},i(s){i||(_(t.$$.fragment,s),i=!0)},o(s){C(t.$$.fragment,s),i=!1},d(s){s&&z(e),V(t)}}}function Lf(r){let e,t,n,i,o;return{c(){e=g("div"),t=g("input"),i=M(),o=g("span"),o.textContent="เพื่อโปรดพิจารณาอนุมัติ (Request for Verifying)",v(t,"type","checkbox"),v(t,"class","w-[18px] h-[18px]"),t.checked=n=r[0].onBehalfOfVerifying,t.disabled=!0,v(e,"class","flex gap-1 items-center")},m(l,s){P(l,e,s),u(e,t),u(e,i),u(e,o)},p(l,s){s&1&&n!==(n=l[0].onBehalfOfVerifying)&&(t.checked=n)},i:Ee,o:Ee,d(l){l&&z(e)}}}function Wi(r){let e,t,n=r[0].onBehalfOfEmployeeName+"",i,o;return{c(){e=g("span"),t=G("("),i=G(n),o=G(")")},m(l,s){P(l,e,s),u(e,t),u(e,i),u(e,o)},p(l,s){s&1&&n!==(n=l[0].onBehalfOfEmployeeName+"")&&le(i,n)},d(l){l&&z(e)}}}function qf(r){let e,t,n=r[0].isOnBehalf&&ji(r);return{c(){n&&n.c(),e=wn()},m(i,o){n&&n.m(i,o),P(i,e,o),t=!0},p(i,[o]){i[0].isOnBehalf?n?(n.p(i,o),o&1&&_(n,1)):(n=ji(i),n.c(),_(n,1),n.m(e.parentNode,e)):n&&(de(),C(n,1,1,()=>{n=null}),pe())},i(i){t||(_(n),t=!0)},o(i){C(n),t=!1},d(i){n&&n.d(i),i&&z(e)}}}function Vf(r,e,t){let{data:n}=e,{isEdit:i=!1}=e,{isPdfGenerating:o=!1}=e;const l=mn(),s=()=>l("change");let a=null;function f(h){t(3,a=h),h?t(0,n={...n,onBehalfOfId:a.userId,onBehalfOfEmployeeId:a.employeeId,onBehalfOfEmployeeName:a.employeeNameTH,onBehalfOfEmployeeNameEN:a.employeeName,onBehalfOfEmail:a.email,onBehalfOfPosition:a.position,onBehalfOfDepartment:a.department,onBehalfOfUnit:a.unit,onBehalfOfSection:a.section,onBehalfOfFunction:a.function,userManagerId:a.userManagerId,userManagerName:a.userManagerName,onBehalfOfVerifying:n.withdrawOthers.length>0}):c(),s()}function c(){t(3,a=null),t(0,n={...n,onBehalfOfId:null,onBehalfOfEmployeeId:null,onBehalfOfEmployeeName:null,onBehalfOfEmail:null,onBehalfOfPosition:null,onBehalfOfDepartment:null,onBehalfOfUnit:null,onBehalfOfSection:null,onBehalfOfFunction:null,userManagerId:null,userManagerName:null,onBehalfOfVerifying:!1})}const d=h=>Re.SearchUsers({search:{recordId:"",search:h}}),p=({detail:h})=>f(h);function m(h){r.$$.not_equal(n.onBehalfOfVerifying,h)&&(n.onBehalfOfVerifying=h,t(0,n))}return r.$$set=h=>{"data"in h&&t(0,n=h.data),"isEdit"in h&&t(1,i=h.isEdit),"isPdfGenerating"in h&&t(2,o=h.isPdfGenerating)},r.$$.update=()=>{r.$$.dirty&1&&n.onBehalfOfId&&t(3,a={userId:n.onBehalfOfId,employeeId:n.onBehalfOfEmployeeId,employeeName:n.onBehalfOfEmployeeNameEN,employeeNameTH:n.onBehalfOfEmployeeName,email:n.onBehalfOfEmail,position:n.onBehalfOfPosition,department:n.onBehalfOfDepartment,unit:n.onBehalfOfUnit,section:n.onBehalfOfSection,function:n.onBehalfOfFunction,userManagerId:n.userManagerId,userManagerName:n.userManagerName})},[n,i,o,a,f,c,d,p,m]}class jf extends Wt{constructor(e){super(),Jt(this,e,Vf,qf,Ht,{data:0,isEdit:1,isPdfGenerating:2,clearOnBehalfOfEmployee:5})}get clearOnBehalfOfEmployee(){return this.$$.ctx[5]}}function Ji(r){let e,t,n;function i(l){r[12](l)}let o={label:"Remark",labelClass:"text-gray-800",required:!0};return r[5]!==void 0&&(o.value=r[5]),e=new rn({props:o}),fe.push(()=>we(e,"value",i)),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};!t&&s&32&&(t=!0,a.value=l[5],ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function Wf(r){let e,t,n,i,o=r[3]?"accept":"close",l,s,a,f,c,d,p,m,h,b;function k($){r[11]($)}let S={isHorizontal:!0,label:r[3]?"Send Date":"Completed Date",labelClass:"text-gray-800",minDate:r[2],disabledWeekend:!0,required:!0};r[6]!==void 0&&(S.value=r[6]),d=new Ol({props:S}),fe.push(()=>we(d,"value",k));let O=r[3]&&Ji(r);return{c(){e=g("div"),t=g("div"),n=g("span"),i=G("Do you want to "),l=G(o),s=G(" the document?"),a=M(),f=g("div"),c=g("div"),L(d.$$.fragment),h=M(),O&&O.c(),v(t,"class","text-size-xlarge text-center mb-7 desktop:mb-5"),v(c,"class",m=r[3]?"w-[60%]":"w-[276px]"),v(f,"class","space-y-1"),v(e,"class","max-w-[852px] mx-auto")},m($,F){P($,e,F),u(e,t),u(t,n),u(n,i),u(n,l),u(n,s),u(e,a),u(e,f),u(f,c),q(d,c,null),u(f,h),O&&O.m(f,null),b=!0},p($,F){(!b||F&8)&&o!==(o=$[3]?"accept":"close")&&le(l,o);const A={};F&8&&(A.label=$[3]?"Send Date":"Completed Date"),F&4&&(A.minDate=$[2]),!p&&F&64&&(p=!0,A.value=$[6],ke(()=>p=!1)),d.$set(A),(!b||F&8&&m!==(m=$[3]?"w-[60%]":"w-[276px]"))&&v(c,"class",m),$[3]?O?(O.p($,F),F&8&&_(O,1)):(O=Ji($),O.c(),_(O,1),O.m(f,null)):O&&(de(),C(O,1,1,()=>{O=null}),pe())},i($){b||(_(d.$$.fragment,$),_(O),b=!0)},o($){C(d.$$.fragment,$),C(O),b=!1},d($){$&&z(e),V(d),O&&O.d()}}}function Jf(r){let e;return{c(){e=g("div"),e.textContent="Are you Sure?",v(e,"slot","title")},m(t,n){P(t,e,n)},p:Ee,d(t){t&&z(e)}}}function Hf(r){let e,t,n,i,o;return t=new Ye({props:{class:"mr-2 w-[96px]",label:"Yes",isLoading:r[0]}}),t.$on("click",r[9]),i=new Ye({props:{primary:!1,cancel:!0,class:"w-[96px]",label:"No",isLoading:r[0]}}),i.$on("click",r[10]),{c(){e=g("div"),L(t.$$.fragment),n=M(),L(i.$$.fragment),v(e,"slot","footer"),v(e,"class","flex")},m(l,s){P(l,e,s),q(t,e,null),u(e,n),q(i,e,null),o=!0},p(l,s){const a={};s&1&&(a.isLoading=l[0]),t.$set(a);const f={};s&1&&(f.isLoading=l[0]),i.$set(f)},i(l){o||(_(t.$$.fragment,l),_(i.$$.fragment,l),o=!0)},o(l){C(t.$$.fragment,l),C(i.$$.fragment,l),o=!1},d(l){l&&z(e),V(t),V(i)}}}function Uf(r){let e,t,n={maxWidth:r[3]?"500px":"310px",$$slots:{footer:[Hf],title:[Jf],default:[Wf]},$$scope:{ctx:r}};return e=new er({props:n}),r[13](e),{c(){L(e.$$.fragment)},m(i,o){q(e,i,o),t=!0},p(i,[o]){const l={};o&8&&(l.maxWidth=i[3]?"500px":"310px"),o&16511&&(l.$$scope={dirty:o,ctx:i}),e.$set(l)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){C(e.$$.fragment,i),t=!1},d(i){r[13](null),V(e,i)}}}function Gf(r,e,t){let{isLoading:n=!1}=e,{onConfirm:i}=e,{minNeedDate:o}=e,{isAccept:l=!1}=e,s,a="",f=null;function c(){t(5,a=""),t(6,f=l?null:Sl.now().startOf("day").toJSDate()),s.open()}function d(){s.close()}const p=()=>{i(f,a)},m=()=>{s.close()};function h(S){f=S,t(6,f)}function b(S){a=S,t(5,a)}function k(S){fe[S?"unshift":"push"](()=>{s=S,t(4,s)})}return r.$$set=S=>{"isLoading"in S&&t(0,n=S.isLoading),"onConfirm"in S&&t(1,i=S.onConfirm),"minNeedDate"in S&&t(2,o=S.minNeedDate),"isAccept"in S&&t(3,l=S.isAccept)},[n,i,o,l,s,a,f,c,d,p,m,h,b,k]}class Kf extends Wt{constructor(e){super(),Jt(this,e,Gf,Uf,Ht,{isLoading:0,onConfirm:1,minNeedDate:2,isAccept:3,open:7,close:8})}get open(){return this.$$.ctx[7]}get close(){return this.$$.ctx[8]}}function Hi(r,e,t){const n=r.slice();return n[94]=e[t],n}function Ui(r){let e;return{c(){e=g("div"),e.textContent="Generating PDF ...",v(e,"class","_g-pdf-generating")},m(t,n){P(t,e,n)},d(t){t&&z(e)}}}function Qf(r){let e,t,n;return{c(){e=g("button"),e.innerHTML='<span class="icon"><i class="ic ic-print"></i></span>',v(e,"class","btn btn-primary _button hidden desktop:block svelte-1n6e7yl")},m(i,o){P(i,e,o),t||(n=bt(e,"click",r[25]),t=!0)},p:Ee,d(i){i&&z(e),t=!1,n()}}}function Zf(r){var n;let e,t=((n=r[0])==null?void 0:n.documentNo)&&Gi(r);return{c(){t&&t.c(),e=wn()},m(i,o){t&&t.m(i,o),P(i,e,o)},p(i,o){var l;(l=i[0])!=null&&l.documentNo?t?t.p(i,o):(t=Gi(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(i){t&&t.d(i),i&&z(e)}}}function Gi(r){let e,t,n,i;return{c(){e=g("button"),t=g("span"),t.innerHTML='<i class="ic ic-delete"></i>',v(t,"class","icon"),v(e,"class","btn tooltip _button--delete svelte-1n6e7yl"),v(e,"data-tip","Delete"),e.disabled=r[4]},m(o,l){P(o,e,l),u(e,t),n||(i=bt(e,"click",r[44]),n=!0)},p(o,l){l[0]&16&&(e.disabled=o[4])},d(o){o&&z(e),n=!1,i()}}}function Ki(r){var ei,ti;let e,t,n,i,o,l,s,a,f,c,d,p,m,h,b,k,S,O,$,F,A,R,H,j,Q,ne,K,X,E,I,B,re,Y,te,ae,x,U,W,Oe,D,ue,_e,xe,ge,nt,Me,oe,qe,Ne,et,ye,be,ce,ie,Pe,N,J,Be,ze,wt,lt,ot=Le(r[0].createdDate)+"",kt,St,tt,pt,Ae,yt,He=Le(r[0].submittedDate)+"",vt,Ct,Ve,ht,Fe,me,Ie=Le(r[0].completedDate)+"",It,Nt,Kt,on,zn,yn,sn=Le(r[0].verifiedDate)+"",vn,Rn,Qt,an,Ln,Sn,fn=Le(r[0].approvedDate)+"",Cn,qn,Zt,cn,Vn,On,y=Le(r[0].acceptedDate)+"",Z,Se,Ce;function Xt(w){r[45](w)}let Ot={isRequester:!0,isActionLoading:r[4]};r[0]!==void 0&&(Ot.data=r[0]),e=new fi({props:Ot}),fe.push(()=>we(e,"data",Xt)),e.$on("confirm",r[39]);function to(w){r[46](w)}let Pr={isActionLoading:r[4]};r[0]!==void 0&&(Pr.data=r[0]),i=new fi({props:Pr}),fe.push(()=>we(i,"data",to)),i.$on("confirm",r[39]);let Ue=!r[18]&&Qi(r),Yt=r[21],Te=[];for(let w=0;w<Yt.length;w+=1)Te[w]=al(Hi(r,Yt,w));const no=w=>C(Te[w],1,1,()=>{Te[w]=null});function ro(w){r[58](w)}let zr={isPdfGenerating:r[18],isEdit:r[5]};r[0]!==void 0&&(zr.data=r[0]),d=new jf({props:zr}),fe.push(()=>we(d,"data",ro)),r[59](d),d.$on("change",r[60]);const Rr=[Yf,Xf],Bt=[];function Lr(w,T){return w[18]?0:1}O=Lr(r),$=Bt[O]=Rr[O](r);const qr=[ec,xf],Ft=[];function Vr(w,T){return w[18]?0:1}A=Vr(r),R=Ft[A]=qr[A](r);const jr=[nc,tc],Tt=[];function Wr(w,T){return w[18]?0:1}j=Wr(r),Q=Tt[j]=jr[j](r);const Jr=[ic,rc],At=[];function Hr(w,T){return w[18]?0:1}K=Hr(r),X=At[K]=Jr[K](r);const Ur=[oc,lc],Dt=[];function Gr(w,T){return w[18]?0:1}I=Gr(r),B=Dt[I]=Ur[I](r);const Kr=[ac,sc],Pt=[];function Qr(w,T){return w[18]?0:1}Y=Qr(r),te=Pt[Y]=Kr[Y](r);function io(w){r[70](w)}let Zr={canSave:r[0].canSave,canSaveComplete:r[0].canSaveComplete,showCompleteForm:r[0].showCompleteForm,addItemModal:r[8],withdrawFrom:(ei=r[0])==null?void 0:ei.withdrawFrom,isPdfGenerating:r[18]};r[0].withdraws!==void 0&&(Zr.items=r[0].withdraws),x=new Li({props:Zr}),fe.push(()=>we(x,"items",io)),x.$on("totalChange",r[40]),x.$on("preview",r[41]);let st=r[0].showCompleteForm&&fl(r);function lo(w){r[71](w)}function oo(w){r[72](w)}let nr={canSave:r[0].canSave,canSaveComplete:r[0].canSaveComplete,showCompleteForm:r[0].showCompleteForm,addItemModal:r[8],withdrawFrom:(ti=r[0])==null?void 0:ti.withdrawFrom,isOther:!0,isPdfGenerating:r[18]};r[0].withdrawOthers!==void 0&&(nr.items=r[0].withdrawOthers),r[2]!==void 0&&(nr.cacheWithdrawOther=r[2]),D=new Li({props:nr}),fe.push(()=>we(D,"items",lo)),fe.push(()=>we(D,"cacheWithdrawOther",oo)),D.$on("totalChange",r[73]),D.$on("preview",r[41]);let at=r[0].showCompleteForm&&cl(r),ft=r[0].showCompleteForm&&ul(r);const Xr=[cc,fc],zt=[];function Yr(w,T){return w[18]?0:1}Me=Yr(r),oe=zt[Me]=Xr[Me](r);let Ge=r[0].acceptedDate&&!r[18]&&dl(r),Ke=r[0].onBehalfOfVerifying&&(r[0].verifiedDate||r[0].rejectedDate)&&!r[18]&&pl(r),Qe=!r[18]&&ml(r),Ze=(r[0].showPMSVComment||r[0].staffComment)&&!r[18]&&gl(r),Xe=r[0].showPMSVComment&&!r[18]&&_l(r);function so(w){r[77](w)}let xr={isPdfGenerating:r[18],isShowNameTH:!0};r[0]!==void 0&&(xr.data=r[0]),ie=new zo({props:xr}),fe.push(()=>we(ie,"data",so));let ct=r[0].showCompleteForm&&!r[18]&&bl(r);return{c(){L(e.$$.fragment),n=M(),L(i.$$.fragment),l=M(),s=g("div"),Ue&&Ue.c(),a=M(),f=g("div");for(let w=0;w<Te.length;w+=1)Te[w].c();c=M(),L(d.$$.fragment),m=M(),h=g("div"),b=g("div"),b.textContent="รายละเอียดการขอเบิกอุปกรณ์สำนักงาน",k=M(),S=g("div"),$.c(),F=M(),R.c(),H=M(),Q.c(),ne=M(),X.c(),E=M(),B.c(),re=M(),te.c(),ae=M(),L(x.$$.fragment),W=M(),st&&st.c(),Oe=M(),L(D.$$.fragment),xe=M(),at&&at.c(),ge=M(),ft&&ft.c(),nt=M(),oe.c(),qe=M(),Ge&&Ge.c(),Ne=M(),Ke&&Ke.c(),et=M(),Qe&&Qe.c(),ye=M(),Ze&&Ze.c(),be=M(),Xe&&Xe.c(),ce=M(),L(ie.$$.fragment),N=M(),J=g("div"),Be=g("div"),ze=g("span"),ze.textContent="Created Date :",wt=M(),lt=g("span"),kt=G(ot),St=M(),tt=g("div"),pt=g("span"),pt.textContent="Submitted Date :",Ae=M(),yt=g("span"),vt=G(He),Ct=M(),Ve=g("div"),ht=g("span"),ht.textContent="Completed Date :",Fe=M(),me=g("span"),It=G(Ie),Nt=M(),Kt=g("div"),on=g("span"),on.textContent="Verified Date :",zn=M(),yn=g("span"),vn=G(sn),Rn=M(),Qt=g("div"),an=g("span"),an.textContent="Approved Date :",Ln=M(),Sn=g("span"),Cn=G(fn),qn=M(),Zt=g("div"),cn=g("span"),cn.textContent="Accepted Date :",Vn=M(),On=g("span"),Z=G(y),Se=M(),ct&&ct.c(),v(f,"class","flex gap-3 my-3"),v(b,"class","_title svelte-1n6e7yl"),v(S,"class","grid grid-cols-1 gap-2 mb-4 desktop:grid-cols-3 desktop:gap-x-10"),v(h,"class","_container _container--gray _desktop-spacing svelte-1n6e7yl"),he(h,"_pdf-generating",r[18]),v(ze,"class","text-gray-800"),v(pt,"class","text-gray-800"),v(ht,"class","text-gray-800"),v(on,"class","text-gray-800"),v(an,"class","text-gray-800"),v(cn,"class","text-gray-800"),v(J,"class","p-2 grid gap-1.5 _desktop-spacing desktop:grid-cols-3 desktop:gap-x-10 svelte-1n6e7yl"),he(J,"_pdf-generating",r[18]),v(s,"class","bg-white border border-gray-400 p-2 pb-3 desktop:px-4")},m(w,T){q(e,w,T),P(w,n,T),q(i,w,T),P(w,l,T),P(w,s,T),Ue&&Ue.m(s,null),u(s,a),u(s,f);for(let Rt=0;Rt<Te.length;Rt+=1)Te[Rt]&&Te[Rt].m(f,null);u(s,c),q(d,s,null),u(s,m),u(s,h),u(h,b),u(h,k),u(h,S),Bt[O].m(S,null),u(S,F),Ft[A].m(S,null),u(S,H),Tt[j].m(S,null),u(S,ne),At[K].m(S,null),u(S,E),Dt[I].m(S,null),u(S,re),Pt[Y].m(S,null),u(h,ae),q(x,h,null),u(h,W),st&&st.m(h,null),u(h,Oe),q(D,h,null),u(h,xe),at&&at.m(h,null),u(h,ge),ft&&ft.m(h,null),u(h,nt),zt[Me].m(h,null),u(s,qe),Ge&&Ge.m(s,null),u(s,Ne),Ke&&Ke.m(s,null),u(s,et),Qe&&Qe.m(s,null),u(s,ye),Ze&&Ze.m(s,null),u(s,be),Xe&&Xe.m(s,null),u(s,ce),q(ie,s,null),u(s,N),u(s,J),u(J,Be),u(Be,ze),u(Be,wt),u(Be,lt),u(lt,kt),u(J,St),u(J,tt),u(tt,pt),u(tt,Ae),u(tt,yt),u(yt,vt),u(J,Ct),u(J,Ve),u(Ve,ht),u(Ve,Fe),u(Ve,me),u(me,It),u(J,Nt),u(J,Kt),u(Kt,on),u(Kt,zn),u(Kt,yn),u(yn,vn),u(J,Rn),u(J,Qt),u(Qt,an),u(Qt,Ln),u(Qt,Sn),u(Sn,Cn),u(J,qn),u(J,Zt),u(Zt,cn),u(Zt,Vn),u(Zt,On),u(On,Z),u(s,Se),ct&&ct.m(s,null),Ce=!0},p(w,T){var ni,ri;const Rt={};T[0]&16&&(Rt.isActionLoading=w[4]),!t&&T[0]&1&&(t=!0,Rt.data=w[0],ke(()=>t=!1)),e.$set(Rt);const rr={};if(T[0]&16&&(rr.isActionLoading=w[4]),!o&&T[0]&1&&(o=!0,rr.data=w[0],ke(()=>o=!1)),i.$set(rr),w[18]?Ue&&(de(),C(Ue,1,1,()=>{Ue=null}),pe()):Ue?(Ue.p(w,T),T[0]&262144&&_(Ue,1)):(Ue=Qi(w),Ue.c(),_(Ue,1),Ue.m(s,a)),T[0]&18874369){Yt=w[21];let it;for(it=0;it<Yt.length;it+=1){const ii=Hi(w,Yt,it);Te[it]?(Te[it].p(ii,T),_(Te[it],1)):(Te[it]=al(ii),Te[it].c(),_(Te[it],1),Te[it].m(f,null))}for(de(),it=Yt.length;it<Te.length;it+=1)no(it);pe()}const jn={};T[0]&262144&&(jn.isPdfGenerating=w[18]),T[0]&32&&(jn.isEdit=w[5]),!p&&T[0]&1&&(p=!0,jn.data=w[0],ke(()=>p=!1)),d.$set(jn);let ir=O;O=Lr(w),O===ir?Bt[O].p(w,T):(de(),C(Bt[ir],1,1,()=>{Bt[ir]=null}),pe(),$=Bt[O],$?$.p(w,T):($=Bt[O]=Rr[O](w),$.c()),_($,1),$.m(S,F));let lr=A;A=Vr(w),A===lr?Ft[A].p(w,T):(de(),C(Ft[lr],1,1,()=>{Ft[lr]=null}),pe(),R=Ft[A],R?R.p(w,T):(R=Ft[A]=qr[A](w),R.c()),_(R,1),R.m(S,H));let or=j;j=Wr(w),j===or?Tt[j].p(w,T):(de(),C(Tt[or],1,1,()=>{Tt[or]=null}),pe(),Q=Tt[j],Q?Q.p(w,T):(Q=Tt[j]=jr[j](w),Q.c()),_(Q,1),Q.m(S,ne));let sr=K;K=Hr(w),K===sr?At[K].p(w,T):(de(),C(At[sr],1,1,()=>{At[sr]=null}),pe(),X=At[K],X?X.p(w,T):(X=At[K]=Jr[K](w),X.c()),_(X,1),X.m(S,E));let ar=I;I=Gr(w),I===ar?Dt[I].p(w,T):(de(),C(Dt[ar],1,1,()=>{Dt[ar]=null}),pe(),B=Dt[I],B?B.p(w,T):(B=Dt[I]=Ur[I](w),B.c()),_(B,1),B.m(S,re));let fr=Y;Y=Qr(w),Y===fr?Pt[Y].p(w,T):(de(),C(Pt[fr],1,1,()=>{Pt[fr]=null}),pe(),te=Pt[Y],te?te.p(w,T):(te=Pt[Y]=Kr[Y](w),te.c()),_(te,1),te.m(S,null));const Lt={};T[0]&1&&(Lt.canSave=w[0].canSave),T[0]&1&&(Lt.canSaveComplete=w[0].canSaveComplete),T[0]&1&&(Lt.showCompleteForm=w[0].showCompleteForm),T[0]&256&&(Lt.addItemModal=w[8]),T[0]&1&&(Lt.withdrawFrom=(ni=w[0])==null?void 0:ni.withdrawFrom),T[0]&262144&&(Lt.isPdfGenerating=w[18]),!U&&T[0]&1&&(U=!0,Lt.items=w[0].withdraws,ke(()=>U=!1)),x.$set(Lt),w[0].showCompleteForm?st?st.p(w,T):(st=fl(w),st.c(),st.m(h,Oe)):st&&(st.d(1),st=null);const $t={};T[0]&1&&($t.canSave=w[0].canSave),T[0]&1&&($t.canSaveComplete=w[0].canSaveComplete),T[0]&1&&($t.showCompleteForm=w[0].showCompleteForm),T[0]&256&&($t.addItemModal=w[8]),T[0]&1&&($t.withdrawFrom=(ri=w[0])==null?void 0:ri.withdrawFrom),T[0]&262144&&($t.isPdfGenerating=w[18]),!ue&&T[0]&1&&(ue=!0,$t.items=w[0].withdrawOthers,ke(()=>ue=!1)),!_e&&T[0]&4&&(_e=!0,$t.cacheWithdrawOther=w[2],ke(()=>_e=!1)),D.$set($t),w[0].showCompleteForm?at?at.p(w,T):(at=cl(w),at.c(),at.m(h,ge)):at&&(at.d(1),at=null),w[0].showCompleteForm?ft?ft.p(w,T):(ft=ul(w),ft.c(),ft.m(h,nt)):ft&&(ft.d(1),ft=null);let cr=Me;Me=Yr(w),Me===cr?zt[Me].p(w,T):(de(),C(zt[cr],1,1,()=>{zt[cr]=null}),pe(),oe=zt[Me],oe?oe.p(w,T):(oe=zt[Me]=Xr[Me](w),oe.c()),_(oe,1),oe.m(h,null)),(!Ce||T[0]&262144)&&he(h,"_pdf-generating",w[18]),w[0].acceptedDate&&!w[18]?Ge?(Ge.p(w,T),T[0]&262145&&_(Ge,1)):(Ge=dl(w),Ge.c(),_(Ge,1),Ge.m(s,Ne)):Ge&&(de(),C(Ge,1,1,()=>{Ge=null}),pe()),w[0].onBehalfOfVerifying&&(w[0].verifiedDate||w[0].rejectedDate)&&!w[18]?Ke?(Ke.p(w,T),T[0]&262145&&_(Ke,1)):(Ke=pl(w),Ke.c(),_(Ke,1),Ke.m(s,et)):Ke&&(de(),C(Ke,1,1,()=>{Ke=null}),pe()),w[18]?Qe&&(de(),C(Qe,1,1,()=>{Qe=null}),pe()):Qe?(Qe.p(w,T),T[0]&262144&&_(Qe,1)):(Qe=ml(w),Qe.c(),_(Qe,1),Qe.m(s,ye)),(w[0].showPMSVComment||w[0].staffComment)&&!w[18]?Ze?(Ze.p(w,T),T[0]&262145&&_(Ze,1)):(Ze=gl(w),Ze.c(),_(Ze,1),Ze.m(s,be)):Ze&&(de(),C(Ze,1,1,()=>{Ze=null}),pe()),w[0].showPMSVComment&&!w[18]?Xe?(Xe.p(w,T),T[0]&262145&&_(Xe,1)):(Xe=_l(w),Xe.c(),_(Xe,1),Xe.m(s,ce)):Xe&&(de(),C(Xe,1,1,()=>{Xe=null}),pe());const ur={};T[0]&262144&&(ur.isPdfGenerating=w[18]),!Pe&&T[0]&1&&(Pe=!0,ur.data=w[0],ke(()=>Pe=!1)),ie.$set(ur),(!Ce||T[0]&1)&&ot!==(ot=Le(w[0].createdDate)+"")&&le(kt,ot),(!Ce||T[0]&1)&&He!==(He=Le(w[0].submittedDate)+"")&&le(vt,He),(!Ce||T[0]&1)&&Ie!==(Ie=Le(w[0].completedDate)+"")&&le(It,Ie),(!Ce||T[0]&1)&&sn!==(sn=Le(w[0].verifiedDate)+"")&&le(vn,sn),(!Ce||T[0]&1)&&fn!==(fn=Le(w[0].approvedDate)+"")&&le(Cn,fn),(!Ce||T[0]&1)&&y!==(y=Le(w[0].acceptedDate)+"")&&le(Z,y),(!Ce||T[0]&262144)&&he(J,"_pdf-generating",w[18]),w[0].showCompleteForm&&!w[18]?ct?ct.p(w,T):(ct=bl(w),ct.c(),ct.m(s,null)):ct&&(ct.d(1),ct=null)},i(w){if(!Ce){_(e.$$.fragment,w),_(i.$$.fragment,w),_(Ue);for(let T=0;T<Yt.length;T+=1)_(Te[T]);_(d.$$.fragment,w),_($),_(R),_(Q),_(X),_(B),_(te),_(x.$$.fragment,w),_(D.$$.fragment,w),_(oe),_(Ge),_(Ke),_(Qe),_(Ze),_(Xe),_(ie.$$.fragment,w),Ce=!0}},o(w){C(e.$$.fragment,w),C(i.$$.fragment,w),C(Ue),Te=Te.filter(Boolean);for(let T=0;T<Te.length;T+=1)C(Te[T]);C(d.$$.fragment,w),C($),C(R),C(Q),C(X),C(B),C(te),C(x.$$.fragment,w),C(D.$$.fragment,w),C(oe),C(Ge),C(Ke),C(Qe),C(Ze),C(Xe),C(ie.$$.fragment,w),Ce=!1},d(w){V(e,w),w&&z(n),V(i,w),w&&z(l),w&&z(s),Ue&&Ue.d(),vl(Te,w),r[59](null),V(d),Bt[O].d(),Ft[A].d(),Tt[j].d(),At[K].d(),Dt[I].d(),Pt[Y].d(),V(x),st&&st.d(),V(D),at&&at.d(),ft&&ft.d(),zt[Me].d(),Ge&&Ge.d(),Ke&&Ke.d(),Qe&&Qe.d(),Ze&&Ze.d(),Xe&&Xe.d(),V(ie),ct&&ct.d()}}}function Qi(r){let e,t,n,i,o,l,s,a,f,c,d,p,m,h,b,k,S,O=r[5]&&Zi(),$=r[0].rejectComment&&Xi(r),F=r[0].cancelComment&&Yi(r);s=new Ye({props:{isLoading:r[4],outline:!0,primary:!1,class:"w-[96px]",label:"Back"}}),s.$on("click",r[49]);let A=r[0].canEdit&&!r[5]&&xi(r),R=(r[0].canSave||r[0].canSaveComplete)&&el(r),H=r[0].canSubmit&&tl(r),j=r[0].canApprove&&nl(r),Q=r[0].canAccept&&rl(r),ne=r[0].canComplete&&il(r),K=r[0].canVerify&&!r[5]&&ll(r),X=(r[0].canApprove||r[0].canVerify)&&!r[5]&&ol(r),E=r[0].canCancelRequest&&sl(r);return{c(){e=g("div"),t=g("div"),O&&O.c(),n=M(),i=g("div"),$&&$.c(),o=M(),F&&F.c(),l=M(),L(s.$$.fragment),a=M(),A&&A.c(),f=M(),R&&R.c(),c=M(),H&&H.c(),d=M(),j&&j.c(),p=M(),Q&&Q.c(),m=M(),ne&&ne.c(),h=M(),K&&K.c(),b=M(),X&&X.c(),k=M(),E&&E.c(),he(t,"mb-2",r[5]),v(i,"class","flex justify-between desktop:justify-end desktop:gap-3"),v(e,"class","desktop:flex justify-between")},m(I,B){P(I,e,B),u(e,t),O&&O.m(t,null),u(e,n),u(e,i),$&&$.m(i,null),u(i,o),F&&F.m(i,null),u(i,l),q(s,i,null),u(i,a),A&&A.m(i,null),u(i,f),R&&R.m(i,null),u(i,c),H&&H.m(i,null),u(i,d),j&&j.m(i,null),u(i,p),Q&&Q.m(i,null),u(i,m),ne&&ne.m(i,null),u(i,h),K&&K.m(i,null),u(i,b),X&&X.m(i,null),u(i,k),E&&E.m(i,null),S=!0},p(I,B){I[5]?O||(O=Zi(),O.c(),O.m(t,null)):O&&(O.d(1),O=null),(!S||B[0]&32)&&he(t,"mb-2",I[5]),I[0].rejectComment?$?$.p(I,B):($=Xi(I),$.c(),$.m(i,o)):$&&($.d(1),$=null),I[0].cancelComment?F?F.p(I,B):(F=Yi(I),F.c(),F.m(i,l)):F&&(F.d(1),F=null);const re={};B[0]&16&&(re.isLoading=I[4]),s.$set(re),I[0].canEdit&&!I[5]?A?(A.p(I,B),B[0]&33&&_(A,1)):(A=xi(I),A.c(),_(A,1),A.m(i,f)):A&&(de(),C(A,1,1,()=>{A=null}),pe()),I[0].canSave||I[0].canSaveComplete?R?(R.p(I,B),B[0]&1&&_(R,1)):(R=el(I),R.c(),_(R,1),R.m(i,c)):R&&(de(),C(R,1,1,()=>{R=null}),pe()),I[0].canSubmit?H?(H.p(I,B),B[0]&1&&_(H,1)):(H=tl(I),H.c(),_(H,1),H.m(i,d)):H&&(de(),C(H,1,1,()=>{H=null}),pe()),I[0].canApprove?j?(j.p(I,B),B[0]&1&&_(j,1)):(j=nl(I),j.c(),_(j,1),j.m(i,p)):j&&(de(),C(j,1,1,()=>{j=null}),pe()),I[0].canAccept?Q?(Q.p(I,B),B[0]&1&&_(Q,1)):(Q=rl(I),Q.c(),_(Q,1),Q.m(i,m)):Q&&(de(),C(Q,1,1,()=>{Q=null}),pe()),I[0].canComplete?ne?(ne.p(I,B),B[0]&1&&_(ne,1)):(ne=il(I),ne.c(),_(ne,1),ne.m(i,h)):ne&&(de(),C(ne,1,1,()=>{ne=null}),pe()),I[0].canVerify&&!I[5]?K?(K.p(I,B),B[0]&33&&_(K,1)):(K=ll(I),K.c(),_(K,1),K.m(i,b)):K&&(de(),C(K,1,1,()=>{K=null}),pe()),(I[0].canApprove||I[0].canVerify)&&!I[5]?X?(X.p(I,B),B[0]&33&&_(X,1)):(X=ol(I),X.c(),_(X,1),X.m(i,k)):X&&(de(),C(X,1,1,()=>{X=null}),pe()),I[0].canCancelRequest?E?(E.p(I,B),B[0]&1&&_(E,1)):(E=sl(I),E.c(),_(E,1),E.m(i,null)):E&&(de(),C(E,1,1,()=>{E=null}),pe())},i(I){S||(_(s.$$.fragment,I),_(A),_(R),_(H),_(j),_(Q),_(ne),_(K),_(X),_(E),S=!0)},o(I){C(s.$$.fragment,I),C(A),C(R),C(H),C(j),C(Q),C(ne),C(K),C(X),C(E),S=!1},d(I){I&&z(e),O&&O.d(),$&&$.d(),F&&F.d(),V(s),A&&A.d(),R&&R.d(),H&&H.d(),j&&j.d(),Q&&Q.d(),ne&&ne.d(),K&&K.d(),X&&X.d(),E&&E.d()}}}function Zi(r){let e;return{c(){e=g("span"),e.textContent="แก้ไขข้อมูล",v(e,"class","text-reject font-weight-bold")},m(t,n){P(t,e,n)},d(t){t&&z(e)}}}function Xi(r){let e,t,n,i,o,l;return{c(){e=g("div"),t=g("span"),t.innerHTML='<i class="ic ic-reject"></i>',n=M(),i=g("span"),i.textContent="Reject Reason",v(t,"class","_icon-link svelte-1n6e7yl"),v(i,"class","text-reject text-size-normal underline cursor-pointer"),v(e,"class","_icon-link svelte-1n6e7yl")},m(s,a){P(s,e,a),u(e,t),u(e,n),u(e,i),o||(l=bt(i,"click",r[47]),o=!0)},p:Ee,d(s){s&&z(e),o=!1,l()}}}function Yi(r){let e,t,n,i,o,l;return{c(){e=g("div"),t=g("span"),t.innerHTML='<i class="ic ic-reject"></i>',n=M(),i=g("span"),i.textContent="Cancel Reason",v(t,"class","_icon-link svelte-1n6e7yl"),v(i,"class","text-reject text-size-normal underline cursor-pointer"),v(e,"class","_icon-link svelte-1n6e7yl")},m(s,a){P(s,e,a),u(e,t),u(e,n),u(e,i),o||(l=bt(i,"click",r[48]),o=!0)},p:Ee,d(s){s&&z(e),o=!1,l()}}}function xi(r){let e,t;return e=new Ye({props:{isLoading:r[4],outline:!0,primary:!1,class:"w-[96px]",label:"Edit",icon:"ic-edit"}}),e.$on("click",r[28]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function el(r){let e,t;return e=new Ye({props:{isLoading:r[4],primary:!0,class:"w-[96px]",label:"Save"}}),e.$on("click",r[50]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function tl(r){let e,t;return e=new Ye({props:{isLoading:r[4],primary:!1,secondary:!0,label:"Submit",class:"w-[96px]"}}),e.$on("click",r[30]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function nl(r){let e,t;return e=new Ye({props:{isLoading:r[4],primary:!1,secondary:!0,label:"Approve",class:"w-[96px]"}}),e.$on("click",r[51]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function rl(r){let e,t;return e=new Ye({props:{isLoading:r[4],primary:!1,secondary:!0,label:"Accept",class:"w-[96px]"}}),e.$on("click",r[52]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function il(r){let e,t;return e=new Ye({props:{icon:"ic-success",isLoading:r[4],primary:!1,secondary:!0,label:"Complete",class:"w-[102px]"}}),e.$on("click",r[53]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function ll(r){let e,t;return e=new Ye({props:{isLoading:r[4],primary:!1,secondary:!0,label:"Verify",class:"w-[80px]"}}),e.$on("click",r[54]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function ol(r){let e,t;return e=new Ye({props:{isLoading:r[4],primary:!1,cancel:!0,label:"Reject",class:"w-[80px]"}}),e.$on("click",r[55]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function sl(r){let e,t;return e=new Ye({props:{isLoading:r[4],primary:!1,cancel:!0,label:"Cancel Request"}}),e.$on("click",r[56]),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&16&&(o.isLoading=n[4]),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function al(r){let e,t,n;function i(l){r[57](l)}let o={isForm:!0,labelClass:"text-black",name:"onBehalfFlow",value:r[94].value,label:r[94].label,disabled:!r[0].canSave||r[0].canOnlyOnBehalf};return r[0].isOnBehalf!==void 0&&(o.group=r[0].isOnBehalf),e=new gn({props:o}),fe.push(()=>we(e,"group",i)),e.$on("change",r[24]),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};s[0]&1&&(a.disabled=!l[0].canSave||l[0].canOnlyOnBehalf),!t&&s[0]&1&&(t=!0,a.group=l[0].isOnBehalf,ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function Xf(r){let e,t,n;function i(l){r[61](l)}let o={placeholder:"",valueKey:"key",labelKey:"value",clearable:!1,label:"ต้องการเบิกจาก",options:r[23],disabled:!r[0].canSave,required:!0};return r[0].withdrawFrom!==void 0&&(o.value=r[0].withdrawFrom),e=new Er({props:o}),fe.push(()=>we(e,"value",i)),e.$on("change",r[62]),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};s[0]&1&&(a.disabled=!l[0].canSave),!t&&s[0]&1&&(t=!0,a.value=l[0].withdrawFrom,ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function Yf(r){var n;let e,t;return e=new Ut({props:{label:"ต้องการเบิกจาก",value:(n=r[0].withdrawFrom)==null?void 0:n.value,required:!0}}),{c(){L(e.$$.fragment)},m(i,o){q(e,i,o),t=!0},p(i,o){var s;const l={};o[0]&1&&(l.value=(s=i[0].withdrawFrom)==null?void 0:s.value),e.$set(l)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){C(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function xf(r){let e,t,n;function i(l){r[63](l)}let o={placeholder:"",valueKey:"key",labelKey:"value",clearable:!1,label:"เพื่อใช้ในบริษัท (Service For)",options:r[22],disabled:!(r[0].canSave||r[0].canSaveComplete),required:!0};return r[0].serviceFor!==void 0&&(o.value=r[0].serviceFor),e=new Er({props:o}),fe.push(()=>we(e,"value",i)),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};s[0]&1&&(a.disabled=!(l[0].canSave||l[0].canSaveComplete)),!t&&s[0]&1&&(t=!0,a.value=l[0].serviceFor,ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function ec(r){var n;let e,t;return e=new Ut({props:{label:"เพื่อใช้ในบริษัท (Service For)",value:(n=r[0].serviceFor)==null?void 0:n.value,required:!0}}),{c(){L(e.$$.fragment)},m(i,o){q(e,i,o),t=!0},p(i,o){var s;const l={};o[0]&1&&(l.value=(s=i[0].serviceFor)==null?void 0:s.value),e.$set(l)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){C(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function tc(r){let e,t,n;function i(l){r[64](l)}let o={label:"สถานที่จัดส่ง (Location)",name:"location",disabled:!(r[0].canSave||r[0].canSaveComplete),required:!0};return r[0].location!==void 0&&(o.value=r[0].location),e=new _n({props:o}),fe.push(()=>we(e,"value",i)),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};s[0]&1&&(a.disabled=!(l[0].canSave||l[0].canSaveComplete)),!t&&s[0]&1&&(t=!0,a.value=l[0].location,ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function nc(r){let e,t;return e=new Ut({props:{label:"สถานที่จัดส่ง (Location)",value:r[0].location,required:!0}}),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&1&&(o.value=n[0].location),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function rc(r){let e,t,n;function i(l){r[65](l)}let o={label:"เบอร์โทรศัพท์ภายใน",name:"internalNo",disabled:!r[0].canSave,required:!0};return r[0].internalNo!==void 0&&(o.value=r[0].internalNo),e=new _n({props:o}),fe.push(()=>we(e,"value",i)),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};s[0]&1&&(a.disabled=!l[0].canSave),!t&&s[0]&1&&(t=!0,a.value=l[0].internalNo,ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function ic(r){let e,t;return e=new Ut({props:{label:"เบอร์โทรศัพท์ภายใน",value:r[0].internalNo,required:!0}}),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&1&&(o.value=n[0].internalNo),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function lc(r){let e,t,n;function i(l){r[66](l)}let o={label:"เบอร์โทรศัพท์มือถือ (Mobile)",name:"mobileNo",disabled:!r[0].canSave,required:!0};return r[0].mobileNo!==void 0&&(o.value=r[0].mobileNo),e=new _n({props:o}),fe.push(()=>we(e,"value",i)),e.$on("input",r[67]),e.$on("keypress",r[68]),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};s[0]&1&&(a.disabled=!l[0].canSave),!t&&s[0]&1&&(t=!0,a.value=l[0].mobileNo,ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function oc(r){let e,t;return e=new Ut({props:{label:"เบอร์โทรศัพท์มือถือ (Mobile)",value:r[0].mobileNo,required:!0}}),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&1&&(o.value=n[0].mobileNo),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function sc(r){let e,t,n;function i(l){r[69](l)}let o={label:"ต้องการของวันที่ (Need Date)",name:"needDate",minDate:r[20],disabled:!r[0].canSave,disabledWeekend:!0,required:!0};return r[0].needDate!==void 0&&(o.value=r[0].needDate),e=new Ol({props:o}),fe.push(()=>we(e,"value",i)),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};s[0]&1&&(a.disabled=!l[0].canSave),!t&&s[0]&1&&(t=!0,a.value=l[0].needDate,ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function ac(r){let e,t;return e=new Ut({props:{label:"ต้องการของวันที่ (Need Date)",value:Le(r[0].needDate),required:!0}}),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&1&&(o.value=Le(n[0].needDate)),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function fl(r){let e,t,n=Je(r[0].totalStock,2)+"",i,o;return{c(){e=g("div"),t=G("ราคารวม : "),i=G(n),o=G(" บาท"),v(e,"class","text-right font-weight-bold")},m(l,s){P(l,e,s),u(e,t),u(e,i),u(e,o)},p(l,s){s[0]&1&&n!==(n=Je(l[0].totalStock,2)+"")&&le(i,n)},d(l){l&&z(e)}}}function cl(r){let e,t,n=Je(r[0].totalOther,2)+"",i,o;return{c(){e=g("div"),t=G("ราคารวม : "),i=G(n),o=G(" บาท"),v(e,"class","text-right font-weight-bold")},m(l,s){P(l,e,s),u(e,t),u(e,i),u(e,o)},p(l,s){s[0]&1&&n!==(n=Je(l[0].totalOther,2)+"")&&le(i,n)},d(l){l&&z(e)}}}function ul(r){let e,t,n,i,o=Je(r[0].total,2)+"",l,s;return{c(){e=g("br"),t=M(),n=g("div"),i=G("ราคารวมทั้งหมด (Total) : "),l=G(o),s=G(" บาท"),v(n,"class","text-right font-weight-bold")},m(a,f){P(a,e,f),P(a,t,f),P(a,n,f),u(n,i),u(n,l),u(n,s)},p(a,f){f[0]&1&&o!==(o=Je(a[0].total,2)+"")&&le(l,o)},d(a){a&&z(e),a&&z(t),a&&z(n)}}}function fc(r){let e,t,n;function i(l){r[74](l)}let o={autoResize:!0,label:"ใช้สำหรับ (For)",labelClass:"text-gray-800",disabled:!r[0].canSave,required:r[0].withdrawOthers.length>0};return r[0].comment!==void 0&&(o.value=r[0].comment),e=new rn({props:o}),fe.push(()=>we(e,"value",i)),{c(){L(e.$$.fragment)},m(l,s){q(e,l,s),n=!0},p(l,s){const a={};s[0]&1&&(a.disabled=!l[0].canSave),s[0]&1&&(a.required=l[0].withdrawOthers.length>0),!t&&s[0]&1&&(t=!0,a.value=l[0].comment,ke(()=>t=!1)),e.$set(a)},i(l){n||(_(e.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),n=!1},d(l){V(e,l)}}}function cc(r){let e,t;return e=new Ut({props:{isTextarea:!0,label:"ใช้สำหรับ (For)",value:r[0].comment,required:!0}}),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&1&&(o.value=n[0].comment),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function dl(r){let e,t,n,i,o,l=r[0].acceptedBy+"",s,a,f,c,d=Le(r[0].deliveryDate)+"",p,m,h,b;return h=new rn({props:{autoResize:!0,label:"หมายเหตุ (Remark)",labelClass:"text-gray-800",value:r[0].acceptedComment,disabled:!0}}),{c(){e=g("div"),t=g("div"),t.textContent="Administrator",n=M(),i=g("div"),o=G("Accepted by : "),s=G(l),a=M(),f=g("div"),c=G("วันที่จะจัดส่งอุปกรณ์ : "),p=G(d),m=M(),L(h.$$.fragment),v(t,"class","font-weight-bold mb-2"),v(i,"class","mb-2"),v(f,"class","mb-2"),v(e,"class","_container _container--gray _desktop-spacing mt-1 svelte-1n6e7yl"),he(e,"_pdf-generating",r[18])},m(k,S){P(k,e,S),u(e,t),u(e,n),u(e,i),u(i,o),u(i,s),u(e,a),u(e,f),u(f,c),u(f,p),u(e,m),q(h,e,null),b=!0},p(k,S){(!b||S[0]&1)&&l!==(l=k[0].acceptedBy+"")&&le(s,l),(!b||S[0]&1)&&d!==(d=Le(k[0].deliveryDate)+"")&&le(p,d);const O={};S[0]&1&&(O.value=k[0].acceptedComment),h.$set(O),(!b||S[0]&262144)&&he(e,"_pdf-generating",k[18])},i(k){b||(_(h.$$.fragment,k),b=!0)},o(k){C(h.$$.fragment,k),b=!1},d(k){k&&z(e),V(h)}}}function pl(r){let e,t,n,i,o=r[0].verifiedDate?"Verified":"Rejected",l,s,a=r[0].onBehalfOfEmployeeNameEN+"",f,c,d,p,m,h,b,k,S;return p=new gn({props:{isForm:!0,labelClass:"text-black",name:"onBehalfResult",value:"verify",label:"ยืนยันใบงาน (Verify)",group:r[0].verifiedDate?"verify":"",disabled:!0}}),h=new gn({props:{isForm:!0,labelClass:"text-black",name:"onBehalfResult",value:"reject",label:"ไม่อนุมัติใบงาน (Reject)",group:r[0].verifiedDate?"":"reject",disabled:!0}}),k=new rn({props:{autoResize:!0,label:"เหตุผล (Reason)",labelClass:"text-gray-800",value:r[0].verifiedDate?r[0].verifyComment||"":r[0].rejectComment,disabled:!0}}),{c(){e=g("div"),t=g("div"),t.textContent="ผู้ดำเนินการแทน (On Behalf of)",n=M(),i=g("div"),l=G(o),s=G(" by : "),f=G(a),c=M(),d=g("div"),L(p.$$.fragment),m=M(),L(h.$$.fragment),b=M(),L(k.$$.fragment),v(t,"class","font-weight-bold mb-2"),v(i,"class","mb-2"),v(d,"class","flex gap-3 mb-2"),v(e,"class","_container _container--gray _desktop-spacing mt-1 svelte-1n6e7yl"),he(e,"_pdf-generating",r[18])},m(O,$){P(O,e,$),u(e,t),u(e,n),u(e,i),u(i,l),u(i,s),u(i,f),u(e,c),u(e,d),q(p,d,null),u(d,m),q(h,d,null),u(e,b),q(k,e,null),S=!0},p(O,$){(!S||$[0]&1)&&o!==(o=O[0].verifiedDate?"Verified":"Rejected")&&le(l,o),(!S||$[0]&1)&&a!==(a=O[0].onBehalfOfEmployeeNameEN+"")&&le(f,a);const F={};$[0]&1&&(F.group=O[0].verifiedDate?"verify":""),p.$set(F);const A={};$[0]&1&&(A.group=O[0].verifiedDate?"":"reject"),h.$set(A);const R={};$[0]&1&&(R.value=O[0].verifiedDate?O[0].verifyComment||"":O[0].rejectComment),k.$set(R),(!S||$[0]&262144)&&he(e,"_pdf-generating",O[18])},i(O){S||(_(p.$$.fragment,O),_(h.$$.fragment,O),_(k.$$.fragment,O),S=!0)},o(O){C(p.$$.fragment,O),C(h.$$.fragment,O),C(k.$$.fragment,O),S=!1},d(O){O&&z(e),V(p),V(h),V(k)}}}function ml(r){let e,t,n=(r[0].approvedDate||!r[0].onBehalfOfVerifying&&r[0].rejectedDate||r[0].onBehalfOfVerifying&&r[0].verifiedDate&&r[0].rejectedDate)&&hl(r);return{c(){n&&n.c(),e=wn()},m(i,o){n&&n.m(i,o),P(i,e,o),t=!0},p(i,o){i[0].approvedDate||!i[0].onBehalfOfVerifying&&i[0].rejectedDate||i[0].onBehalfOfVerifying&&i[0].verifiedDate&&i[0].rejectedDate?n?(n.p(i,o),o[0]&1&&_(n,1)):(n=hl(i),n.c(),_(n,1),n.m(e.parentNode,e)):n&&(de(),C(n,1,1,()=>{n=null}),pe())},i(i){t||(_(n),t=!0)},o(i){C(n),t=!1},d(i){n&&n.d(i),i&&z(e)}}}function hl(r){let e,t,n,i,o=r[0].approvedDate?"Approved":"Rejected",l,s,a=r[0].userManagerNameEN+"",f,c,d,p,m,h,b,k,S;return p=new gn({props:{isForm:!0,labelClass:"text-black",name:"managerResult",value:"approve",label:"อนุมัติใบงาน (Approve)",group:r[0].approvedDate?"approve":"",disabled:!0}}),h=new gn({props:{isForm:!0,labelClass:"text-black",name:"managerResult",value:"reject",label:"ไม่อนุมัติใบงาน (Reject)",group:r[0].approvedDate?"":"reject",disabled:!0}}),k=new rn({props:{autoResize:!0,label:"เหตุผล (Reason)",labelClass:"text-gray-800",value:r[0].approvedDate?r[0].approvedComment||"":r[0].rejectComment,disabled:!0}}),{c(){e=g("div"),t=g("div"),t.textContent="ผู้จัดการ (Manager)",n=M(),i=g("div"),l=G(o),s=G(" by : "),f=G(a),c=M(),d=g("div"),L(p.$$.fragment),m=M(),L(h.$$.fragment),b=M(),L(k.$$.fragment),v(t,"class","font-weight-bold mb-2"),v(i,"class","mb-2"),v(d,"class","flex gap-3 mb-2"),v(e,"class","_container _container--gray _desktop-spacing mt-1 svelte-1n6e7yl"),he(e,"_pdf-generating",r[18])},m(O,$){P(O,e,$),u(e,t),u(e,n),u(e,i),u(i,l),u(i,s),u(i,f),u(e,c),u(e,d),q(p,d,null),u(d,m),q(h,d,null),u(e,b),q(k,e,null),S=!0},p(O,$){(!S||$[0]&1)&&o!==(o=O[0].approvedDate?"Approved":"Rejected")&&le(l,o),(!S||$[0]&1)&&a!==(a=O[0].userManagerNameEN+"")&&le(f,a);const F={};$[0]&1&&(F.group=O[0].approvedDate?"approve":""),p.$set(F);const A={};$[0]&1&&(A.group=O[0].approvedDate?"":"reject"),h.$set(A);const R={};$[0]&1&&(R.value=O[0].approvedDate?O[0].approvedComment||"":O[0].rejectComment),k.$set(R),(!S||$[0]&262144)&&he(e,"_pdf-generating",O[18])},i(O){S||(_(p.$$.fragment,O),_(h.$$.fragment,O),_(k.$$.fragment,O),S=!0)},o(O){C(p.$$.fragment,O),C(h.$$.fragment,O),C(k.$$.fragment,O),S=!1},d(O){O&&z(e),V(p),V(h),V(k)}}}function gl(r){let e,t,n,i,o,l;function s(f){r[75](f)}let a={autoResize:!0,label:"รายละเอียดเพิ่มเติม (ถ้ามี)",labelClass:"text-gray-800",disabled:!r[0].canSaveComplete};return r[0].staffComment!==void 0&&(a.value=r[0].staffComment),i=new rn({props:a}),fe.push(()=>we(i,"value",s)),{c(){e=g("div"),t=g("div"),t.textContent="ข้อความถึงพนักงาน",n=M(),L(i.$$.fragment),v(t,"class","font-weight-bold mb-2"),v(e,"class","_container _container--green _desktop-spacing mt-1 svelte-1n6e7yl"),he(e,"_pdf-generating",r[18])},m(f,c){P(f,e,c),u(e,t),u(e,n),q(i,e,null),l=!0},p(f,c){const d={};c[0]&1&&(d.disabled=!f[0].canSaveComplete),!o&&c[0]&1&&(o=!0,d.value=f[0].staffComment,ke(()=>o=!1)),i.$set(d),(!l||c[0]&262144)&&he(e,"_pdf-generating",f[18])},i(f){l||(_(i.$$.fragment,f),l=!0)},o(f){C(i.$$.fragment,f),l=!1},d(f){f&&z(e),V(i)}}}function _l(r){let e,t,n,i,o,l,s;function a(c){r[76](c)}let f={autoResize:!0,label:"รายละเอียดเพิ่มเติม (ถ้ามี)",labelClass:"text-gray-800",disabled:!r[0].canSaveComplete};return r[0].adminPMSVComment!==void 0&&(f.value=r[0].adminPMSVComment),o=new rn({props:f}),fe.push(()=>we(o,"value",a)),{c(){e=g("div"),t=g("div"),n=G(r[19]),i=M(),L(o.$$.fragment),v(t,"class","font-weight-bold mb-2"),v(e,"class","_container _container--green _desktop-spacing mt-1 svelte-1n6e7yl"),he(e,"_pdf-generating",r[18])},m(c,d){P(c,e,d),u(e,t),u(t,n),u(e,i),q(o,e,null),s=!0},p(c,d){(!s||d[0]&524288)&&le(n,c[19]);const p={};d[0]&1&&(p.disabled=!c[0].canSaveComplete),!l&&d[0]&1&&(l=!0,p.value=c[0].adminPMSVComment,ke(()=>l=!1)),o.$set(p),(!s||d[0]&262144)&&he(e,"_pdf-generating",c[18])},i(c){s||(_(o.$$.fragment,c),s=!0)},o(c){C(o.$$.fragment,c),s=!1},d(c){c&&z(e),V(o)}}}function bl(r){let e,t,n,i,o,l=r[0].pmsvEmployeeName+"",s,a,f,c,d,p,m=r[0].pmsvEmail+"",h;return{c(){e=g("div"),t=g("div"),n=g("span"),n.textContent="Administrator Name :",i=M(),o=g("span"),s=G(l),a=M(),f=g("div"),c=g("span"),c.textContent="Email :",d=M(),p=g("span"),h=G(m),v(n,"class","text-gray-800"),v(c,"class","text-gray-800"),v(e,"class","p-2 grid gap-1.5 border-t border-gray-400 _desktop-spacing desktop:grid-cols-3 desktop:gap-x-10 svelte-1n6e7yl"),he(e,"_pdf-generating",r[18])},m(b,k){P(b,e,k),u(e,t),u(t,n),u(t,i),u(t,o),u(o,s),u(e,a),u(e,f),u(f,c),u(f,d),u(f,p),u(p,h)},p(b,k){k[0]&1&&l!==(l=b[0].pmsvEmployeeName+"")&&le(s,l),k[0]&1&&m!==(m=b[0].pmsvEmail+"")&&le(h,m),k[0]&262144&&he(e,"_pdf-generating",b[18])},d(b){b&&z(e)}}}function uc(r){var b,k;let e,t,n,i,o,l=(((b=r[0])==null?void 0:b.rejectedBy)??"-")+"",s,a,f,c,d,p,m=Le((k=r[0])==null?void 0:k.rejectedDate)+"",h;return{c(){e=g("div"),t=g("div"),n=g("span"),n.textContent="Rejected By :",i=M(),o=g("span"),s=G(l),a=M(),f=g("div"),c=g("span"),c.textContent="Rejected Date :",d=M(),p=g("span"),h=G(m),v(n,"class","text-gray-800"),v(c,"class","text-gray-800"),v(e,"class","grid grid-cols-1 gap-1.5 mb-3 desktop:grid-cols-2")},m(S,O){P(S,e,O),u(e,t),u(t,n),u(t,i),u(t,o),u(o,s),u(e,a),u(e,f),u(f,c),u(f,d),u(f,p),u(p,h)},p(S,O){var $,F;O[0]&1&&l!==(l=((($=S[0])==null?void 0:$.rejectedBy)??"-")+"")&&le(s,l),O[0]&1&&m!==(m=Le((F=S[0])==null?void 0:F.rejectedDate)+"")&&le(h,m)},d(S){S&&z(e)}}}function dc(r){var b,k;let e,t,n,i,o,l=(((b=r[0])==null?void 0:b.cancelledBy)??"-")+"",s,a,f,c,d,p,m=Le((k=r[0])==null?void 0:k.cancelledDate)+"",h;return{c(){e=g("div"),t=g("div"),n=g("span"),n.textContent="Cancelled By :",i=M(),o=g("span"),s=G(l),a=M(),f=g("div"),c=g("span"),c.textContent="Cancelled Date :",d=M(),p=g("span"),h=G(m),v(n,"class","text-gray-800"),v(c,"class","text-gray-800"),v(e,"class","grid grid-cols-1 gap-1.5 mb-3 desktop:grid-cols-2")},m(S,O){P(S,e,O),u(e,t),u(t,n),u(t,i),u(t,o),u(o,s),u(e,a),u(e,f),u(f,c),u(f,d),u(f,p),u(p,h)},p(S,O){var $,F;O[0]&1&&l!==(l=((($=S[0])==null?void 0:$.cancelledBy)??"-")+"")&&le(s,l),O[0]&1&&m!==(m=Le((F=S[0])==null?void 0:F.cancelledDate)+"")&&le(h,m)},d(S){S&&z(e)}}}function pc(r){var c,d;let e,t,n,i=(r[16]?(c=r[0])==null?void 0:c.cancelComment:(d=r[0])==null?void 0:d.rejectComment)+"",o,l;function s(p,m){return p[16]?dc:uc}let a=s(r),f=a(r);return{c(){e=g("div"),t=g("div"),n=g("span"),o=G(i),l=M(),f.c(),v(t,"class","text-size-xlarge text-center mb-2 desktop:mb-5"),v(e,"class","max-w-[852px] mx-auto")},m(p,m){P(p,e,m),u(e,t),u(t,n),u(n,o),u(e,l),f.m(e,null)},p(p,m){var h,b;m[0]&65537&&i!==(i=(p[16]?(h=p[0])==null?void 0:h.cancelComment:(b=p[0])==null?void 0:b.rejectComment)+"")&&le(o,i),a===(a=s(p))&&f?f.p(p,m):(f.d(1),f=a(p),f&&(f.c(),f.m(e,null)))},d(p){p&&z(e),f.d()}}}function mc(r){let e,t=r[16]?"Cancel Reason":"Reject Reason",n;return{c(){e=g("div"),n=G(t),v(e,"slot","title"),v(e,"class","text-reject")},m(i,o){P(i,e,o),u(e,n)},p(i,o){o[0]&65536&&t!==(t=i[16]?"Cancel Reason":"Reject Reason")&&le(n,t)},d(i){i&&z(e)}}}function hc(r){var oe,qe,Ne,et,ye,be,ce,ie,Pe;let e,t,n,i,o,l,s,a,f,c=(si[(qe=(oe=r[0])==null?void 0:oe.status)==null?void 0:qe.key]||"-")+"",d,p,m,h,b,k,S,O,$,F,A,R,H,j,Q,ne,K,X,E,I,B,re,Y=r[18]&&Ui();i=new Eo({props:{icon:"ic-stationary",iconBg:"bg-stationery",title:`Document No. : ${((Ne=r[0])==null?void 0:Ne.documentNo)||"-"}`,fixIconSize:!1,isPdfGenerating:r[18]}});function te(N,J){var Be,ze;return((ze=(Be=N[0])==null?void 0:Be.status)==null?void 0:ze.key)===Cr.StationaryServiceStatus.Draft?Zf:Qf}let ae=te(r),x=ae(r),U=r[0]&&Ki(r),W={recordId:(et=r[0])==null?void 0:et.recordId,withdrawFrom:(ye=r[0])==null?void 0:ye.withdrawFrom};S=new Ef({props:W}),r[79](S),S.$on("add",r[80]),S.$on("preview",r[41]);function Oe(N){r[81](N)}let D={imageSrc:((be=r[7])==null?void 0:be.imageSrc)??((Pe=(ie=(ce=r[7])==null?void 0:ce.attachmentFiles)==null?void 0:ie[0])==null?void 0:Pe.url)};r[9]!==void 0&&(D.previewModal=r[9]),$=new Ro({props:D}),fe.push(()=>we($,"previewModal",Oe));let ue={isLoading:r[4]};R=new Lo({props:ue}),r[82](R);function _e(N){r[83](N)}let xe={onConfirm:r[37],onCancel:r[38]};r[11]!==void 0&&(xe.modal=r[11]),j=new Df({props:xe}),fe.push(()=>we(j,"modal",_e));let ge={showFooter:!1,maxWidth:"500px",$$slots:{title:[mc],default:[pc]},$$scope:{ctx:r}};K=new er({props:ge}),r[84](K);let nt={};E=new No({props:nt}),r[85](E);let Me={onConfirm:r[15]?r[31]:r[33],isLoading:r[4],minNeedDate:r[20],isAccept:r[15]};return B=new Kf({props:Me}),r[86](B),{c(){Y&&Y.c(),e=M(),t=g("div"),n=g("div"),L(i.$$.fragment),o=M(),l=g("div"),s=g("div"),a=G("Current Status : "),f=g("span"),d=G(c),p=M(),m=g("div"),x.c(),h=M(),b=g("div"),U&&U.c(),k=M(),L(S.$$.fragment),O=M(),L($.$$.fragment),A=M(),L(R.$$.fragment),H=M(),L(j.$$.fragment),ne=M(),L(K.$$.fragment),X=M(),L(E.$$.fragment),I=M(),L(B.$$.fragment),v(n,"class","mb-2"),v(f,"class","font-weight-bold"),v(m,"class","no-print"),v(l,"class","flex justify-between items-center mb-1.5 px-2 desktop:px-4"),v(t,"class","svelte-1n6e7yl"),he(t,"_page-pdf",r[18])},m(N,J){Y&&Y.m(N,J),P(N,e,J),P(N,t,J),u(t,n),q(i,n,null),u(t,o),u(t,l),u(l,s),u(s,a),u(s,f),u(f,d),u(l,p),u(l,m),x.m(m,null),u(t,h),u(t,b),U&&U.m(b,null),r[78](t),P(N,k,J),q(S,N,J),P(N,O,J),q($,N,J),P(N,A,J),q(R,N,J),P(N,H,J),q(j,N,J),P(N,ne,J),q(K,N,J),P(N,X,J),q(E,N,J),P(N,I,J),q(B,N,J),re=!0},p(N,J){var pt,Ae,yt,He,vt,Ct,Ve,ht,Fe;N[18]?Y||(Y=Ui(),Y.c(),Y.m(e.parentNode,e)):Y&&(Y.d(1),Y=null);const Be={};J[0]&1&&(Be.title=`Document No. : ${((pt=N[0])==null?void 0:pt.documentNo)||"-"}`),J[0]&262144&&(Be.isPdfGenerating=N[18]),i.$set(Be),(!re||J[0]&1)&&c!==(c=(si[(yt=(Ae=N[0])==null?void 0:Ae.status)==null?void 0:yt.key]||"-")+"")&&le(d,c),ae===(ae=te(N))&&x?x.p(N,J):(x.d(1),x=ae(N),x&&(x.c(),x.m(m,null))),N[0]?U?(U.p(N,J),J[0]&1&&_(U,1)):(U=Ki(N),U.c(),_(U,1),U.m(b,null)):U&&(de(),C(U,1,1,()=>{U=null}),pe()),(!re||J[0]&262144)&&he(t,"_page-pdf",N[18]);const ze={};J[0]&1&&(ze.recordId=(He=N[0])==null?void 0:He.recordId),J[0]&1&&(ze.withdrawFrom=(vt=N[0])==null?void 0:vt.withdrawFrom),S.$set(ze);const wt={};J[0]&128&&(wt.imageSrc=((Ct=N[7])==null?void 0:Ct.imageSrc)??((Fe=(ht=(Ve=N[7])==null?void 0:Ve.attachmentFiles)==null?void 0:ht[0])==null?void 0:Fe.url)),!F&&J[0]&512&&(F=!0,wt.previewModal=N[9],ke(()=>F=!1)),$.$set(wt);const lt={};J[0]&16&&(lt.isLoading=N[4]),R.$set(lt);const ot={};!Q&&J[0]&2048&&(Q=!0,ot.modal=N[11],ke(()=>Q=!1)),j.$set(ot);const kt={};J[0]&65537|J[3]&16&&(kt.$$scope={dirty:J,ctx:N}),K.$set(kt);const St={};E.$set(St);const tt={};J[0]&32768&&(tt.onConfirm=N[15]?N[31]:N[33]),J[0]&16&&(tt.isLoading=N[4]),J[0]&32768&&(tt.isAccept=N[15]),B.$set(tt)},i(N){re||(_(i.$$.fragment,N),_(U),_(S.$$.fragment,N),_($.$$.fragment,N),_(R.$$.fragment,N),_(j.$$.fragment,N),_(K.$$.fragment,N),_(E.$$.fragment,N),_(B.$$.fragment,N),re=!0)},o(N){C(i.$$.fragment,N),C(U),C(S.$$.fragment,N),C($.$$.fragment,N),C(R.$$.fragment,N),C(j.$$.fragment,N),C(K.$$.fragment,N),C(E.$$.fragment,N),C(B.$$.fragment,N),re=!1},d(N){Y&&Y.d(N),N&&z(e),N&&z(t),V(i),x.d(),U&&U.d(),r[78](null),N&&z(k),r[79](null),V(S,N),N&&z(O),V($,N),N&&z(A),r[82](null),V(R,N),N&&z(H),V(j,N),N&&z(ne),r[84](null),V(K,N),N&&z(X),r[85](null),V(E,N),N&&z(I),r[86](null),V(B,N)}}}function gc(r){let e,t;return e=new wo({props:{isShowLoading:r[3],$$slots:{default:[hc]},$$scope:{ctx:r}}}),{c(){L(e.$$.fragment)},m(n,i){q(e,n,i),t=!0},p(n,i){const o={};i[0]&8&&(o.isShowLoading=n[3]),i[0]&1048567|i[3]&16&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function _c(r,e,t){let n;ko.set({vertical:yo.Middle});let i=ai.parent,o=ai.recordId,l,s,a={},f=!1,c=!1,d=!1,p,m,h,b,k,S,O,$,F,A=!1,R=!1;const H=Sl.now().startOf("day").toJSDate(),j=[{value:!1,label:"ดำเนินการเอง"},{value:!0,label:"ดำเนินการแทน (On Behalf Of)"}],Q=qo.map(y=>({key:y,value:vo[y]})),ne=Object.keys(Cr.StationaryWithdrawFrom).map(y=>({key:y,value:So[y]}));function K(){be(),ce(),p&&p.clearOnBehalfOfEmployee()}let X,E=!1;async function I(){t(18,E=!0),await vr();{const y=[...l.withdraws.filter(Z=>!Z.imageSrc).map(Z=>Z.attachmentFiles[0].id),...l.withdrawOthers.filter(Z=>!Z.imageSrc).map(Z=>Z.attachmentFiles[0].id)];if(y.length){console.log("get images body");const Z=await Oo(y);let Se=-1;const Ce=l.withdraws.map(Ot=>Ot.imageSrc?Ot:(Se++,{...Ot,imageSrc:Z[Se]})),Xt=l.withdrawOthers.map(Ot=>Ot.imageSrc?Ot:(Se++,{...Ot,imageSrc:Z[Se]}));t(0,l={...l,withdraws:Ce,withdrawOthers:Xt}),console.log("get images body success"),await vr()}}Mo.export(X,{fileName:`Stationery_${l.documentNo??""}`,margin:!1,scale:.4}).then(()=>{t(18,E=!1)})}function B(){t(4,c=!0),Re.DeleteStationary({search:{recordId:l.recordId,search:""}}).then(()=>{k.close(),$.success("Delete Successfully").then(()=>{re()})}).catch(()=>{t(4,c=!1)})}function re(){Io(i??$o.HOME)}function Y(){t(0,l.canSave=!0,l),t(5,d=!0)}function te(){return l.withdrawOthers.length>0&&l.isOnBehalf&&l.onBehalfOfVerifying!==!0&&t(0,l.onBehalfOfVerifying=!0,l),{...l,withdraws:l.withdraws.map(({imageSrc:y,...Z})=>({...Z})),withdrawOthers:l.withdrawOthers.map(({imageSrc:y,...Z})=>({...Z})),userManagerFlow:l.withdrawOthers.length>0}}function ae(){l.serviceFor&&t(0,l.serviceFor={...l.serviceFor,value:Q.find(y=>y.key===l.serviceFor.key).value},l)}function x(y=!0){if(t(4,c=!0),l.canSaveComplete)return Re.SaveCompleteStationary({input:te()}).then(Z=>{t(0,l=Z),ae(),t(2,a={}),y&&je.success("Save Successfully")}).finally(()=>{t(4,c=!1),t(5,d=!1)});if(l.canSave)return Re.SaveStationary({input:te()}).then(Z=>{t(0,l=Z),ae(),y&&je.success("Save Successfully")}).finally(()=>{t(4,c=!1),t(5,d=!1)})}function U(){x(!1).then(()=>{const{isValid:y}=ui(l);if(!y)return;if(l.withdraws.length===0&&l.withdrawOthers.length===0){je.error("โปรดระบุรายการขอเบิก");return}let Z="Do you want to submit the document?";l.isOnBehalf?l.withdrawOthers.length>0?l.onBehalfOfVerifying?Z=`Do you want to submit the document?<br><br>The document will send to<br>verify by ${l.onBehalfOfEmployeeNameEN??""}<br>Approve by ${l.userManagerNameEN}`:Z=`Do you want to submit the document?<br><br>The document will send to<br>Approve by ${l.userManagerNameEN}`:l.onBehalfOfVerifying&&(Z=`Do you want to submit the document?<br><br>The document will send to<br>verify by ${l.onBehalfOfEmployeeNameEN??""}`):l.withdrawOthers.length>0&&(Z=`Do you want to submit the document?<br><br>The document will send to<br>Approve by ${l.userManagerNameEN}`),k.open({title:"Are you Sure?",detail:Z,onConfirm:()=>{k.close(),W()}})})}function W(){t(4,c=!0),Re.SubmitStationary({input:te()}).then(y=>{t(0,l=y),ae(),je.success("Submit Successfully")}).finally(()=>{t(4,c=!1)})}function Oe(y,Z){if(!Z.trim()||!y){je.error("Please specify all required fields");return}t(4,c=!0),Re.AcceptStationary({accept:{recordId:l.recordId,comment:Z,deliveryDate:y}}).then(Se=>{t(0,l=Se),ae(),je.success("Accept Successfully"),F.close()}).finally(()=>{t(4,c=!1)})}function D(y){t(4,c=!0),Re.ApproveStationary({search:{recordId:l.recordId,search:""},comment:y}).then(Z=>{t(0,l=Z),ae(),je.success("Approve Successfully")}).finally(()=>{t(4,c=!1)})}function ue(y){if(!y){je.error("Please specify Complete date");return}t(4,c=!0),Re.CompleteStationary({input:{...te(),completedDate:y}}).then(Z=>{t(0,l=Z),ae(),je.success("Complete Successfully")}).finally(()=>{t(4,c=!1)})}function _e(y){t(4,c=!0),Re.VerifyStationary({search:{recordId:l.recordId,search:""},comment:y}).then(Z=>{t(0,l=Z),ae(),je.success("Verify Successfully")}).finally(()=>{t(4,c=!1)})}function xe(y){t(4,c=!0),Re.RejectStationary({cancel:{recordId:l.recordId,comment:y}}).then(Z=>{et(),je.success("Reject Successfully")}).finally(()=>{t(4,c=!1)})}function ge(y){t(4,c=!0),Re.CancelRequestStationary({cancel:{recordId:l.recordId,comment:y}}).then(Z=>{et(),je.success("Cancellation Successfully")}).finally(()=>{t(4,c=!1)})}function nt(){t(0,l.withdraws=[],l),t(0,l.withdrawOthers=l.withdrawOthers.filter(y=>!y.stationaryId),l),t(1,s=l.withdrawFrom),S.close()}function Me(){t(0,l.withdrawFrom=s,l)}function oe(){t(4,c=!0),Re.SaveRatingStationary({input:te()}).then(y=>{t(0,l=y),ae(),je.success("Save Rating Successfully")}).finally(()=>{t(4,c=!1)})}function qe({detail:y},Z=!1){Z?t(0,l.totalOther=y,l):t(0,l.totalStock=y,l),t(0,l.total=(l.totalStock??0)+(l.totalOther??0),l)}function Ne({detail:y}){t(7,m=y),b.open()}function et(){t(3,f=!0),Re.GetStationaryDetail({search:{recordId:o,search:""}}).then(async y=>{t(3,f=!1),t(0,l=y),ae(),l.withdraws||t(0,l.withdraws=[],l),l.withdrawOthers||t(0,l.withdrawOthers=[],l),l.canOnlyOnBehalf&&t(0,l.isOnBehalf=!0,l),t(0,l.isOnBehalf=!!l.isOnBehalf,l),l.showRatingForm&&(typeof l.ratingScore!="number"||l.ratingScore===0)&&t(0,l.ratingScore=5,l),l.showRatingFormOBH&&(typeof l.ratingScoreOBH!="number"||l.ratingScoreOBH===0)&&t(0,l.ratingScoreOBH=5,l),l.withdrawOthers.length>0&&l.isOnBehalf&&l.onBehalfOfVerifying!==!0&&t(0,l.onBehalfOfVerifying=!0,l),t(1,s=l.withdrawFrom),ye(),l.serviceFor||be(),l.withdrawFrom||ce()}).catch(()=>{t(3,f=!1)})}function ye(){(l.canSave||l.canComplete)&&(l.withdraws.length&&Re.GetMasterStationaryList({search:{recordId:"",search:""},serviceFor:s==null?void 0:s.key}).then(y=>{l.withdraws.length&&t(0,l.withdraws=l.withdraws.map(Z=>{const Se=y.find(Ce=>Ce.recordId===Z.recordId);return{...Z,stockOnHand:Se.stockOnHand??0}}),l)}),l.withdrawOthers.length&&Re.GetInActiveMasterStationaryList({search:{recordId:"",search:""},serviceFor:s==null?void 0:s.key}).then(y=>{l.withdrawOthers.length&&t(0,l.withdrawOthers=l.withdrawOthers.map(Z=>{const Se=y.find(Ce=>Ce.recordId===Z.recordId);return{...Z,stockOnHand:Se.stockOnHand??0}}),l)}))}function be(){const y=l.isOnBehalf?l.onBehalfOfId:l.requesterId;y&&Re.DefaultServiceFor({userId:y}).then(Z=>{if(Z){const Se=Q.find(Ce=>Ce.key===Z);Se&&t(0,l.serviceFor={...Se,enumName:""},l)}})}function ce(){const y=l.isOnBehalf?l.onBehalfOfId:l.requesterId;y&&Re.DefaultWithdrawFrom({userId:y}).then(Z=>{if(Z){const Se=ne.find(Ce=>Ce.key===Z);Se&&t(0,l.withdrawFrom={...Se,enumName:""},l)}})}Co(()=>{et()});const ie=()=>{k.open({title:"Are you Sure?",detail:"Do you want to delete the document?",onConfirm:()=>B()})};function Pe(y){l=y,t(0,l)}function N(y){l=y,t(0,l)}const J=()=>{t(16,R=!1),O.open()},Be=()=>{t(16,R=!0),O.open()},ze=()=>{l.canSave||l.canSaveComplete?k.open({title:"Are you Sure?",detail:"Do you want to save before exiting?",onConfirm:()=>{x(!1),re()},onCancel:re}):re()},wt=()=>{k.open({title:"Are you Sure?",detail:"Do you want to save the document?",onConfirm:()=>{k.close(),x()}})},lt=()=>{k.open({title:"Are you Sure?",detail:"Do you want to approve the document?",canComment:!0,reasonLabel:"Please specify the reason for approval",onConfirm:y=>{k.close(),D(y)}})},ot=()=>{t(15,A=!0),F.open()},kt=()=>{const{isValid:y}=ui(l);y&&(t(15,A=!1),F.open())},St=()=>{k.open({title:"Are you Sure?",detail:"Do you want to verify the document?",canComment:!0,reasonLabel:"Please specify the reason for verifying",onConfirm:y=>{k.close(),_e(y)}})},tt=()=>{k.open({title:"Are you Sure?",detail:"Do you want to reject the request?",reasonLabel:"Please specify the reason for rejection",canComment:!0,requiredComment:!0,emptyCommentText:"Please specify the reason for rejection",onConfirm:y=>{k.close(),xe(y)}})},pt=()=>{k.open({title:"Are you Sure?",detail:"Do you want to cancel the request?",reasonLabel:"Please specify the reason for cancellation",canComment:!0,requiredComment:!0,emptyCommentText:"Please specify the reason for cancellation",onConfirm:y=>{k.close(),ge(y)}})};function Ae(y){r.$$.not_equal(l.isOnBehalf,y)&&(l.isOnBehalf=y,t(0,l))}function yt(y){l=y,t(0,l)}function He(y){fe[y?"unshift":"push"](()=>{p=y,t(6,p)})}const vt=()=>{be(),ce()};function Ct(y){r.$$.not_equal(l.withdrawFrom,y)&&(l.withdrawFrom=y,t(0,l))}const Ve=()=>{l.withdraws.length?S.open():t(1,s=l.withdrawFrom)};function ht(y){r.$$.not_equal(l.serviceFor,y)&&(l.serviceFor=y,t(0,l))}function Fe(y){r.$$.not_equal(l.location,y)&&(l.location=y,t(0,l))}function me(y){r.$$.not_equal(l.internalNo,y)&&(l.internalNo=y,t(0,l))}function Ie(y){r.$$.not_equal(l.mobileNo,y)&&(l.mobileNo=y,t(0,l))}const It=()=>{/\D/.test(l.mobileNo)&&t(0,l.mobileNo=l.mobileNo.replace(/\D/g,""),l),l.mobileNo.length>10&&t(0,l.mobileNo=l.mobileNo.slice(0,10),l)},Nt=y=>{var Z;/\D/.test(y.key)&&y.preventDefault(),((Z=l.mobileNo)==null?void 0:Z.length)>10&&y.preventDefault()};function Kt(y){r.$$.not_equal(l.needDate,y)&&(l.needDate=y,t(0,l))}function on(y){r.$$.not_equal(l.withdraws,y)&&(l.withdraws=y,t(0,l))}function zn(y){r.$$.not_equal(l.withdrawOthers,y)&&(l.withdrawOthers=y,t(0,l))}function yn(y){a=y,t(2,a)}const sn=y=>qe(y,!0);function vn(y){r.$$.not_equal(l.comment,y)&&(l.comment=y,t(0,l))}function Rn(y){r.$$.not_equal(l.staffComment,y)&&(l.staffComment=y,t(0,l))}function Qt(y){r.$$.not_equal(l.adminPMSVComment,y)&&(l.adminPMSVComment=y,t(0,l))}function an(y){l=y,t(0,l)}function Ln(y){fe[y?"unshift":"push"](()=>{X=y,t(17,X)})}function Sn(y){fe[y?"unshift":"push"](()=>{h=y,t(8,h)})}const fn=({detail:{item:y,isOther:Z}})=>{if(Z){const Se=l.withdrawOthers.length?Math.max(...l.withdrawOthers.map(Ce=>Ce.no))+1:1;t(0,l.withdrawOthers=[...l.withdrawOthers,{...y,no:Se}],l),l.isOnBehalf&&t(0,l.onBehalfOfVerifying=!0,l)}else{const Se=l.withdraws.findIndex(Xt=>Xt.recordId===y.recordId);if(Se>-1){if(l.withdraws[Se].quantity+1>y.stockOnHand){je.warning("จำนวนที่เบิก มากกว่า Stock On Hand");return}t(0,l.withdraws[Se].quantity++,l),je.success(`จำนวนที่เบิก ${y.name}: ${Je(l.withdraws[Se].quantity)}`);return}if(y.stockOnHand===0){je.warning("ไม่สามารถเพิ่มรายการได้");return}const Ce=l.withdraws.length?Math.max(...l.withdraws.map(Xt=>Xt.no))+1:1;t(0,l.withdraws=[...l.withdraws,{...y,no:Ce}],l),je.success(`เพิ่ม ${y.name} เรียบร้อย`)}};function Cn(y){b=y,t(9,b)}function qn(y){fe[y?"unshift":"push"](()=>{k=y,t(10,k)})}function Zt(y){S=y,t(11,S)}function cn(y){fe[y?"unshift":"push"](()=>{O=y,t(12,O)})}function Vn(y){fe[y?"unshift":"push"](()=>{$=y,t(13,$)})}function On(y){fe[y?"unshift":"push"](()=>{F=y,t(14,F)})}return r.$$.update=()=>{var y;r.$$.dirty[0]&1&&t(19,n=((y=l==null?void 0:l.withdrawFrom)==null?void 0:y.key)===Cr.StationaryWithdrawFrom.TSR?"สำหรับ Admin PMSV":"สำหรับ Admin GSBO")},[l,s,a,f,c,d,p,m,h,b,k,S,O,$,F,A,R,X,E,n,H,j,Q,ne,K,I,B,re,Y,x,U,Oe,D,ue,_e,xe,ge,nt,Me,oe,qe,Ne,be,ce,ie,Pe,N,J,Be,ze,wt,lt,ot,kt,St,tt,pt,Ae,yt,He,vt,Ct,Ve,ht,Fe,me,Ie,It,Nt,Kt,on,zn,yn,sn,vn,Rn,Qt,an,Ln,Sn,fn,Cn,qn,Zt,cn,Vn,On]}class bc extends Wt{constructor(e){super(),Jt(this,e,_c,gc,Ht,{},null,[-1,-1,-1,-1])}}new bc({target:document.getElementById("app")});
